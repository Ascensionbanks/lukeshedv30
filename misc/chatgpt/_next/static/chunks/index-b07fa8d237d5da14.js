(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7314:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8414)}])},8414:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a9}});var a,n,l,s,i,o,d,c,h,u,m,p,x,f,g,v,y,b,w,j,k,N,C,E,S,O,M,_,P,Z,A,L,I,z,F,H,T,R,U,D,G,V,B,Q,Y,W,q,K,X,J,$,ee,et,er,ea,en,el,es,ei,eo,ed=r(2322),ec=r(7729),eh=r.n(ec),eu=r(1647),em=r(6793);let ep=e=>({name:"New chat",id:Math.random().toString(36).substr(2,9),icon:"",parentId:e,workspaceId:e,createdAt:new Date().toISOString()});var ex=r(2784);function ef(){return(ef=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eg=function(e){return ex.createElement("svg",ef({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none","aria-label":"Add",viewBox:"0 0 24 24"},e),n||(n=ex.createElement("g",{clipPath:"url(#add_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1Z"}))),l||(l=ex.createElement("defs",null,ex.createElement("clipPath",{id:"add_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h24v24H0z"})))))},ev=r(7650),ey=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[a,n]=(0,ex.useState)(!1);(0,ex.useEffect)(()=>{function a(a){let n=e.split("+").map(e=>e.trim()),l=n.every(e=>["Shift","Control","Alt","Meta"].includes(e)?a["".concat(e.toLowerCase().replace("control","ctrl"),"Key")]:a.key.toLowerCase()===e.toLowerCase());l&&r.every(e=>e)&&(a.preventDefault(),a.stopPropagation(),t())}return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[e,t,a])};let eb=()=>{let{workspaceId:e}=(0,em.Oz)(),{tabs:t,activeTabId:r,addTab:a,setActiveTabId:n}=(0,em.zR)(),{setIsFocused:l}=(0,em.Nf)(),{defaultPersonaId:s}=(0,em.Gm)(),{messages:i,clearMessages:o,setMessagePersona:d}=(0,em.GH)();function c(){let r=t.find(e=>"Untitled"===e.name);if(i.length>0&&!r){let t=ep(e);o(),a(t),l(!0)}else r&&(o(),n(r.id),l(!0))}return ey("e+Meta",c),ey("e+Control",c),(0,ed.jsx)(ev.Z,{tooltip:"New chat",shortcut:["⌘ + E"],children:(0,ed.jsxs)("button",{onClick:c,className:"cursor-pointer w-full rounded bg-transparent shadow text-th-primary-medium border border-th-border-secondary hover:bg-th-background-hover hover:border-th-primary-light hover:text-th-primary-dark flex gap-[6px] items-center justify-center py-[6px]",children:[(0,ed.jsx)(eg,{height:"16",width:"16"}),(0,ed.jsx)("p",{className:"text-sm  whitespace-nowrap",children:"New chat"})]})})};var ew=r(211);function ej(){return(ej=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ek=function(e){return ex.createElement("svg",ej({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none","aria-label":"Settings",viewBox:"0 0 24 24"},e),s||(s=ex.createElement("path",{fill:"currentColor",d:"M19.875 13.072c.042-.343.07-.7.07-1.072a6.78 6.78 0 0 0-.083-1.072l2.323-1.816a.568.568 0 0 0 .138-.7l-2.2-3.81c-.138-.247-.426-.33-.674-.247l-2.736 1.1a8.057 8.057 0 0 0-1.856-1.072l-.413-2.915a.549.549 0 0 0-.55-.468h-4.4a.535.535 0 0 0-.536.468l-.413 2.915A8.271 8.271 0 0 0 6.69 5.455l-2.736-1.1a.544.544 0 0 0-.674.247l-2.2 3.81a.533.533 0 0 0 .138.7l2.323 1.816A6.91 6.91 0 0 0 3.444 12c0 .357.028.729.083 1.072l-2.324 1.816a.568.568 0 0 0-.138.7l2.2 3.81c.138.247.427.33.674.247l2.736-1.1c.578.44 1.183.797 1.857 1.072l.412 2.915a.56.56 0 0 0 .55.468h4.4a.525.525 0 0 0 .536-.468l.413-2.915a8.27 8.27 0 0 0 1.856-1.072l2.736 1.1c.248.096.537 0 .674-.247l2.2-3.81a.533.533 0 0 0-.137-.7l-2.297-1.816Zm-8.18 3.053A4.137 4.137 0 0 1 7.568 12a4.137 4.137 0 0 1 4.125-4.125A4.137 4.137 0 0 1 15.82 12a4.137 4.137 0 0 1-4.125 4.125Z"})))};function eN(){return(eN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eC=function(e){return ex.createElement("svg",eN({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none",viewBox:"0 0 24 24"},e),i||(i=ex.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M15.572 4.002a4.147 4.147 0 0 0-1.028.21 3.984 3.984 0 0 0-1.602 1.02 4.027 4.027 0 0 0-.771 1.097 4.317 4.317 0 0 0-.344 2.75c.008.041.014.076.012.078a11.5 11.5 0 0 1-7.021-2.889 12.35 12.35 0 0 1-1.385-1.456l-.04-.052-.014.019c-.03.04-.21.423-.26.554a4.31 4.31 0 0 0-.014 3.06 4.21 4.21 0 0 0 1.454 1.925c.042.03.075.056.075.059 0 .007-.18-.005-.307-.02a4 4 0 0 1-1.39-.427l-.139-.073v.139c0 .622.18 1.331.484 1.906.2.38.422.686.717.988a4.041 4.041 0 0 0 2.044 1.141c.065 0-.085.044-.285.082-.439.086-.992.09-1.434.011l-.087-.016.004.023a4.216 4.216 0 0 0 1.42 2.05 4.051 4.051 0 0 0 2.282.853l.117.006-.141.108a8.103 8.103 0 0 1-3.6 1.576c-.482.081-.82.109-1.343.108-.373 0-.5-.006-.808-.037A1.915 1.915 0 0 0 2 18.78c-.003.004.066.05.256.168a11.412 11.412 0 0 0 5.052 1.68c.383.033.517.038 1.036.038.532 0 .7-.007 1.116-.046 1.883-.176 3.586-.759 5.108-1.75a11.352 11.352 0 0 0 2.537-2.276 12.694 12.694 0 0 0 2.83-7.07c.024-.318.03-.557.028-.966l-.003-.413.11-.084A8.498 8.498 0 0 0 22 5.966a.558.558 0 0 0-.079.032c-.432.193-.993.38-1.471.488a8.502 8.502 0 0 1-.762.133c-.01 0 .03-.032.107-.085.255-.173.42-.313.643-.541.342-.35.588-.705.797-1.146.093-.197.22-.527.207-.54a1.124 1.124 0 0 0-.14.075 9.126 9.126 0 0 1-1.105.535 8.279 8.279 0 0 1-1.264.383l-.09.019-.092-.095a4.059 4.059 0 0 0-1.088-.796 3.958 3.958 0 0 0-1.343-.407A3.285 3.285 0 0 0 15.89 4c-.156-.002-.3-.001-.32 0Z",clipRule:"evenodd"})))};function eE(){return(eE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eS=function(e){return ex.createElement("svg",eE({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"Menu book"},e),o||(o=ex.createElement("path",{fill:"currentColor",d:"M11.667 3c-1.3 0-2.7.267-3.667 1-.966-.733-2.366-1-3.666-1-.967 0-1.994.147-2.854.527-.486.22-.813.693-.813 1.233v7.52a1.33 1.33 0 0 0 1.653 1.293 8.237 8.237 0 0 1 2.014-.24c1.04 0 2.146.174 3.04.614.4.2.853.2 1.246 0 .894-.447 2-.614 3.04-.614.667 0 1.36.074 2.014.24.84.22 1.653-.42 1.653-1.293V4.76c0-.54-.327-1.013-.813-1.233-.854-.38-1.88-.527-2.847-.527ZM14 11.487c0 .42-.386.726-.8.653a8.408 8.408 0 0 0-1.533-.133c-1.133 0-2.767.433-3.667 1V5.333c.9-.566 2.534-1 3.667-1 .613 0 1.22.06 1.8.187.307.067.533.34.533.653v6.314Z"})),d||(d=ex.createElement("path",{fill:"currentColor",d:"M9.32 7.34a.492.492 0 0 1-.473-.347.496.496 0 0 1 .32-.626c1.027-.334 2.354-.44 3.574-.3a.5.5 0 0 1-.114.993c-1.08-.127-2.26-.027-3.153.26-.053.007-.107.02-.153.02ZM9.32 9.113a.492.492 0 0 1-.473-.346.496.496 0 0 1 .32-.627c1.02-.333 2.354-.44 3.574-.3a.5.5 0 0 1-.114.993c-1.08-.126-2.26-.026-3.153.26a.646.646 0 0 1-.153.02ZM9.32 10.887a.492.492 0 0 1-.473-.347.496.496 0 0 1 .32-.627c1.02-.333 2.354-.44 3.574-.3a.5.5 0 0 1 .44.554.506.506 0 0 1-.554.44c-1.08-.127-2.26-.027-3.153.26a.648.648 0 0 1-.153.02Z"})))},eO=r(2466),eM=r(6577),e_=r.n(eM);function eP(){return(eP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eZ=function(e){return ex.createElement("svg",eP({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none","aria-label":"Logout",viewBox:"0 0 24 24"},e),c||(c=ex.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"m11.213 1.303-.304.302v11.942l.354.353c.274.273.439.352.738.352.298 0 .463-.079.738-.352l.353-.352V1.605l-.304-.302C12.54 1.055 12.397 1 12.001 1s-.54.055-.788.303ZM7.192 4.416c-.13.054-.504.28-.832.502-2.986 2.02-4.703 5.7-4.302 9.214.473 4.144 3.3 7.461 7.355 8.631.712.205 1.055.237 2.588.237 1.532 0 1.876-.032 2.587-.237 4.057-1.17 6.882-4.487 7.356-8.634.25-2.197-.346-4.594-1.615-6.493-1.06-1.585-3.08-3.267-3.924-3.267-.292 0-.475.077-.705.297-.692.66-.495 1.346.596 2.068 1.512 1 2.733 2.718 3.21 4.515.223.835.245 2.809.042 3.624-.687 2.751-2.885 4.993-5.595 5.707-1.112.293-2.792.293-3.905 0-2.71-.714-4.908-2.956-5.594-5.707-.204-.815-.182-2.79.04-3.624.478-1.797 1.7-3.514 3.211-4.515.796-.527 1.084-.969.97-1.485-.134-.609-.938-1.06-1.483-.833Z",clipRule:"evenodd"})))};function eA(){return(eA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eL=function(e){return ex.createElement("svg",eA({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none","aria-label":"Discord logo",viewBox:"0 0 22 18"},e),h||(h=ex.createElement("g",{clipPath:"url(#discord_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M18.624 1.518A18.141 18.141 0 0 0 14.146.129a.068.068 0 0 0-.072.034c-.194.344-.408.793-.558 1.145a16.748 16.748 0 0 0-5.03 0A11.59 11.59 0 0 0 7.922.163.07.07 0 0 0 7.849.13C6.277.4 4.774.874 3.37 1.518a.064.064 0 0 0-.03.025C.49 5.804-.292 9.961.091 14.065c.002.02.013.04.029.052a18.244 18.244 0 0 0 5.493 2.777.071.071 0 0 0 .077-.026c.423-.577.8-1.187 1.124-1.828a.07.07 0 0 0-.038-.096 12.013 12.013 0 0 1-1.716-.819.07.07 0 0 1-.007-.117 9.37 9.37 0 0 0 .34-.267.068.068 0 0 1 .072-.01c3.6 1.645 7.498 1.645 11.056 0a.068.068 0 0 1 .072.01c.11.09.226.181.342.268a.07.07 0 0 1-.006.117c-.548.32-1.118.59-1.717.817a.07.07 0 0 0-.038.097c.33.64.708 1.25 1.123 1.828a.07.07 0 0 0 .078.026 18.183 18.183 0 0 0 5.502-2.777.07.07 0 0 0 .028-.05c.459-4.746-.768-8.869-3.253-12.523a.055.055 0 0 0-.028-.026ZM7.352 11.566c-1.084 0-1.977-.995-1.977-2.217 0-1.223.875-2.218 1.977-2.218 1.11 0 1.994 1.004 1.977 2.218 0 1.222-.876 2.217-1.977 2.217Zm7.31 0c-1.084 0-1.977-.995-1.977-2.217 0-1.223.876-2.218 1.977-2.218 1.11 0 1.994 1.004 1.977 2.218 0 1.222-.867 2.217-1.977 2.217Z"}))),u||(u=ex.createElement("defs",null,ex.createElement("clipPath",{id:"discord_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h22v17.042H0z"})))))},eI=r(624);let ez=(0,eI.Ue)(e=>({plan:{},setPlan:t=>e({plan:t}),credits:{},setCredits:t=>e({credits:t}),allPlans:[],setAllPlans:t=>e({allPlans:t})}));var eF=r(632);function eH(e){var t;return e?(null===(t=null==e?void 0:e.charAt(0))||void 0===t?void 0:t.toUpperCase())+(null==e?void 0:e.slice(1)):""}let eT=()=>{let{user:e}=(0,eO.useUser)(),{signOut:t}=(0,eO.useClerk)(),{workspaceId:r,workspaces:a}=(0,em.Oz)(),{showSettings:n,setShowSettings:l,setShowSubscription:s}=(0,em.F2)(),{setViewMode:i}=(0,em.Vh)(),[o,d]=(0,ex.useState)(!1),{setIsSidebarOpen:c}=(0,em.Nh)(),{plan:h}=ez(),{refetch:u}=eF.d.workspaces.listPlan.useQuery({workspaceId:r},{enabled:!!r});return(0,ex.useEffect)(()=>{let t=localStorage.getItem("".concat(null==e?void 0:e.id,":viewMode")||0);t&&i(t)},[e]),(0,ed.jsxs)("div",{className:"relative w-full",onMouseEnter:()=>u(),children:[(0,ed.jsxs)("div",{onClick:()=>{d(!o)},className:"flex items-center gap-2 px-2 py-2 w-full rounded cursor-pointer hover:bg-th-background-hover relative",children:[(0,ed.jsx)(e_(),{src:(null==e?void 0:e.profileImageUrl)||"",unoptimized:!0,alt:"Profile picture",width:20,height:20,className:"rounded w-5 h-5 bg-th-background-secondary"}),(0,ed.jsxs)("p",{className:"text-sm text-th-primary-dark whitespace-nowrap overflow-hidden flex gap-2 items-center",children:[null==e?void 0:e.firstName,(null==h?void 0:h.plan)!=="Free"&&(0,ed.jsx)("span",{className:"px-1 py-[2px] rounded-[4px] bg-th-primary-dark text-th-background font-medium text-[10px]",children:eH(h.plan)})]})]}),o&&(0,ed.jsx)(ew.Z,{onClickAway:()=>d(!1),children:(0,ed.jsxs)("ul",{tabIndex:0,className:"dropdown-content dropdown-left border w-[320px] border-th-border-primary bg-th-background-modal overflow-hidden shadow rounded-md w-full z-[16] absolute top-full mt-1",children:[(0,ed.jsx)("li",{className:"border-b border-th-border-secondary",children:null==a?void 0:a.map(e=>(0,ed.jsx)(eR,{avatar:(null==e?void 0:e.avatarUrl)||"",id:null==e?void 0:e.id,name:null==e?void 0:e.name,type:null==h?void 0:h.plan,credits:null==h?void 0:h.credits,isCurrent:e.id==r,setIsOpen:d},e.id))}),(0,ed.jsxs)("li",{className:"flex items-center h-9 gap-3 px-2 py-1 cursor-pointer hover:bg-th-background-secondary text-th-primary-medium hover:text-th-primary-dark border-b border-th-border-secondary",onClick:()=>{l(!n),s(!0),d(!1),c(!1)},children:[(0,ed.jsx)(eS,{height:"16",width:"16"}),(0,ed.jsx)("p",{className:"text-sm",children:"My subscription"})]}),(0,ed.jsxs)("li",{className:"flex items-center h-9 gap-3 px-2 py-1 cursor-pointer hover:bg-th-background-secondary text-th-primary-medium hover:text-th-primary-dark border-b border-th-border-secondary",onClick:()=>{l(!n),d(!1),c(!1)},children:[(0,ed.jsx)(ek,{height:"16",width:"16"}),(0,ed.jsx)("p",{className:"text-sm",children:"Settings"})]}),(0,ed.jsxs)("li",{className:"flex items-center h-9 gap-3 px-2 py-1 cursor-pointer hover:bg-th-background-secondary text-th-primary-medium hover:text-th-primary-dark border-b border-th-border-secondary",onClick:()=>window.open("https://discord.gg/DZG6nK4g3h","_blank"),children:[(0,ed.jsx)(eL,{height:"16",width:"16"}),(0,ed.jsx)("p",{className:"text-sm",children:"Join Discord"})]}),(0,ed.jsxs)("li",{className:"flex items-center h-9 gap-3 px-2 py-1 cursor-pointer hover:bg-th-background-secondary text-th-primary-medium hover:text-th-primary-dark border-b border-th-border-secondary",onClick:()=>window.open("https://twitter.com/ForefrontAI","_blank"),children:[(0,ed.jsx)(eC,{height:"16",width:"16"}),(0,ed.jsx)("p",{className:"text-sm",children:"Follow on Twitter"})]}),(0,ed.jsxs)("li",{className:"flex items-center h-9 gap-3 px-2 py-1 cursor-pointer hover:bg-th-background-secondary text-th-primary-medium hover:text-th-primary-dark",onClick:()=>t(),children:[(0,ed.jsx)(eZ,{height:"16",width:"16"}),(0,ed.jsx)("p",{className:"text-sm",children:"Log out"})]})]})})]})},eR=e=>{let{id:t,name:r,avatar:a,type:n,credits:l,isCurrent:s,setIsOpen:i}=e;return(0,ed.jsxs)("div",{className:"group px-2 py-2 flex gap-2",children:[(0,ed.jsx)(e_(),{src:a||"",alt:"Profile picture",width:28,height:28,unoptimized:!0,className:"rounded h-7 w-7"}),(0,ed.jsxs)("div",{className:"flex flex-col grow",children:[(0,ed.jsx)("p",{className:"text-sm leading-[18px] text-th-primary-dark",children:r}),(0,ed.jsx)("p",{className:"text-xs text-th-primary-light",children:"".concat(n||"Free"," plan ").concat(l&&"(".concat(l," credits)"))})]})]})};var eU=r(8733),eD=r(2797),eG=r(3485),eV=r(5515),eB=r.n(eV),eQ=r(281);function eY(){return(eY=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eW=function(e){return ex.createElement("svg",eY({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none","aria-label":"Cancel"},e),m||(m=ex.createElement("path",{fill:"currentColor",d:"M10 2c-4.416 0-8 3.584-8 8s3.584 8 8 8 8-3.584 8-8-3.584-8-8-8Zm0 14.4A6.408 6.408 0 0 1 3.6 10c0-3.528 2.872-6.4 6.4-6.4 3.528 0 6.4 2.872 6.4 6.4 0 3.528-2.872 6.4-6.4 6.4Z"})),p||(p=ex.createElement("path",{fill:"currentColor",d:"M12.39 6.719a.79.79 0 1 1 1.117 1.117l-5.67 5.671a.79.79 0 0 1-1.118-1.118l5.67-5.67Z"})),x||(x=ex.createElement("path",{fill:"currentColor",d:"M6.719 7.837a.79.79 0 1 1 1.117-1.118l5.671 5.67a.79.79 0 0 1-1.118 1.118l-5.67-5.67Z"})))};function eq(){return(eq=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eK=function(e){return ex.createElement("svg",eq({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"More options"},e),f||(f=ex.createElement("g",{clipPath:"url(#more_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M4 6.667c-.733 0-1.333.6-1.333 1.333S3.267 9.333 4 9.333 5.333 8.733 5.333 8 4.733 6.667 4 6.667Zm8 0c-.733 0-1.333.6-1.333 1.333s.6 1.333 1.333 1.333 1.333-.6 1.333-1.333-.6-1.333-1.333-1.333Zm-4 0c-.733 0-1.333.6-1.333 1.333S7.267 9.333 8 9.333 9.333 8.733 9.333 8 8.733 6.667 8 6.667Z"}))),g||(g=ex.createElement("defs",null,ex.createElement("clipPath",{id:"more_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))};function eX(){return(eX=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var eJ=function(e){return ex.createElement("svg",eX({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none","aria-label":"Edit",viewBox:"0 0 24 24"},e),v||(v=ex.createElement("path",{fill:"currentColor",d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25ZM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83Z"})))};function e$(){return(e$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var e0=function(e){return ex.createElement("svg",e$({xmlns:"http://www.w3.org/2000/svg",fill:"none","aria-label":"Delete",viewBox:"0 0 20 20"},e),y||(y=ex.createElement("g",{clipPath:"url(#delete_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M13.334 7.5v8.333H6.667V7.5h6.667Zm-1.25-5H7.917l-.833.833H4.167V5h11.667V3.333h-2.917l-.833-.833ZM15 5.833H5v10c0 .917.75 1.667 1.667 1.667h6.667c.916 0 1.666-.75 1.666-1.667v-10Z"}))),b||(b=ex.createElement("defs",null,ex.createElement("clipPath",{id:"delete_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h20v20H0z"})))))};function e1(){return(e1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var e6=function(e){return ex.createElement("svg",e1({xmlns:"http://www.w3.org/2000/svg",width:32,height:32,fill:"none","aria-label":"Right arrow",viewBox:"0 0 24 24"},e),w||(w=ex.createElement("g",{clipPath:"url(#arrow_right_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"m10.86 17.505 4.33-4.331a1.665 1.665 0 0 0 0-2.358l-4.33-4.332C9.806 5.447 8 6.184 8 7.672v8.645c0 1.506 1.806 2.241 2.86 1.188Z"}))),j||(j=ex.createElement("defs",null,ex.createElement("clipPath",{id:"arrow_right_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h24v24H0z"})))))};let e3=e=>{let{categorizedEmojis:t,onSelectEmoji:r,onClose:a}=e,[n,l]=(0,ex.useState)(""),s="18px",i=(0,ex.useMemo)(()=>Object.keys(t).map(e=>e).filter(e=>"Component"!==e).reverse(),[t]),o=(0,ex.useRef)(null);(0,ex.useEffect)(()=>{let e=e=>{o.current&&!o.current.contains(e.target)&&a()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o,a]);let d=i.some(e=>{let r=(null==t?void 0:t[e]).filter(e=>""===n||e.name.toLowerCase().includes(n.toLowerCase()));return r.length>0}),c=i.map((e,a)=>{let l=(null==t?void 0:t[e]).filter(e=>""===n||e.name.toLowerCase().includes(n.toLowerCase()));return 0===l.length?null:(0,ed.jsxs)("div",{className:"flex flex-col gap-2 px-4",children:[(0,ed.jsx)("p",{className:"text-sm font-medium text-th-primary-medium",children:e}),(0,ed.jsx)("div",{className:"flex flex-wrap gap-2 align-start",children:l.map((e,t)=>(0,ed.jsx)("div",{className:"p-1 hover:bg-th-background-secondary cursor-pointer rounded",children:(0,ed.jsx)("div",{className:"text-center leading-4",onClick:()=>r(e.unified),style:{fontSize:s,width:s,height:s},children:String.fromCodePoint(parseInt(e.unified,16))},e.unified)},t))})]},a)});return(0,ed.jsx)(ed.Fragment,{children:(0,ed.jsxs)("div",{className:"bg-th-background w-[232px] h-[320px] rounded drop-shadow-lg absolute flex flex-col border border-th-background-secondary overflow-hidden",onClick:e=>e.stopPropagation(),ref:o,children:[(0,ed.jsx)("div",{className:"sticky top-0 w-full border-b border-th-background-secondary",children:(0,ed.jsx)("input",{className:"bg-th-background px-4 py-2 w-full text-sm rounded focus:text-th-primary-dark focus:outline-none",type:"text",autoFocus:!0,placeholder:"Search",value:n,onChange:e=>l(e.target.value)})}),(0,ed.jsxs)("div",{className:"relative flex-1 flex flex-col gap-4 overflow-y-auto pt-4",children:[c,!d&&(0,ed.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center text-th-primary-medium",children:(0,ed.jsx)("p",{className:"text-sm font-medium text-th-primary-light",children:"No results"})})]})]})})};var e2=r(3804),e4=r(1641);function e5(e){try{return String.fromCodePoint(parseInt(e,16))}catch(t){return e}}let e7=r(6635),e8=e=>{let{folderId:t,icon:r}=e,{workspaceId:a}=(0,em.Oz)(),{refetch:n}=eF.d.chat.loadTree.useQuery({workspaceId:a},{enabled:!!a}),[l,s]=(0,ex.useState)(r),[i,o]=(0,ex.useState)(!1),{showToast:d}=(0,e4.pm)(),c=eF.d.chat.updateFolderIcon.useMutation();async function h(e){s(e),d("Emoji updated"),await c.mutateAsync({id:t,icon:e,workspaceId:a}),n()}let u=e2.map(e=>e),m=e7.groupBy(u,"category");return(0,ed.jsxs)("div",{className:"relative h-4 w-4 self-center",children:[(0,ed.jsx)("div",{onClick:e=>{e.stopPropagation(),o(!i)},className:"text-sm leading-4",children:e5(l)},l),i&&(0,ed.jsx)("div",{className:"absolute top-5 left-0 z-20",children:(0,ed.jsx)(e3,{categorizedEmojis:m,onSelectEmoji:h,onClose:function(){o(!1)}})})]})};function e9(){return(e9=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var te=function(e){return ex.createElement("svg",e9({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none","aria-label":"Drag handle"},e),k||(k=ex.createElement("g",{clipPath:"url(#drag_handle_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M5.5 9c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm-1-4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1Zm0-3c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1Zm3 2c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1Zm0 1c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1Zm0 3c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1Z"}))),N||(N=ex.createElement("defs",null,ex.createElement("clipPath",{id:"drag_handle_svg__a"},ex.createElement("path",{fill:"currentColor",d:"M0 0h12v12H0z"})))))};let tt=e=>{let{id:t,isOpen:r,text:a,handleToggle:n,icon:l,refetch:s}=e,[i,o]=(0,ex.useState)(!1),[d,c]=(0,ex.useState)(!1),[h,u]=(0,ex.useState)(!1),[m,p]=(0,ex.useState)(!1),[x,f]=(0,ex.useState)(!1),{isEditingFolder:g,setIsEditingFolder:v,activeFolderId:y,setActiveFolderId:b}=(0,em.t3)(),[w,j]=(0,ex.useState)(a),{showToast:k}=(0,e4.pm)(),{workspaceId:N}=(0,em.Oz)(),C=eF.d.chat.removeFolder.useMutation(),E=eF.d.chat.renameFolder.useMutation(),S=async()=>{await C.mutateAsync({id:t,workspaceId:N}),await s(),k("Folder deleted")},O=async e=>{if(e&&e.stopPropagation(),""===w){k("Folder name cannot be empty");return}await E.mutateAsync({id:t,name:w,workspaceId:N}),s(),v(!1),b(""),k("Folder renamed")},M=()=>g&&y===t?(0,ed.jsxs)("div",{className:"flex gap-2",children:[(0,ed.jsx)(eu.Z,{tooltip:"Approve",display:"bottom",align:"right",shortcut:["⌘","Return"],children:(0,ed.jsx)(eQ.Z,{onClick:O,className:"text-th-primary-medium hover:text-th-primary cursor-pointer"})}),(0,ed.jsx)(eu.Z,{tooltip:"Cancel",display:"bottom",align:"right",shortcut:["Escape"],children:(0,ed.jsx)(eW,{onClick:async()=>{""===w?(await E.mutateAsync({id:t,name:"New folder",workspaceId:N}),await s()):(await E.mutateAsync({id:t,name:w,workspaceId:N}),await s()),v(!1),b("")},className:"text-th-primary-medium hover:text-th-primary cursor-pointer"})})]}):i?(0,ed.jsx)(eK,{className:"text-th-primary-medium md:text-transparent md:group-hover:text-th-primary-medium cursor-pointer",onClick:e=>{e.stopPropagation(),o(!i)}}):y!==t?(0,ed.jsx)(eu.Z,{tooltip:"More options",display:"bottom",align:"right",children:(0,ed.jsx)(eK,{className:"text-th-primary-medium md:text-transparent md:group-hover:text-th-primary-medium cursor-pointer",onClick:e=>{e.stopPropagation(),o(!i)}})}):void 0,_=()=>r?(0,ed.jsx)("div",{className:"pl-4 pr-2 flex items-center gap-1 justify-center absolute right-0 h-full",style:{background:"var(--horizontal-gradient-primary)"},children:M()}):g&&y===t?(0,ed.jsx)("div",{className:"pl-4 pr-2 flex items-center gap-1 justify-center absolute right-0 h-full",style:{background:"var(--horizontal-gradient-primary)"},children:M()}):(0,ed.jsx)("div",{className:"pl-4 pr-2 flex items-center gap-1 justify-center absolute right-0 h-full",style:{background:m?"var(--horizontal-gradient-primary)":"var(--horizontal-gradient-secondary)"},children:M()});return(0,ed.jsx)("div",{onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onClick:g?()=>{v(!1),b("")}:n,children:(0,ed.jsxs)("div",{className:"".concat(r?"bg-th-background-secondary":""," ").concat(g&&y===t?"bg-th-background-secondary":""," px-[6px] relative rounded hover:bg-th-background-secondary items-center cursor-pointer group py-[6px] flex gap-2 mb-1"),children:[(0,ed.jsx)(e8,{folderId:t,workspaceId:N,icon:l}),(0,ed.jsx)(te,{width:12,height:12,className:"hidden group-hover:inline text-th-primary-dark absolute left-[-4]".concat(r&&"inline"," text-th-primary-medium absolute left-[-14px]")}),g&&y===t?(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("input",{autoFocus:!0,className:"text-th-primary-medium max-w-[80%] bg-inherit text-sm whitespace-nowrap flex-1 overflow-hidden outline-none placeholder:text-th-primary-light",placeholder:"New folder",value:w,onChange:e=>{j(e.target.value)},onClick:e=>e.stopPropagation()}),_()]}):(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("p",{className:"text-th-primary-medium text-sm font-medium whitespace-nowrap overflow-hidden text-ellipsis",children:a}),(0,ed.jsx)(e6,{width:12,height:12,preserveAspectRatio:"xMinYMin meet",className:"".concat(!r&&"inline md:hidden"," md:group-hover:inline inline ").concat(r&&"inline"," text-th-primary-medium ").concat(r?"transform rotate-90":""),onClick:n}),_()]}),i&&(0,ed.jsx)(ew.Z,{onClickAway:()=>o(!1),children:(0,ed.jsxs)("ul",{tabIndex:0,className:"flex flex-col rounded bg-th-background-modal border border-th-background-secondary right-0 absolute mt-[92px] mr-2 z-[10]",onClick:e=>e.stopPropagation(),children:[(0,ed.jsxs)("li",{onClick:e=>{e.preventDefault(),e.stopPropagation(),b(t),v(!0),o(!1)},className:"flex gap-[6px] border-b border-th-background-secondary text-th-primary-medium hover:text-th-primary-dark items-center p-1 cursor-pointer hover:bg-th-background-hover text-xs px-3 py-2",children:[(0,ed.jsx)(eJ,{height:"16",width:"16"}),(0,ed.jsx)("p",{children:"Edit"})]}),(0,ed.jsxs)("li",{onClick:()=>{S(),o(!1)},className:"flex gap-[6px] text-th-primary-medium hover:text-th-primary-dark items-center p-1 cursor-pointer hover:bg-th-background-hover text-xs px-3 py-2 ",children:[(0,ed.jsx)(e0,{height:"16",width:"16"}),(0,ed.jsx)("a",{children:"Delete"})]})]})})]})})};function tr(){return(tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ta=function(e){return ex.createElement("svg",tr({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"Chat bubble outline"},e),C||(C=ex.createElement("g",{clipPath:"url(#chat_bubble_outline_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M13.333 1.333H2.667c-.734 0-1.334.6-1.334 1.334v12L4 12h9.333c.734 0 1.334-.6 1.334-1.333v-8c0-.734-.6-1.334-1.334-1.334Zm-.666 9.334H4L2.667 12V3.333c0-.366.3-.666.666-.666h9.334c.366 0 .666.3.666.666V10c0 .367-.3.667-.666.667Z"}))),E||(E=ex.createElement("defs",null,ex.createElement("clipPath",{id:"chat_bubble_outline_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))};function tn(){return(tn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var tl=function(e){return ex.createElement("svg",tn({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"Chat bubble filled"},e),S||(S=ex.createElement("g",{clipPath:"url(#chat_filled_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M13.333 1.333H2.667c-.734 0-1.327.6-1.327 1.334l-.007 12L4 12h9.333c.734 0 1.334-.6 1.334-1.333v-8c0-.734-.6-1.334-1.334-1.334ZM4.667 6h6.666c.367 0 .667.3.667.667 0 .366-.3.666-.667.666H4.667A.669.669 0 0 1 4 6.667C4 6.3 4.3 6 4.667 6Zm4 3.333h-4A.669.669 0 0 1 4 8.667C4 8.3 4.3 8 4.667 8h4c.366 0 .666.3.666.667 0 .366-.3.666-.666.666Zm2.666-4H4.667A.669.669 0 0 1 4 4.667C4 4.3 4.3 4 4.667 4h6.666c.367 0 .667.3.667.667 0 .366-.3.666-.667.666Z"}))),O||(O=ex.createElement("defs",null,ex.createElement("clipPath",{id:"chat_filled_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))};let ts=e=>{let{id:t,refetch:r,isOpen:a,text:n,icon:l,parentId:s}=e,{workspaceId:i}=(0,em.Oz)(),{tabs:o,setActiveTabId:d,addTab:c,closeTab:h}=(0,em.zR)(),{clearMessages:u,setMessages:m,setMessagePersona:p}=(0,em.GH)(),[x,f]=(0,ex.useState)(!1),[g,v]=(0,ex.useState)(!1),[y,b]=(0,ex.useState)(!1),[w,j]=(0,ex.useState)(!1),{showToast:k}=(0,e4.pm)(),[N,C]=(0,ex.useState)(n),{isSidebarOpen:E,setIsSidebarOpen:S}=(0,em.Nh)(),O=eF.d.chat.getMessagesByChatId.useMutation(),M=eF.d.chat.removeChat.useMutation(),_=eF.d.chat.renameChat.useMutation(),P=async()=>{await M.mutateAsync({id:t,workspaceId:i}),await r(),h(t),k("Chat deleted"),u()},Z=async()=>{if(""===N){k("Chat name cannot be empty");return}await _.mutateAsync({id:t,name:N,workspaceId:i}),r(),f(!1),k("Chat renamed")},A=(0,ex.useRef)(null),L=()=>x?(0,ed.jsxs)("div",{className:"flex gap-2",children:[(0,ed.jsx)(eu.Z,{tooltip:"Approve",display:"bottom",align:"right",shortcut:["⌘","Return"],children:(0,ed.jsx)(eQ.Z,{onClick:Z,className:"text-th-primary-medium hover:text-th-primary-dark cursor-pointer"})}),(0,ed.jsx)(eu.Z,{tooltip:"Cancel",display:"bottom",align:"right",shortcut:["Esc"],children:(0,ed.jsx)(eW,{onClick:()=>f(!1),className:"text-th-primary-medium hover:text-th-primary-dark cursor-pointer"})})]}):g?(0,ed.jsx)(eK,{className:"text-th-primary-medium md:text-transparent md:group-hover:text-th-primary-medium cursor-pointer",onClick:e=>{e.stopPropagation(),v(!g)}}):(0,ed.jsx)(eu.Z,{tooltip:"More options",display:"bottom",align:"right",children:(0,ed.jsx)(eK,{className:"text-th-primary-medium md:text-transparent md:group-hover:text-th-primary-medium cursor-pointer",onClick:e=>{e.stopPropagation(),v(!g)}})}),I=()=>a?(0,ed.jsx)("div",{className:"pl-4 pr-2 flex items-center gap-1 justify-center absolute right-0 h-full",style:{background:"var(--horizontal-gradient-primary)"},children:L()}):x?(0,ed.jsx)("div",{className:"pl-4 pr-2 flex items-center gap-1 justify-center absolute right-0 h-full",style:{background:"var(--horizontal-gradient-primary)"},children:L()}):(0,ed.jsx)("div",{className:"pl-4 pr-2 flex items-center gap-1 justify-center absolute right-0 h-full",style:{background:y?"var(--horizontal-gradient-primary)":"var(--horizontal-gradient-secondary)"},children:L()});return(0,ed.jsx)("div",{onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),children:(0,ed.jsxs)("div",{onClick:async()=>{(null==o?void 0:o.find(e=>e.id==t))?d(t):c({id:t,name:n,icon:l,parentId:s});let e=await O.mutateAsync({chatId:t,workspaceId:i});m(e.messages);let r=e.messages.find(e=>"assistant"==e.role);(null==r?void 0:r.personaId)&&p(r.personaId),S(!1)},className:"".concat(a?"bg-th-background-secondary":""," ").concat(x?"bg-th-background-secondary":""," px-[6px] w-full relative rounded hover:bg-th-background-secondary items-center cursor-pointer group py-[6px] flex gap-2 mb-1"),children:[a?(0,ed.jsx)(tl,{className:"text-th-primary-medium inline min-w-[16px]"}):(0,ed.jsx)(ta,{className:"text-th-primary-medium inline min-w-[16px]"}),(0,ed.jsx)(te,{width:12,height:12,className:"hidden group-hover:inline text-th-primary-dark absolute left-[-4]".concat(a&&"inline"," text-th-primary-medium absolute left-[-14px]")}),x?(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("input",{autoFocus:!0,onClick:()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.focus()},onFocus:()=>j(!0),className:"text-th-primary-medium bg-inherit text-xs whitespace-nowrap flex-1 overflow-hidden outline-none",value:N,onChange:e=>C(e.target.value)}),I()]}):(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("p",{className:"inline text-th-primary-medium text-xs whitespace-nowrap overflow-hidden",children:n}),I()]}),g&&(0,ed.jsx)(ew.Z,{onClickAway:()=>v(!1),children:(0,ed.jsxs)("ul",{tabIndex:0,className:"flex flex-col rounded-sm bg-th-background-modal border border-th-border-primary right-0 absolute mt-[92px] mr-2 z-[10]",onClick:e=>e.stopPropagation(),children:[(0,ed.jsxs)("li",{onClick:()=>{f(!0),v(!1)},className:"flex gap-2 text-th-primary-medium hover:text-th-primary-dark items-center cursor-pointer hover:bg-th-background-hover font-medium text-xs px-3 py-2 border-b border-th-border-secondary",children:[(0,ed.jsx)(eJ,{height:"16",width:"16",className:"text-inherit"}),(0,ed.jsx)("a",{children:"Edit"})]}),(0,ed.jsxs)("li",{onClick:e=>{P(),v(!1)},className:"flex gap-[6px] text-th-primary-medium hover:text-th-primary-dark items-center cursor-pointer hover:bg-th-background-hover font-medium text-xs px-3 py-2 ",children:[(0,ed.jsx)(e0,{height:"16",width:"16",className:"text-inherit"}),(0,ed.jsx)("a",{children:"Delete"})]})]})})]})})},ti=()=>(0,ed.jsx)("div",{className:"w-full bg-transparent flex align-center justify-center py-[6px] w-full mb-1",children:(0,ed.jsx)("p",{className:"text-center text-xs text-th-primary-light",children:"No chats"})}),to=e=>{var t,r,a,n,l,s;let{testIdPrefix:i="",refetch:o,...d}=e,{id:c}=d.node,h=12*d.depth,u=e=>{d.onClick(e,d.node)},m=e=>{e.stopPropagation(),d.onToggle()};return d.isDragging?null===(l=d.containerRef.current)||void 0===l||l.classList.add(eB().dragging):null===(s=d.containerRef.current)||void 0===s||s.classList.remove(eB().dragging),(0,ed.jsxs)("div",{style:{paddingInlineStart:h},"data-testid":"".concat(i,"custom-node-").concat(c),onClick:u,children:["folder"==d.node.data.type&&(0,ed.jsx)(tt,{id:d.node.id,isOpen:d.isOpen,icon:d.node.data.icon,droppable:d.node.droppable,text:d.node.text,handleToggle:m,refetch:o}),(null===(t=d.node.data)||void 0===t?void 0:t.type)==="chat"&&(0,ed.jsx)(ts,{id:d.node.id,isOpen:d.isOpen,droppable:d.node.droppable,text:d.node.text,icon:null===(r=d.parent)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.icon,handleToggle:m,refetch:o,parentId:d.node.data.parentId}),(null===(n=d.node.data)||void 0===n?void 0:n.type)=="empty_chat"&&(0,ed.jsx)(ti,{})]})};function td(){let{tree:e,setTree:t}=(0,em.zp)(),{tabs:r}=(0,em.zR)(),{workspaceId:a,setWorkspaceId:n}=(0,em.Oz)(),l=eF.d.chat.moveFolder.useMutation(),s=eF.d.chat.moveChat.useMutation(),[i,o]=(0,ex.useState)([]),{user:d}=(0,eO.useUser)(),{data:c,refetch:h}=eF.d.chat.loadTree.useQuery({workspaceId:a},{enabled:!!a&&!!(null==d?void 0:d.id)});(0,ex.useEffect)(()=>{c&&t(function(e){let t=[],r={},a={id:null==e?void 0:e.id,text:null==e?void 0:e.name,parent:"0",droppable:!1,data:{type:"workspace"}};for(let n of(t.push(a),null==e?void 0:e.data)){if(n.hidden)continue;let a={id:n.id,text:n.name,parent:n.parentId?n.parentId:e.id,droppable:"folder"===n.type,data:{type:n.type,messages:n.messages||[],icon:n.icon}};n.parentId&&(r[n.parentId]?r[n.parentId]+=1:n.parentId==e.id||(r[n.parentId]=1)),t.push(a)}let n=t.map(e=>e.id),l=[];for(let a of n)if(a!==e.id&&!r[a]){let e={id:a+"_empty"+Math.random(),text:"Empty chat",parent:a,droppable:!1,data:{type:"empty_chat"}};l.push(a),t.push(e)}return t}(null==c?void 0:c[0]))},[c]);let[u,m]=(0,ex.useState)([]),[p,x]=(0,ex.useState)(!1),[f,g]=(0,ex.useState)(!1),{showToast:v}=(0,e4.pm)();(0,ex.useEffect)(()=>{let e=e=>{"escape"===e.key.toLowerCase()?m([]):(e.ctrlKey||e.metaKey)&&g(!0)},t=e=>{("control"===e.key.toLowerCase()||"meta"===e.key.toLowerCase())&&g(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]);let y=e=>{m([e])},b=t=>{let r=u.map(e=>e.id);if(r.includes(t.id)||r.some(r=>(0,eG.jg)(e,r,t.id)))return;let a=[...u];m(a=[...a=a.filter(r=>!(0,eG.jg)(e,t.id,r.id)),t])},w=(e,t)=>{e.ctrlKey||e.metaKey?b(t):y(t)},j=e=>{let t=u.some(t=>t.id===e.id);if(x(!0),f||!t){if(!f){m([e]);return}u.some(t=>t.id===e.id)||m([...u,e])}},k=async(e,t)=>{var r,n;let{dragSource:i,dropTargetId:o}=t;m([]),(null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.type)==="folder"?(await l.mutateAsync({id:null==i?void 0:i.id,parentId:o,workspaceId:a}),v("Moved folder")):(null==i?void 0:null===(n=i.data)||void 0===n?void 0:n.type)==="chat"&&(await s.mutateAsync({id:null==i?void 0:i.id,parentId:o,workspaceId:a}),v("Moved chat")),h()};return(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("div",{className:"flex-1",children:(0,ed.jsx)(eU.W,{backend:eD.PD,options:(0,eG.bK)(),children:(0,ed.jsx)(eG.mp,{rootId:a,tree:e,onDrop:k,enableAnimateExpand:!0,onDragStart:j,sort:(e,t)=>"createFolder"===t.data.type?1:"createFolder"===e.data.type?-1:"folder"===e.data.type&&"chat"===t.data.type?-1:"chat"===e.data.type&&"folder"===t.data.type?1:e.text.localeCompare(t.text),onDragEnd:console.log,onChangeOpen:e=>o(e),canDrop:(e,t)=>{if(u.some(e=>e.id===t.dropTargetId))return!1},render:(t,a)=>(u.some(e=>(null==e?void 0:e.id)===t.id),(0,ed.jsx)(ed.Fragment,{children:(0,ed.jsx)(to,{node:t,getPipeHeight:4,refetch:h,...a,isSelected:!1,isOpen:"chat"==t.data.type?r.find(e=>e.id===t.id):a.isOpen,isDragging:!1,onClick:"folder"==t.data.type?w:()=>{},parent:e.find(e=>e.id===t.parent)||null})}))})})}),(0,ed.jsx)("div",{className:"sticky bottom-0 left-0 z-10",children:(0,ed.jsx)("div",{className:"w-full h-[40px]",style:{background:"var(--vertical-gradient)"}})})]})}function tc(){return(tc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var th=function(e){return ex.createElement("svg",tc({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none",viewBox:"0 0 16 16"},e),M||(M=ex.createElement("rect",{width:11.833,height:10.167,x:2.083,y:2.75,stroke:"currentColor",strokeWidth:1.5,rx:3.25})),_||(_=ex.createElement("path",{fill:"currentColor",stroke:"currentColor",strokeWidth:1.5,d:"M5.583 12.916h-.25a3.25 3.25 0 0 1-3.25-3.25V6a3.25 3.25 0 0 1 3.25-3.25h.25v10.166Z"})))};function tu(){return(tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var tm=function(e){return ex.createElement("svg",tu({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none",viewBox:"0 0 16 16"},e),P||(P=ex.createElement("rect",{width:11.833,height:10.167,x:2.083,y:2.75,stroke:"currentColor",strokeWidth:1.5,rx:3.25})),Z||(Z=ex.createElement("path",{stroke:"currentColor",strokeWidth:1.5,d:"M5.583 12.916h-.25a3.25 3.25 0 0 1-3.25-3.25V6a3.25 3.25 0 0 1 3.25-3.25h.25v10.166Z"})))};let tp=()=>{let{tree:e,setTree:t}=(0,em.zp)(),{workspaceId:r}=(0,em.Oz)(),{isSidebarOpen:a,setIsSidebarOpen:n}=(0,em.Nh)(),{setShowSettings:l}=(0,em.F2)(),{isFocused:s,setIsFocused:i}=(0,em.Nf)(),{isEditingFolder:o,setIsEditingFolder:d,setActiveFolderId:c}=(0,em.t3)(),{showToast:h}=(0,e4.pm)(),[u,m]=(0,ex.useState)(!1),[p,x]=(0,ex.useState)(!1),f=eF.d.chat.createFolder.useMutation(),{user:g}=(0,eO.useUser)(),{data:v,refetch:y}=eF.d.chat.loadTree.useQuery({workspaceId:r},{enabled:!!r&&!!(null==g?void 0:g.id)}),b=()=>{m(!0)},w=()=>{m(!1)},j=()=>{x(!0)},k=()=>{x(!1)};async function N(){let e=await f.mutateAsync({name:"",parentId:r,workspaceId:r});c(e.folder.id),d(!0),await y(),h("Created folder")}let[C,E]=(0,ex.useState)(!0),{tabs:S,activeTabId:O,addTab:M,setActiveTabId:_}=(0,em.zR)(),{defaultPersonaId:P}=(0,em.Gm)(),{messages:Z,clearMessages:A,setMessagePersona:L}=(0,em.GH)();return(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsxs)("div",{className:"hidden lg:flex absolute left-0 top-0 py-3 px-4 z-[11] items-center",children:[(0,ed.jsx)(eu.Z,{tooltip:"Open sidebar",display:"bottom",align:"left",children:(0,ed.jsx)("div",{onClick:()=>E(!0),className:"relative z-[11] p-2 rounded bg-transparent cursor-pointer hover:bg-th-background-hover text-th-primary-light hover:text-th-primary-dark",children:(0,ed.jsx)(tm,{height:"16",width:"16"})})}),(0,ed.jsx)(eu.Z,{tooltip:"New chat",display:"bottom",align:"right",children:(0,ed.jsx)("div",{onClick:function(){let e=S.find(e=>"Untitled"===e.name);if(Z.length>0&&!e){let e=ep(r);A(),M(e),i(!0)}else e&&(A(),_(e.id),i(!0))},className:" relative z-[11] p-2 rounded bg-transparent cursor-pointer hover:bg-th-background-hover text-th-primary-light hover:text-th-primary-dark",children:(0,ed.jsx)(eg,{height:"20",width:"20"})})})]}),(0,ed.jsxs)("div",{className:"absolute z-20 lg:relative flex flex-col ".concat(a?"w-[280px]":"w-0 overflow-hidden"," h-full bg-th-background border-r flex flex-col border-th-border-primary duration-100  ").concat(C?"lg:w-[280px] lg:overflow-visible":"lg:w-0 lg:overflow-hidden"," "),children:[(0,ed.jsxs)("div",{className:"sticky top-0 z-10 bg-transparent flex flex-col",children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-2 px-4 pt-3 pb-2 bg-transparent",children:[(0,ed.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ed.jsx)(eT,{}),(0,ed.jsx)(eu.Z,{tooltip:"Settings",display:"bottom",align:"right",children:(0,ed.jsx)("div",{onClick:()=>l(!0),className:"p-2 rounded bg-transparent cursor-pointer hover:bg-th-background-hover text-th-primary-light hover:text-th-primary-dark",children:(0,ed.jsx)(ek,{height:"16",width:"16"})})}),(0,ed.jsx)(eu.Z,{tooltip:"Close sidebar",display:"bottom",align:"right",children:(0,ed.jsx)("div",{onClick:()=>E(!1),className:"p-2 rounded bg-transparent cursor-pointer hover:bg-th-background-hover text-th-primary-light hover:text-th-primary-dark",children:(0,ed.jsx)(th,{height:"16",width:"16"})})})]}),(0,ed.jsx)("div",{onClick:()=>n(!1),children:(0,ed.jsx)(eb,{})})]}),(0,ed.jsxs)("div",{className:"group flex px-4 py-2",onMouseEnter:j,onMouseLeave:k,children:[(0,ed.jsx)("p",{className:"text-sm text-th-primary-light leading-5 font-medium grow whitespace-nowrap",children:"Folders"}),(u||p)&&(0,ed.jsx)(eu.Z,{tooltip:"Add folder",display:"bottom",align:"right",children:(0,ed.jsx)(eg,{onClick:N,className:"inline cursor-pointer",height:"16",width:"16"})})]})]}),(0,ed.jsx)("div",{className:"relative h-full flex flex-col overflow-y-scroll px-4",onMouseEnter:b,onMouseLeave:w,children:(0,ed.jsx)(td,{})})]})]})};var tx=r(5632);function tf(){return(tf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var tg=function(e){return ex.createElement("svg",tf({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none","aria-label":"Menu"},e),A||(A=ex.createElement("g",{clipPath:"url(#menu_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1Zm0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1ZM3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1Z"}))),L||(L=ex.createElement("defs",null,ex.createElement("clipPath",{id:"menu_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h24v24H0z"})))))},tv=r(1503),ty=r(6079);function tb(e,t){this.INITIALIZING=-1,this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,this.url=e,t=t||{},this.headers=t.headers||{},this.payload=void 0!==t.payload?t.payload:"",this.method=t.method||this.payload&&"POST"||"GET",this.withCredentials=!!t.withCredentials,this.FIELD_SEPARATOR=":",this.listeners={},this.xhr=null,this.readyState=this.INITIALIZING,this.progress=0,this.chunk="",this.addEventListener=function(e,t){void 0===this.listeners[e]&&(this.listeners[e]=[]),-1===this.listeners[e].indexOf(t)&&this.listeners[e].push(t)},this.removeEventListener=function(e,t){if(void 0!==this.listeners[e]){var r=[];this.listeners[e].forEach(function(e){e!==t&&r.push(e)}),0===r.length?delete this.listeners[e]:this.listeners[e]=r}},this.dispatchEvent=function(e){if(!e)return!0;e.source=this;var t="on"+e.type;return(!this.hasOwnProperty(t)||(this[t].call(this,e),!e.defaultPrevented))&&(!this.listeners[e.type]||this.listeners[e.type].every(function(t){return t(e),!e.defaultPrevented}))},this._setReadyState=function(e){var t=new CustomEvent("readystatechange");t.readyState=e,this.readyState=e,this.dispatchEvent(t)},this._onStreamFailure=function(e){console.error("SSE failed"),console.error(e),this.dispatchEvent(new CustomEvent("error",{detail:e.type})),this.close()},this._onStreamProgress=function(e){if(this.xhr){if(200!==this.xhr.status){this._onStreamFailure(e);return}this.readyState==this.CONNECTING&&(this.dispatchEvent(new CustomEvent("open")),this._setReadyState(this.OPEN));var t=this.xhr.responseText.substring(this.progress);this.progress+=t.length,t.split(/(\r\n|\r|\n){2}/g).forEach((function(e){0===e.trim().length?(this.dispatchEvent(this._parseEventChunk(this.chunk.trim())),this.chunk=""):this.chunk+=e}).bind(this))}},this._onStreamLoaded=function(e){this._onStreamProgress(e),this.dispatchEvent(this._parseEventChunk(this.chunk)),this.chunk=""},this._parseEventChunk=function(e){if(!e||0===e.length)return null;var t={id:null,retry:null,data:"",event:"message"};e.split(/\n|\r\n|\r/).forEach((function(e){var r=(e=e.trimRight()).indexOf(this.FIELD_SEPARATOR);if(!(r<=0)){var a=e.substring(0,r);if(a in t){var n=e.substring(r+1).trimLeft();"data"===a?t[a]+=n:t[a]=n}}}).bind(this));var r=new CustomEvent(t.event);return r.data=t.data,r.id=t.id,r},this._checkStreamClosed=function(){this.xhr&&this.xhr.readyState===XMLHttpRequest.DONE&&this._setReadyState(this.CLOSED)},this.stream=function(){for(var e in this._setReadyState(this.CONNECTING),this.xhr=new XMLHttpRequest,this.xhr.addEventListener("progress",this._onStreamProgress.bind(this)),this.xhr.addEventListener("load",this._onStreamLoaded.bind(this)),this.xhr.addEventListener("readystatechange",this._checkStreamClosed.bind(this)),this.xhr.addEventListener("error",this._onStreamFailure.bind(this)),this.xhr.addEventListener("abort",this._onStreamFailure.bind(this)),this.xhr.open(this.method,this.url),this.headers)this.xhr.setRequestHeader(e,this.headers[e]);delete this.headers["Content-Length"],this.xhr.withCredentials=this.withCredentials,this.xhr.send(this.payload)},this.close=function(){this.readyState!==this.CLOSED&&(this.xhr.abort(),this.xhr=null,this._setReadyState(this.CLOSED))}}class tw{start(){this.eventSource=new tb(this.url,{method:"POST",payload:this.payload,headers:this.headers}),this.eventSource.addEventListener("start",()=>{this.startCallback&&this.startCallback()}),this.eventSource.addEventListener("message",e=>{let t=JSON.parse(e.data);if(t.error){this.errorCallback&&this.errorCallback(t.error),this.end();return}this.dataCallback&&(this.dataCallback(t),this.receivedData.push(t))}),this.eventSource.addEventListener("error",e=>{this.errorCallback&&this.errorCallback(e)}),this.eventSource.addEventListener("end",e=>{this.endCallback&&this.endCallback(this.receivedData)}),this.eventSource.stream()}end(){try{var e;null===(e=this.eventSource)||void 0===e||e.close()}catch(e){}}close(){this.end()}constructor(e,t,r,a,n,l,s){this.startCallback=null,this.dataCallback=null,this.endCallback=null,this.errorCallback=null,this.url=e,this.eventSource=null,this.receivedData=[],this.headers=t,this.payload=r,this.startCallback=a,this.dataCallback=n,this.endCallback=l,this.errorCallback=s}}var tj=r(7164);let tk=(0,tj.kP)("1234567890abcdefghijklmnopqrstuvwxyz",16);var tN=r(9914);function tC(){return(tC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var tE=function(e){return ex.createElement("svg",tC({xmlns:"http://www.w3.org/2000/svg",width:13,height:12,fill:"none"},e),I||(I=ex.createElement("path",{fill:"#858699",d:"M11.167 6.667V10c0 .367-.3.667-.667.667h-8A.669.669 0 0 1 1.833 10V6.667c0-.367-.3-.667-.666-.667C.8 6 .5 6.3.5 6.667v4C.5 11.4 1.1 12 1.833 12h9.334c.733 0 1.333-.6 1.333-1.333v-4c0-.367-.3-.667-.667-.667-.366 0-.666.3-.666.667Zm-4-.22L8.42 5.193a.664.664 0 1 1 .94.94L6.967 8.527c-.26.26-.68.26-.94 0L3.633 6.133a.664.664 0 1 1 .94-.94l1.26 1.254V.667C5.833.3 6.133 0 6.5 0c.367 0 .667.3.667.667v5.78Z"})))};let tS=e=>{let{}=e,[t,r]=(0,ex.useState)(!1),{activeTabId:a}=(0,em.zR)(),{workspaceId:n}=(0,em.Oz)(),l=eF.d.chat.unhideChat.useMutation(),{refetch:s}=eF.d.chat.loadTree.useQuery({workspaceId:n});return(0,ex.useEffect)(()=>{t&&setTimeout(()=>{r(!1)},1250)},[t]),(0,ed.jsx)(ev.Z,{tooltip:"Click to save chat while on Manual mode",shortcut:["⌘ + S"],children:(0,ed.jsxs)("div",{className:"pointer-events-auto shadow group flex h-[36px] text-sm font-medium gap-1 px-3 py-2 border rounded cursor-pointer bg-th-background text-th-primary-medium items-center border-th-border-secondary ".concat(t?"cursor-default border-th-primary-light bg-th-background-hover text-th-primary-dark":"hover:border-th-primary-light shadow hover:bg-th-background-hover hover:text-th-primary-dark"),onClick:async()=>{r(!0),await l.mutateAsync({chatId:a}),await s()},children:[(0,ed.jsx)(tE,{}),(0,ed.jsx)("p",{className:"text-sm font-medium whitespace-nowrap ",children:t?"Saved chat":"Save chat"})]})})};function tO(){return(tO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var tM=function(e){return ex.createElement("svg",tO({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"Stop circle"},e),z||(z=ex.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 10.666h4c.367 0 .667-.3.667-.666V6c0-.367-.3-.667-.667-.667H6c-.367 0-.667.3-.667.667v4c0 .366.3.666.667.666Zm2-9.333A6.67 6.67 0 0 0 1.333 8 6.67 6.67 0 0 0 8 14.666 6.67 6.67 0 0 0 14.667 8 6.67 6.67 0 0 0 8 1.333Z",clipRule:"evenodd"})))};let t_=e=>{let{streamSource:t}=e,{setIsStreaming:r}=(0,em.GH)(),{showToast:a}=(0,e4.pm)(),n=()=>{null==t||t.close(),r(!1),a("Generation stopped")};return(0,ed.jsxs)("div",{onClick:()=>{n()},className:"pointer-events-auto group flex z-[8] pointer-events-all shadow items-center border rounded border-th-border-secondary cursor-pointer bg-th-background text-th-primary-medium gap-1 px-3 py-2 h-[36px] hover:border-th-primary-medium shadow hover:bg-th-background-secondary hover:text-th-primary-dark",children:[(0,ed.jsx)(tM,{}),(0,ed.jsx)("p",{className:"text-sm font-medium ",children:"Stop generating"})]})};var tP=r(203),tZ=r(5641),tA=r(8316),tL=r(1511);let tI=e=>{let{avatarUrl:t,gifUrl:r,name:a,id:n,onMouseOver:l,isSelected:s,onSelectPersona:i,handle:o}=e;return(0,ed.jsxs)("div",{onMouseOver:l,onMouseDown:i,className:"opacity-1 w-full border-b border-th-border-secondary flex px-2 py-[6px] items-center gap-2 bg-th-background-modal hover:bg-th-background-hover last:border-none cursor-pointer ".concat(s&&"bg-th-background"),children:[(0,ed.jsx)(e_(),{src:r||t||"",width:24,height:24,className:"rounded",alt:a,unoptimized:!0}),(0,ed.jsxs)("p",{className:"flex-1 text-xs",children:["@",o]}),s&&(0,ed.jsx)(tL.Z,{})]})},tz=e=>{let{children:t}=e;return tA.createPortal(t,document.body)},tF=[{command:"#image",label:"Generate image"},{command:"#transcribe",label:"Transcribe MP3 files or Youtube videos"},{command:"#ask",label:"Ask questions about PDFs"}],tH=e=>{var t;let{show:r,search:a,onSelectPersona:n,isPersona:l,isExtension:s}=e,i=(0,ex.useRef)(),o=(0,tZ.UE)(),{addedPersonas:d}=(0,em.Gm)(),c=(0,ex.useMemo)(()=>d.filter(e=>e.isEnabled),[d]);(0,ex.useEffect)(()=>{let e=i.current;if(!e)return;if(!o||!r){e.style.display="none";return}let t=window.getSelection();if(r&&t&&t.rangeCount>0){let r=t.getRangeAt(0),a=null==r?void 0:r.getBoundingClientRect(),n=e.offsetWidth;e.style.opacity="1",e.style.top="".concat(a.top+window.pageYOffset-e.offsetHeight,"px"),e.style.left="".concat(a.left+window.pageXOffset-e.offsetWidth/2+a.width/2+n/2,"px"),e.style.display="block"}});let[h,u]=(0,ex.useState)(null);return(0,ex.useEffect)(()=>{var e,t;l?u(null===(e=null==c?void 0:c.filter(e=>e.name.replace(/\s/g,"").toLowerCase().includes(null==a?void 0:a.replace("@","").toLowerCase())))||void 0===e?void 0:e[0]):s&&u(null===(t=null==tF?void 0:tF.filter(e=>{var t;return null===(t=e.command)||void 0===t?void 0:t.toLowerCase().includes(null==a?void 0:a.toLowerCase())}))||void 0===t?void 0:t[0])},[a,d]),(0,ex.useEffect)(()=>{let e=e=>{r&&("Tab"===e.key||"Enter"===e.key)&&(e.preventDefault(),n(s&&(null==h?void 0:h.command)?h.command:h))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,h,n]),(0,ed.jsx)(tz,{children:(0,ed.jsxs)("div",{ref:i,className:"absolute z-[100] w-64 left-0 mt-[-6px] bg-th-modal border border-th-border-primary rounded shadow rounded overflow-y-auto max-h-[50vh] scrollbar-thin",children:[(0,ed.jsx)("div",{className:"p-[6px] sticky top-0 bg-th-background border-b border-th-border-secondary",children:(0,ed.jsx)("p",{className:"text-xs font-medium text-th-primary-dark text-center",children:"Press Tab or Enter to select"})}),l&&(null===(t=null==c?void 0:c.filter(e=>e.name.replace(/\s/g,"").toLowerCase().includes(null==a?void 0:a.replace("@","").toLowerCase())))||void 0===t?void 0:t.map((e,t)=>(0,ed.jsx)(tI,{...e,onMouseOver:()=>u(e),isSelected:e.id===(null==h?void 0:h.id),onSelectPersona:()=>n(h)},t))),s&&(null==tF?void 0:tF.filter(e=>{var t;return null===(t=e.command)||void 0===t?void 0:t.includes(null==a?void 0:a.replace("#","").toLowerCase())}).map((e,t)=>(0,ed.jsxs)("div",{className:"border-b border-th-border-secondary px-2 py-[6px] bg-th-background-modal text-th-primary-medium hover:bg-th-background-hover hover:text-th-primary-dark cursor-pointer",onMouseOver:()=>{console.log("hovered"),u(e.command)},onMouseDown:()=>{console.log("clicekd"),setTimeout(()=>{u(e.label)},10),n(h)},children:[(0,ed.jsx)("p",{className:"text-sm text-th-primary-dark",children:e.command}),(0,ed.jsx)("p",{className:"text-xs text-th-primary-light",children:e.label})]})))]})})},tT=/@(?!\s)[a-zA-Z0-9_.]*/g,tR=/#(?!\s)[a-zA-Z0-9_.]*/g,tU=e=>{let{attributes:t,children:r,leaf:a}=e;return(0,ed.jsx)("span",{style:"user"===a.type?{color:"var(--brand-primary)",background:"var(--brand-secondary)"}:"channel"===a.type?{color:"#2b9c5a"}:{},...t,children:r})},tD=(e,t,r,a,n,l)=>{let[s,i]=e;if(!tP.xv.isText(s))return[];let o=[],d=[],c=null;for(;null!==(c=tT.exec(s.text));){let e={type:"user",anchor:{path:i,offset:c.index},focus:{path:i,offset:c.index+c[0].length}};n?tP.e6.equals(e,n)&&o.push(e):o.push(e)}for(;null!==(c=tR.exec(s.text));){let e={type:"channel",anchor:{path:i,offset:c.index},focus:{path:i,offset:c.index+c[0].length}};l?tP.e6.equals(e,l)&&d.push(e):d.push(e)}let h=!1;for(let e of o)(null===tP.e6||void 0===tP.e6?void 0:tP.e6.intersection(e,{anchor:null==a?void 0:a.anchor,focus:null==a?void 0:a.focus}))&&(h=!0);t(h);let u=!1;for(let e of d)(null===tP.e6||void 0===tP.e6?void 0:tP.e6.intersection(e,{anchor:null==a?void 0:a.anchor,focus:null==a?void 0:a.focus}))&&(u=!0);return r(u),[...o,...d]};function tG(e){for(let a of e){var t,r;let e=null==a?void 0:null===(t=a.children)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:r.text,n=tT.exec(e);if(n)return{anchor:{path:[0,0],offset:n.index},focus:{path:[0,0],offset:n.index+n[0].length}}}}function tV(e){for(let a of e){var t,r;let e=null==a?void 0:null===(t=a.children)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:r.text,n=tR.exec(e);if(n)return{anchor:{path:[0,0],offset:n.index},focus:{path:[0,0],offset:n.index+n[0].length}}}}let tB=[{type:"paragraph",children:[{text:""}]}],tQ=e=>[{type:"paragraph",children:[{text:e}]}];function tY(e){tP.YR.delete(e,{at:{anchor:tP.ML.start(e,[]),focus:tP.ML.end(e,[])}})}let tW=e=>{let{onChange:t,onSubmit:r,personaSearch:a,extensionSearch:n}=e,l=(0,ex.useMemo)(()=>(0,tZ.BU)((0,tP.Jh)()),[]),s=(0,tZ.UE)(),{prompt:i,isFocused:o,setIsFocused:d,retryPrompt:c}=(0,em.Nf)(),{isStreaming:h,messagePersona:u,setMessagePersona:m}=(0,em.GH)(),{defaultPersonaId:p,personas:x}=(0,em.Gm)(),{fileData:f}=(0,em.O_)(),{showEditModal:g,showCreateModal:v}=(0,em.Yf)(),y=(0,ex.useMemo)(()=>{if(u){let e=x.find(e=>e.id===u);if(e)return e}else{let e=x.find(e=>e.id===p);if(e)return e}},[p,x,u]);(0,ex.useEffect)(()=>{o?s||tZ.F3.focus(l):s&&tZ.F3.blur(l)},[o,l,s]);let[b,w]=(0,ex.useState)(tB),[j,k]=(0,ex.useState)(!1),[N,C]=(0,ex.useState)(!1);(0,ex.useEffect)(()=>{t(function(e){let t=[];for(let n of e){var r,a;t.push(null==n?void 0:null===(r=n.children)||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:a.text)}return t.join("\n")}(b))},[b,t]);let E=(0,ex.useCallback)(()=>{r()},[r]),[S,O]=(0,ex.useState)(null),[M,_]=(0,ex.useState)(null);(0,ex.useEffect)(()=>{h&&tY(l)},[h,l]),(0,ex.useEffect)(()=>{""!==c.content&&function(e,t){tY(e);let r=[0],a=tQ(t);tP.YR.removeNodes(e,{at:r}),tP.YR.insertNodes(e,a,{at:r,select:!0})}(l,c.content)},[c]),(0,ex.useEffect)(()=>{let e=e=>{"Enter"!==e.key||navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/)||!o||e.shiftKey||j||N||g||v||!(i.trim().length>0)&&!f||(e.preventDefault(),E(),tY(l))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[b,l,E]);let P=e=>{if(!e)return;let t=tV(b);tP.YR.select(l,t),tP.YR.delete(l),tP.YR.insertText(l,e+" ");let r={type:"channel",anchor:{path:t.anchor.path,offset:t.anchor.offset},focus:{path:t.anchor.path,offset:t.anchor.offset+e.length+2}};_(r),k(!1)},Z=e=>{console.log("HERE"),console.log(e);let t=tG(b);if(!t)return;console.log("RANGE EXISTS"),m(e.personaId),tP.YR.select(l,t),tP.YR.delete(l),tP.YR.insertText(l,"@"+e.handle+" ");let r={type:"user",anchor:{path:t.anchor.path,offset:t.anchor.offset},focus:{path:t.anchor.path,offset:t.anchor.offset+e.handle.length+2}};O(r),k(!1)};(0,ex.useEffect)(()=>{if(null!==M){let e=tV(b);e||_(null),e&&!tP.e6.equals(M,e)&&_(null)}},[b,M]),(0,ex.useEffect)(()=>{if(null!==S){let e=tG(b);e||O(null),e&&!tP.e6.equals(S,e)&&O(null)}},[b,S]);let{user:A}=(0,eO.useUser)();return(0,ed.jsx)("div",{className:"w-full rounded bg-inherit resize-none outline-none ",children:(0,ed.jsxs)(tZ.mH,{editor:l,value:b,onChange:w,children:[A&&(0,ed.jsx)(tH,{show:!S&&j,search:a,onSelectPersona:Z,isPersona:!0}),A&&(0,ed.jsx)(tH,{show:!M&&N,search:n,onSelectPersona:P,isExtension:!0}),(0,ed.jsx)(tZ.CX,{decorate:e=>tD(e,k,C,l.selection,S,M),placeholder:"Message @".concat(null==y?void 0:y.handle),renderLeaf:A?tU:void 0,className:"text-th-primary-dark",style:{whiteSpace:"pre-wrap",height:"100%",maxHeight:"240px",wordBreak:"break-word",overflow:"auto",padding:0},onBlur:()=>{d(!1)},onFocus:()=>{d(!0)}})]})})};function tq(){return(tq=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var tK=function(e){return ex.createElement("svg",tq({xmlns:"http://www.w3.org/2000/svg",fill:"none","aria-label":"Attach file",viewBox:"0 0 20 20"},e),F||(F=ex.createElement("g",{clipPath:"url(#attach_file_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M13.75 5.625v8.817c0 1.741-1.275 3.291-3.008 3.458a3.328 3.328 0 0 1-3.659-3.317v-10.3c0-1.091.784-2.083 1.867-2.191 1.25-.125 2.3.85 2.3 2.075v8.75a.836.836 0 0 1-.833.833.836.836 0 0 1-.834-.833V5.625A.63.63 0 0 0 8.958 5a.63.63 0 0 0-.625.625V12.8c0 1.092.784 2.083 1.867 2.192 1.25.125 2.3-.85 2.3-2.075V4.308c0-1.741-1.275-3.291-3.008-3.458a3.332 3.332 0 0 0-3.659 3.317v10.225c0 2.391 1.75 4.533 4.134 4.758A4.588 4.588 0 0 0 15 14.583V5.625A.63.63 0 0 0 14.375 5a.63.63 0 0 0-.625.625Z"}))),H||(H=ex.createElement("defs",null,ex.createElement("clipPath",{id:"attach_file_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h20v20H0z"})))))};r(2382);let tX=e=>{let{onClick:t}=e,{fileData:r,setFileData:a}=(0,em.O_)(),{showToast:n}=(0,e4.pm)(),{getToken:l}=(0,eO.useAuth)(),{setIsFocused:s}=(0,em.Nf)();return(0,ex.useEffect)(()=>{r||(a(r),s(!0))},[r]),(0,ed.jsx)(ed.Fragment,{children:(0,ed.jsx)("button",{onClick:t,children:(0,ed.jsx)(tK,{className:"w-5 h-5 text-th-primary-light group-hover:text-th-primary-dark"})})})};var tJ=r(7491);async function t$(e,t,r,a,n,l,s,i,o){let d=a.filter(e=>{var t;return(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.type)==="folder"}).map(e=>{var t;return{id:e.id,name:e.text,icon:(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.icon)||""}}),c=d.map(e=>e.name),h=await n({name:r,folderArray:c,workspaceId:e}),u=null==d?void 0:d.find(e=>e.name.toLowerCase()===h.folder.toLowerCase().trim());u&&(await l({id:t,parentId:u.id,workspaceId:e}),s(t,"icon",u.icon),i("Chat sorted into ".concat(e5(null==u?void 0:u.icon)||""," ").concat(h.folder)),await o())}let t0=(0,eI.Ue)(e=>({signupModal:{show:!1,message:""},setSignupModal:(t,r)=>e({signupModal:{show:t,message:r}})})),t1=()=>{let{showToast:e}=(0,e4.pm)(),{getToken:t}=(0,eO.useAuth)(),{pathname:r}=(0,tx.useRouter)(),{workspaceId:a,internetMode:n,autosave:l}=(0,em.Oz)(),{setSignupModal:s}=t0(),{messages:i,addMessage:o,appendLastMessage:d,setIsStreaming:c,setIsDeletingMessage:h,setIsEditingMessage:u,setMessageActionId:m,shouldResubmit:p,setShouldResubmit:x,updateLastMessage:f,updateLastMessageModel:g,isStreaming:v,messagePersona:y,setMessagePersona:b,signature:w,removeLastMessage:j}=(0,em.GH)(),{isPersonasMenuOpen:k,setIsPersonasMenuOpen:N,isPlusMenuOpen:C,setIsPlusMenuOpen:E}=(0,em.Ls)(),{activeTabId:S,setActiveTabId:O,updateTabById:M}=(0,em.zR)(),{setScroll:_}=(0,em.CR)(),{isFocused:P,setIsFocused:Z,model:A,autoSend:L,prompt:I,setPrompt:z,setRetryPrompt:F,setAutoSend:H,setModel:T,shouldContinue:R,setShouldContinue:U}=(0,em.Nf)(),{fileData:D,setFileData:G}=(0,em.O_)(),{setShowAddCredits:V}=(0,em.F2)(),{tree:B}=(0,em.zp)(),{defaultPersonaId:Q}=(0,em.Gm)(),{refetch:Y}=eF.d.chat.loadTree.useQuery({workspaceId:a},{enabled:!!a&&!r.includes("share"),refetchOnMount:!1}),W=eF.d.chat.renameChat.useMutation(),q=eF.d.chat.generateName.useMutation(),K=eF.d.chat.createShareLink.useMutation(),X=eF.d.chat.sortChat.useMutation(),J=eF.d.chat.moveChat.useMutation(),[$,ee]=(0,ex.useState)(!1),[et,er]=(0,ex.useState)(null),[ea,en]=(0,ex.useState)(null),[el,es]=(0,ex.useState)(),{user:ei}=(0,eO.useUser)();(0,ex.useEffect)(()=>{console.log(Q,y),Q&&(y&&""!=y?y&&y!=Q&&b(y):b(Q))},[Q,y]),(0,ex.useEffect)(()=>{R&&(U(!1),ev({continueGeneration:!0}))},[R]),(0,ex.useEffect)(()=>{if(L){let e=tk();M(S,"id",e),O(e);let t={id:e,content:"",parentId:S,role:"assistant",createdAt:new Date,personaId:y,model:A};z(""),o(t),I.split("").forEach((e,t)=>{setTimeout(()=>{d(e)},3*t)}),b(Q),H(!1),Z(!0)}H(!1)},[L]),(0,ex.useEffect)(()=>{p&&(ev(),x(!1))},[p]),(0,ex.useEffect)(()=>{(function(e,t){if(tT.test(e)){let r=e.match(tT),a=null==r?void 0:r[0];a&&t(a)}else t(null)})(I,er),function(e,t){if(tR.test(e)){let r=e.match(tR),a=null==r?void 0:r[0];a&&t(a)}else t(null)}(I,en)},[I]),(0,ex.useEffect)(()=>{h(!1),u(!1),m("")},[v]);let eo=async(t,r)=>{let{title:n}=await q.mutateAsync({messages:r});M(t,"name",n),await W.mutateAsync({id:t,name:n,workspaceId:a}),await t$(a,t,n,B,X.mutateAsync,J.mutateAsync,M,e,Y)},ec=()=>{c(!1),ee(!0)},eh=async()=>{c(!0),z(""),_(!0)};function ep(e,t,r){let a={id:tk(),content:t,role:r,parentId:S,createdAt:new Date,personaId:y,model:A};o(a),e.push(a)}function ef(e){e&&d(e),A&&g(A)}let eg={continueGeneration:!1},ev=async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eg;if(!ei&&"true"==localStorage.getItem("max-free-api-requests")){ec(),s(!0,"Create an account to continue chatting for free.");return}try{var o,d,c,h;let u,m,p=ei?[]:[...i],x="";eh(),r.continueGeneration||ep(p,I,"user"),ep(p,"","assistant");let g=(null==ei?void 0:ei.id)?"https://streaming.tenant-forefront-default.knative.chi.coreweave.com/chat":"https://streaming.tenant-forefront-default.knative.chi.coreweave.com/chat".replace("chat","free-chat");switch(l){case"always":default:m=!1;break;case"manual":m=!0}let v=new tw(g,{"Content-Type":"application/json",authorization:"Bearer ".concat(await t()),"x-signature":w},JSON.stringify({text:(null==r?void 0:r.continueGeneration)==!0?"x":I,action:(o=i,d=ei,c=x,h=r,(null==h?void 0:h.continueGeneration)==!0?"keep-going":d?(null==o?void 0:o.length)==1&&(null==o?void 0:o[0].role)=="assistant"?"new:greeting":""!=c?"continue":o.length>0?"continue":"new":"noauth"),id:x||S,parentId:a,workspaceId:a,messagePersona:y,model:A,messages:i,internetMode:n,hidden:m}),()=>{},e=>{e.chatId?(M(S,"id",e.chatId),O(e.chatId),x=e.chatId):e.delta?ef(e.delta):e.text?f(e.text):e.links&&(ef("__ff__source".concat(e.links[0],"__endsource")),u="__ff__source".concat(e.links[0],"__endsource"))},async e=>{ec(),i.length<2&&ei&&(await eo(x,[...i,{content:I,role:"user"}]),u&&A.includes("claude")&&ef(u))},t=>{var r,a;switch(t.code){case 400:e(t.message||"",{duration:6e3}),f(null===(r=t.message)||void 0===r?void 0:r.replace("Time remaining:","\nTime remaining:"));break;case 402:e(t.message||"",{duration:6e3}),V(!0);break;case 412:j(),localStorage.setItem("max-free-api-requests","true"),s(!0,"Create an account to continue chatting for free."),ec();break;case 429:e(t.message||"",{duration:6e3}),f(null===(a=t.message)||void 0===a?void 0:a.replace("Time remaining:","\nTime remaining:")),T("gpt-3.5-turbo"),F({id:tk(),content:I});break;case 500:e(t.message||"Error sending message"),f(t.message),F({id:tk(),content:I});break;default:ec()}});v.start(),es(v)}catch(e){console.log("Error creating SSE")}},{handleClickFileInput:ey}=(0,tJ.lA)(),eb=()=>(function(e,t,r){let a=new ClipboardItem({"text/plain":e({chatId:r,workspaceId:t}).then(e=>e.shareLink).then(e=>new Blob([e],{type:"text/plain"}))});navigator.clipboard.write([a])})(K.mutateAsync,a,S);return(0,ed.jsxs)("div",{className:"sticky bottom-0 w-full py-6 px-6 flex flex-col gap-3 items-center justify-center z-10 bg-th-background bg-transparent",style:{background:"var(--vertical-gradient)"},children:[(0,ed.jsxs)("div",{className:"flex gap-3",children:[v&&(0,ed.jsx)(t_,{streamSource:el}),"manual"===l&&!v&&i.length>1&&(0,ed.jsx)(tS,{}),!v&&i.length>1&&(0,ed.jsx)(tN.Z,{onClick:eb})]}),(0,ed.jsx)("div",{className:"flex flex-col gap-2 max-w-[616px] min-w-[288px] w-full",children:(0,ed.jsxs)("div",{className:"relative shadow flex items-end gap-1 w-full py-3 px-3 md:px-4 rounded border ".concat(P?"border-th-primary-light":"border-th-border-secondary"," bg-th-background gap-3 resize-none outline-none"),children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-3 flex-1 align-start justify-start",children:[(0,ed.jsx)(tW,{onChange:z,onSubmit:ev,personaSearch:et,extensionSearch:ea,setMessagePersona:b,onFocus:()=>{Z(!0)},onBlur:()=>{Z(!1)},value:I}),D&&(0,ed.jsxs)("div",{className:"group py-2 px-3 items-center justify-between gap-3 flex border border-th-border-secondary bg-th-foreground rounded",children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ed.jsx)("p",{className:"text-sm font-medium whitespace-pre-wrap break-all text-th-primary-medium",children:null==D?void 0:D.originalFilename}),(0,ed.jsxs)("p",{className:"text-sm font-light whitespace-pre-wrap break-all text-th-primary-light",children:[null==D?void 0:D.contentType," |"," ",(null==D?void 0:D.fileSize)&&((null==D?void 0:D.fileSize)<1e6?"".concat(((null==D?void 0:D.fileSize)/1e3).toFixed(1)," KB"):"".concat(((null==D?void 0:D.fileSize)/1e6).toFixed(1)," MB"))]})]}),(0,ed.jsx)(eu.Z,{display:"top",align:"right",tooltip:"Remove file",children:(0,ed.jsx)(ty.Z,{width:"16",height:"16",className:"text-th-primary-light hover:text-th-primary-dark cursor-pointer",onClick:()=>{G(null)}})})]})]}),(0,ed.jsxs)("div",{className:"gap-1 flex items-center",children:[(0,ed.jsx)("div",{className:"p-[2px] group cursor-pointer hover:bg-th-background-hover rounded",children:(0,ed.jsx)(eu.Z,{tooltip:"Upload file",display:"top",align:"right",children:ei&&(0,ed.jsx)(tX,{onClick:ei?ey:()=>s(!0,"Create a free account to interact with files")})})}),(0,ed.jsx)("div",{className:"gap-2 flex items-center",children:(I.length>0||D)&&(0,ed.jsx)(eu.Z,{align:"right",display:"top",tooltip:"Send message",shortcut:["Return"],children:(0,ed.jsx)("div",{className:"cursor-pointer self-end",children:(0,ed.jsx)(tv.Z,{filled:!0,onClick:ev})})})})]})]})})]})};var t6=(0,ex.memo)(t1),t3=r(9348);function t2(){return(t2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var t4=function(e){return ex.createElement("svg",t2({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none","aria-label":"Forefront logo",viewBox:"0 0 40 40"},e),T||(T=ex.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M26.595 4.996c-3.43-1.706-6.362-3.147-6.514-3.203-.373-.136-1.271-.17-1.663-.063-.836.229-1.581.822-1.93 1.538-.342.698-.352.774-.375 2.855l-.02 1.874.708.355c.39.195.72.355.733.355.013 0 .03-.98.038-2.179l.015-2.179.133-.283c.179-.382.449-.669.783-.832.228-.112.344-.135.655-.133l.377.002 2.074 1.023c5.04 2.484 10.497 5.233 10.585 5.331.061.068.105.209.12.379.02.253.01.283-.148.448-.193.202-5.942 4.181-6.296 4.359a1.65 1.65 0 0 1-1.018.118c-.123-.031-3.418-1.645-7.322-3.587-3.903-1.943-7.234-3.578-7.4-3.636-.417-.143-1.153-.176-1.6-.071-1.151.27-2.052 1.225-2.28 2.416-.11.583-.11 10.46 0 10.992.12.57.434 1.144.85 1.555l.357.352 6.425 3.197c3.534 1.759 6.55 3.242 6.703 3.297.39.14 1.18.174 1.625.07.377-.09.85-.31 1.196-.56.125-.09 1.485-1.03 3.023-2.09 1.538-1.06 2.883-2.01 2.988-2.11.402-.385.69-1.018.69-1.513 0-.314-.122-.772-.289-1.078-.254-.466-.525-.65-2.053-1.4a1372.2 1372.2 0 0 1-4.485-2.214c-5.482-2.719-6.632-3.275-6.771-3.275-.179 0-.346.16-.383.365-.016.09-.022 1.82-.015 3.842l.015 3.678.718.367.718.366v-3.276c0-2.071.018-3.276.048-3.276.027 0 2.482 1.21 5.454 2.687 5.02 2.495 5.542 2.734 5.583 3.04.008.055 0 .113 0 .187 0 .182-.03.263-.14.38-.076.083-1.249.914-2.607 1.848l-3.076 2.116c-.738.507-1.067.623-1.527.537-.422-.078-12.894-6.282-13.174-6.552a2.112 2.112 0 0 1-.327-.44l-.135-.251V10.042l.16-.302c.357-.678 1.014-1.029 1.665-.89.15.033 3.081 1.464 7.35 3.588 3.904 1.944 7.224 3.58 7.377 3.636.396.146 1.275.18 1.713.069.498-.128.759-.268 1.662-.895.457-.317 1.863-1.287 3.124-2.156 1.26-.869 2.386-1.675 2.5-1.792.432-.443.64-1.12.533-1.742-.08-.467-.262-.808-.618-1.165-.287-.287-.468-.381-6.532-3.397ZM7.636 25.335l-.705-.353a15.07 15.07 0 0 0-.73-.353c-.054 0-.027 11.314.028 11.616.083.458.355.976.69 1.315a2.55 2.55 0 0 0 2.984.496c.425-.216 6.473-4.417 6.755-4.692.327-.32.564-.692.741-1.166.11-.294.13-.443.151-1.13l.024-.79-.713-.357c-.49-.245-.72-.337-.735-.293-.012.035-.028.518-.036 1.072-.014 1.003-.015 1.009-.16 1.268-.079.144-.203.317-.276.385-.167.155-6.087 4.237-6.401 4.413-.549.307-1.289.038-1.539-.56-.069-.165-.078-.814-.078-5.53v-5.341Z",clipRule:"evenodd"})))},t5=r(9490);function t7(){return(t7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var t8=function(e){return ex.createElement("svg",t7({xmlns:"http://www.w3.org/2000/svg",width:50,height:15,"aria-label":"Animated typing"},e),R||(R=ex.createElement("g",{fill:"var(--primary-dark)"},ex.createElement("circle",{cx:7.5,cy:7.5,r:3},ex.createElement("animate",{attributeName:"r",begin:"0s",calcMode:"spline",dur:"1.2s",from:3,keySplines:"0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1",keyTimes:"0;0.3;0.6;1",repeatCount:"indefinite",to:3,values:"3;1;1;3"})),ex.createElement("circle",{cx:22.5,cy:7.5,r:3},ex.createElement("animate",{attributeName:"r",begin:"0s",calcMode:"spline",dur:"1.2s",from:3,keySplines:"0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1",keyTimes:"0;0.3;0.6;1",repeatCount:"indefinite",to:3,values:"1;3;1;1"})),ex.createElement("circle",{cx:37.5,cy:7.5,r:3},ex.createElement("animate",{attributeName:"r",begin:"0s",calcMode:"spline",dur:"1.2s",from:3,keySplines:"0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1",keyTimes:"0;0.3;0.6;1",repeatCount:"indefinite",to:3,values:"1;1;3;1"})))))};let t9=()=>(0,ed.jsx)("div",{className:"min-h-[32px] flex items-center",children:(0,ed.jsx)(t8,{})});function re(){return(re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var rt=function(e){return ex.createElement("svg",re({xmlns:"http://www.w3.org/2000/svg",width:21,height:20,fill:"none","aria-label":"Good response"},e),U||(U=ex.createElement("path",{fill:"currentColor",d:"M8.318 17.2h6.546c.603 0 1.12-.36 1.338-.878l2.196-5.076c.066-.166.102-.339.102-.526V9.28c0-.792-.654-1.44-1.454-1.44h-4.59l.691-3.29.022-.23c0-.296-.123-.57-.32-.764l-.77-.756-4.794 4.745c-.261.26-.421.619-.421 1.015v7.2c0 .792.654 1.44 1.454 1.44Zm0-8.64 3.157-3.125L10.5 9.28h6.546v1.44l-2.182 5.04H8.318v-7.2Zm-5.818 0h2.91v8.64H2.5V8.56Z"})))};function rr(){return(rr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ra=function(e){return ex.createElement("svg",rr({xmlns:"http://www.w3.org/2000/svg",width:21,height:20,fill:"none","aria-label":"Bad response"},e),D||(D=ex.createElement("path",{fill:"currentColor",d:"M12.682 2.8H6.136c-.603 0-1.12.36-1.338.878L2.602 8.754a1.41 1.41 0 0 0-.102.526v1.44c0 .792.655 1.44 1.455 1.44h4.589l-.691 3.29-.022.23c0 .296.124.57.32.764l.77.756 4.793-4.745c.262-.259.422-.619.422-1.015v-7.2c0-.792-.654-1.44-1.454-1.44Zm0 8.64-3.157 3.125.975-3.845H3.955V9.28l2.181-5.04h6.546v7.2ZM15.59 2.8H18.5v8.64h-2.91V2.8Z"})))};let rn=e=>{let{shouldShow:t,setShouldShow:r,id:a,onSubmit:n}=e,[l,s]=(0,ex.useState)("");return(0,ed.jsx)("div",{className:"modal ".concat(t&&"modal-open"),children:(0,ed.jsxs)("div",{className:"grid gap-4 md:gap-6 max-w-[640px] min-w-[288px] modal-box rounded px-4 py-4 md:py-6 md:px-10 bg-th-background border border-th-border-primary",children:[(0,ed.jsxs)("div",{className:"flex w-full items-center gap-3",children:[(0,ed.jsx)("div",{className:"h-[28px] w-[28px] bg-th-success-secondary text-th-success-primary rounded-sm flex justify-center items-center",children:(0,ed.jsx)(rt,{})}),(0,ed.jsx)("p",{className:"lg font-semibold text-lg flex-1 text-th-primary-dark",children:"Good response"}),(0,ed.jsx)("label",{htmlFor:a,onClick:()=>r(!1),children:(0,ed.jsx)(ty.Z,{width:"20",height:"20",className:"cursor-pointer rounded hover:bg-th-background-hover hover:text-th-primary-dark p-1 h-6 w-6"})})]}),(0,ed.jsx)("textarea",{value:l,onChange:e=>s(e.target.currentValue),className:"px-3 py-3 h-[120px] placeholder:text-th-primary-light border bg-th-background border-th-border-secondary focus:border-th-primary-light focus:text-th-primary-dark rounded w-full outline-none resize-none text-sm",placeholder:"What do you like about this response? How was it good?"}),(0,ed.jsxs)("div",{className:"modal-action  m-0 p-0",children:[(0,ed.jsx)("label",{htmlFor:a,className:"px-3 py-2 text-sm font-medium cursor-pointer rounded bg-th-background hover:bg-th-background-hover normal-case text-th-primary-light hover:text-th-primary-dark",onClick:()=>r(!1),children:"Cancel"}),(0,ed.jsx)("label",{htmlFor:a,className:"px-3 py-[6px] flex items-center text-sm cursor-pointer font-medium normal-case rounded bg-th-background-secondary hover:bg-th-background-hover border border-th-border-secondary hover:text-th-primary-dark text-th-primary-medium",onClick:()=>n(l),children:"Submit"})]})]})})},rl=e=>{let{shouldShow:t,setShouldShow:r,id:a,onSubmit:n}=e,[l,s]=(0,ex.useState)("");return(0,ed.jsx)("div",{className:"modal ".concat(t&&"modal-open"),children:(0,ed.jsxs)("div",{className:"grid gap-4 md:gap-6 modal-box rounded px-4 min-w-[288px] max-w-[640px] py-4 md:py-6 md:px-10 bg-th-background border border-th-border-primary",children:[(0,ed.jsxs)("div",{className:"flex w-full items-center gap-3",children:[(0,ed.jsx)("div",{className:"h-[28px] w-[28px] bg-th-error-secondary text-th-error-primary rounded-sm flex justify-center items-center",children:(0,ed.jsx)(ra,{})}),(0,ed.jsx)("p",{className:"lg font-semibold text-lg flex-1 text-th-primary-medium",children:"Bad response"}),(0,ed.jsx)("label",{htmlFor:a,onClick:()=>r(!1),children:(0,ed.jsx)(ty.Z,{width:"20",height:"20",className:"cursor-pointer rounded hover:bg-th-background-hover hover:text-th-primary-dark p-1 h-6 w-6"})})]}),(0,ed.jsx)("textarea",{value:l,onChange:e=>s(e.target.currentValue),className:"px-3 py-3 h-[120px] placeholder:text-th-primary-light border bg-th-background border-th-border-secondary focus:border-th-primary-light focus:text-th-primary-dark rounded w-full outline-none resize-none text-sm",placeholder:"What was the issue with this response? How could it be improved?"}),(0,ed.jsxs)("div",{className:"modal-action  m-0 p-0",children:[(0,ed.jsx)("label",{htmlFor:a,className:"px-3 py-2 text-sm font-medium cursor-pointer rounded bg-th-background hover:bg-th-background-hover normal-case text-th-primary-light hover:text-th-primary-dark",onClick:()=>r(!1),children:"Cancel"}),(0,ed.jsx)("label",{htmlFor:a,className:"px-3 py-[6px] flex items-center text-sm cursor-pointer font-medium normal-case rounded bg-th-background-secondary hover:bg-th-background-hover border border-th-border-secondary hover:text-th-primary-dark text-th-primary-medium",onClick:()=>n(l),children:"Submit"})]})]})})};var rs=r(6227),ri=r(2906);function ro(){return(ro=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var rd=function(e){return ex.createElement("svg",ro({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none",viewBox:"0 0 20 20"},e),G||(G=ex.createElement("path",{fill:"currentColor",d:"m9.04 13.12 3.736-2.8a.397.397 0 0 0 0-.64L9.04 6.88a.4.4 0 0 0-.64.32v5.6a.4.4 0 0 0 .64.32ZM10 2c-4.416 0-8 3.584-8 8s3.584 8 8 8 8-3.584 8-8-3.584-8-8-8Zm0 14.4A6.408 6.408 0 0 1 3.6 10c0-3.528 2.872-6.4 6.4-6.4 3.528 0 6.4 2.872 6.4 6.4 0 3.528-2.872 6.4-6.4 6.4Z"})))};let rc=e=>{var t,r;return"image_gen"===e||"image_generation"===e?"Image":"transcribe"===e?"Transcribe":"summarize"===e?"Summarize":(null===(t=null==e?void 0:e.toLowerCase())||void 0===t?void 0:t.startsWith("gpt-3.5"))||(null===(r=null==e?void 0:e.toLowerCase())||void 0===r?void 0:r.startsWith("gpt-35"))?"GPT-3.5":e.startsWith("gpt-4")?"GPT-4":e},rh=e=>{let{sentFeedback:t,shouldShow:r,model:a,message:n,setShowHelpfulModal:l,isLast:s,setShowNotHelpfulModal:i}=e,{content:o,id:d,seq:c}=n,h=eF.d.chat.deleteMessage.useMutation(),u=eF.d.chat.removeChat.useMutation(),{closeTab:m}=(0,em.zR)(),{pathname:p}=(0,tx.useRouter)(),{workspaceId:x}=(0,em.Oz)(),{setShouldContinue:f}=(0,em.Nf)(),{refetch:g}=eF.d.chat.loadTree.useQuery({workspaceId:x},{enabled:!!x&&!p.includes("share")}),{messages:v,clearMessages:y,removeMessage:b,messageActionId:w,isDeletingMessage:j,setIsDeletingMessage:k,setMessageActionId:N}=(0,em.GH)(),{showToast:C}=(0,e4.pm)(),[E,S]=(0,ex.useState)(!1);async function O(){let e=o;e.includes("> ")&&e.includes("assets.forefront.ai")&&(e=e.replace("> ","")),await navigator.clipboard.writeText(e),S(!0),setTimeout(()=>{S(!1)},1250)}async function M(){b(d),await h.mutateAsync({id:d,workspaceId:x}).then(()=>{C("Message deleted")}).catch(e=>{console.log(e),C("Error deleting this message")}),1===v.length&&(await u.mutateAsync({id:d,workspaceId:x}),await g(),m(d),C("Chat deleted"),y())}return(0,ed.jsxs)("div",{className:"".concat(r?"hidden":"opacity-100"," animate-opacity-appear flex w-full justify-between"),children:[t?"HELPFUL"===t?(0,ed.jsx)(rt,{className:"text-th-success-primary cursor-default"}):(0,ed.jsx)(ra,{className:"text-th-error-primary cursor-default"}):(0,ed.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,ed.jsx)("label",{onClick:()=>l(!0),children:(0,ed.jsx)(eu.Z,{tooltip:"Good response",display:"bottom",align:"center",children:(0,ed.jsx)(rt,{className:"".concat(j&&w===d?"hidden":"block"," cursor-pointer text-th-primary-light hover:text-th-primary-dark")})})}),(0,ed.jsx)("label",{onClick:()=>i(!0),children:(0,ed.jsx)(eu.Z,{tooltip:"Bad response",display:"bottom",align:"center",children:(0,ed.jsx)(ra,{className:"".concat(j&&w===d?"hidden":"block"," cursor-pointer text-th-primary-light hover:text-th-primary-dark")})})})]}),j&&w===d?(0,ed.jsxs)("div",{className:"flex items-center gap-3 md:gap-6",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark text-sm font-medium",children:"Are you sure you want to delete this message?"}),(0,ed.jsxs)("div",{className:"flex gap-3",children:[(0,ed.jsx)(eu.Z,{tooltip:"Confirm",display:"bottom",align:"right",children:(0,ed.jsx)(eQ.Z,{onClick:M,className:"text-th-primary-light hover:text-th-primary-dark cursor-pointer"})}),(0,ed.jsx)(eu.Z,{tooltip:"Cancel",display:"bottom",align:"right",children:(0,ed.jsx)(eW,{onClick:()=>{k(!1),N("")},className:"text-th-primary-light hover:text-th-primary-dark cursor-pointer"})})]})]}):(0,ed.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,ed.jsx)("p",{className:"text-xs md:text-sm font-medium text-th-primary-light",children:eH(rc(a))}),s&&(0,ed.jsx)(eu.Z,{tooltip:"Continue generation",display:"bottom",align:"right",appearAfter:1250,children:(0,ed.jsx)(rd,{className:"h-6 w-6 text-th-primary-light hover:text-th-primary-dark cursor-pointer",onClick:()=>{f(!0)}})}),(0,ed.jsx)(eu.Z,{tooltip:E?"Copied":"Copy",display:"bottom",align:"right",appearAfter:1250,children:E?(0,ed.jsx)(eQ.Z,{className:"text-th-primary-dark",height:"20px",width:"20px"}):(0,ed.jsx)(ri.Z,{className:"cursor-pointer text-th-primary-light hover:text-th-primary-dark",height:"20px",width:"20px",onClick:O})}),(0,ed.jsx)(eu.Z,{tooltip:"Delete",align:"right",children:(0,ed.jsx)(e0,{className:"h-5 w-5 cursor-pointer text-th-primary-light hover:text-th-primary-dark",onClick:()=>{N(d),k(!0)}})})]})]})};var ru=r(5522),rm=r(6332),rp=r(8617);let rx=e=>e.includes("__ff__source")?e.replace(/__ff__source.*__endsource/g,""):e,rf=e=>{var t;let r=null===(t=e.split("__ff__source")[1])||void 0===t?void 0:t.split("__endsource")[0];return JSON.parse(r||"{}")},rg=e=>{let{id:t,tabId:r,content:a,seq:n,gifUrl:l,isLast:s=!1,avatar:i,model:o,personaName:d,personaHandle:c,personaId:h,message:u}=e,{theme:m}=(0,rp.F)(),[p,x]=(0,ex.useState)(void 0),f=eF.d.chat.sendFeedback.useMutation(),{isStreaming:g,isDeletingMessage:v,messageActionId:y}=(0,em.GH)(),[b,w]=(0,ex.useState)(!1),[j,k]=(0,ex.useState)(!1),N=(0,ex.useMemo)(()=>rf(a)||[],[a]);return(0,ex.useEffect)(()=>{console.log(N)},[N]),(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)(rn,{shouldShow:b,setShouldShow:w,id:"helpful-".concat(t,"-").concat(n),onSubmit:async e=>{x("HELPFUL"),await f.mutate({chatId:r,seq:n,type:"HELPFUL",comment:e}),w(!1)}}),(0,ed.jsx)(rl,{shouldShow:j,setShouldShow:k,id:"not-helpful-".concat(t,"-").concat(n),onSubmit:async e=>{await f.mutate({chatId:r,seq:n,type:"NOT_HELPFUL",comment:e}),x("NOT_HELPFUL"),k(!1)}}),(0,ed.jsx)("div",{className:"w-full py-6 px-0 border-b bg-th-foreground border-th-border-primary mx-auto flex flex-col justfiy-center",children:(0,ed.jsxs)("div",{className:"flex align-start self-center flex-col md:flex-row justify-start md:justify-center w-full max-w-[616px] md:px-0 px-6",children:[(0,ed.jsxs)("div",{className:"w-full md:w-16 gap-3 md:gap-0 flex justify-start items-center md:items-start pb-4 md:pb-0 leading-[normal]",children:[i?(0,ed.jsx)(t5.Z,{pngImage:l||i,gifImage:l,name:d,handle:c}):(0,ed.jsx)(ru.Z,{}),(0,ed.jsx)("p",{className:"text-th-primary-dark p-0 m-0 text-sm md:hidden",children:d||"Helpful Assistant"})]}),(0,ed.jsxs)("div",{className:"flex flex-col flex-1 max-w-[555px]",children:[a.length?(0,ed.jsx)(rs.Z,{content:rx(a),seq:n,shouldFadeText:!1}):(0,ed.jsx)(t9,{}),N.length>0&&(!g||!s)&&(0,ed.jsxs)("div",{className:"flex flex-col gap-2 pt-0 mt-6 w-full",children:[(0,ed.jsx)("p",{className:"m-0 p-0 text-th-primary-dark",children:"Sources"}),N.map((e,t)=>(0,ed.jsxs)("a",{className:"flex gap-2 items-center bg-th-background text-th-primary-light border border-th-border-secondary w-full rounded-md py-[10px] px-3 hover:bg-th-background-secondary hover:text-th-primary-dark hover:border-th-primary-light",href:e.url,target:"_blank",rel:"noopener noreferrer",children:[(0,ed.jsx)("img",{src:e.favicon,alt:"favicon",className:"w-4 h-4 rounded-full"}),(0,ed.jsx)("p",{className:"text-inherit text-sm w-fit truncate grow",children:e.title}),(0,ed.jsx)(rm.Z,{width:16,height:16,fill:"currentColor",className:"text-inherit"})]},"source-"+String(t)))]}),(0,ed.jsx)("div",{className:"flex flex-col w-full px-0 pt-8 w-full self-center",children:(0,ed.jsx)(rh,{shouldShow:g&&s,model:o,message:u,sentFeedback:p,setShowHelpfulModal:w,setShowNotHelpfulModal:k,isLast:s})})]})]})})]})};var rv=(0,ex.memo)(rg),ry=r(8879),rb=r.n(ry);let rw=r(4011);function rj(){return(rj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}rb().extend(rw);var rk=function(e){return ex.createElement("svg",rj({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none","aria-label":"Edit chat"},e),V||(V=ex.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M15.81 2.918a1.313 1.313 0 0 0-.356.244c-.104.121-.074.16.852 1.121.868.902.968.987 1.065.904.32-.276.434-1.095.219-1.586-.292-.67-1.133-.992-1.78-.683Zm-10.877.855c-.584.143-1.11.577-1.42 1.171l-.213.41v10.228l.146.305c.233.488.594.865 1.054 1.1l.416.213h9.711l.294-.142c.37-.18.818-.606 1.027-.977.314-.557.326-.737.327-4.641l.001-3.624-.715.742-.716.742v2.947c0 2.768-.008 2.958-.117 3.146-.252.43-.085.415-4.951.415-4.76 0-4.63.01-4.952-.353l-.156-.175V5.655l.156-.175c.316-.356.279-.353 3.935-.353h3.38l.682-.712.683-.712-4.17.006c-2.292.004-4.273.033-4.402.064Zm6.85 3.215-3.031 3.156-.286 1.192c-.378 1.574-.457 1.495 1.075 1.086l1.165-.312L13.74 8.96l3.034-3.151-.948-.988c-.522-.543-.963-.988-.98-.988-.018 0-1.396 1.42-3.063 3.156Z",clipRule:"evenodd"})))};function rN(){return(rN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var rC=function(e){return ex.createElement("svg",rN({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none",viewBox:"0 0 16 16"},e),B||(B=ex.createElement("g",{clipPath:"url(#person_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M8 3.933a1.4 1.4 0 1 1 0 2.8 1.4 1.4 0 0 1 0-2.8Zm0 6c1.98 0 4.067.974 4.067 1.4v.734H3.933v-.734c0-.426 2.087-1.4 4.067-1.4Zm0-7.266A2.666 2.666 0 1 0 8 8a2.666 2.666 0 1 0 0-5.333Zm0 6c-1.78 0-5.333.893-5.333 2.666v1.334c0 .366.3.666.666.666h9.334c.366 0 .666-.3.666-.666v-1.334C13.333 9.56 9.78 8.667 8 8.667Z"}))),Q||(Q=ex.createElement("defs",null,ex.createElement("clipPath",{id:"person_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))},rE=r(2702),rS=r(1642),rO=r(4168),rM=r(3998);let r_=e=>{let{id:t,content:r,createdAt:a}=e,{user:n}=(0,eO.useUser)(),{workspaceId:l}=(0,em.Oz)(),{closeTab:s}=(0,em.zR)(),{messages:i,isEditingMessage:o,setIsEditingMessage:d,setMessages:c,isDeletingMessage:h,clearMessages:u,setIsDeletingMessage:m,messageActionId:p,setMessageActionId:x,removeMessage:f,shouldResubmit:g,setShouldResubmit:v}=(0,em.GH)(),{setPrompt:y}=(0,em.Nf)(),[b,w]=(0,ex.useState)(""),j=eF.d.chat.deleteMessage.useMutation(),k=eF.d.chat.removeChat.useMutation(),N=(0,ex.useRef)(null),{showToast:C}=(0,e4.pm)(),{pathname:E}=(0,tx.useRouter)(),[S,O]=(0,ex.useState)(!1),M=(0,ex.useMemo)(()=>(function(e){let t=e.match(/((?:https?:\/\/)[\w-]+(?:\.[\w-]+)+[\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])/gi);return t||[]})(r)||[],[r]),{refetch:_}=eF.d.chat.loadTree.useQuery({workspaceId:l},{enabled:!E.includes("share")});(0,ex.useEffect)(()=>{if(N.current&&o&&p===t){let e=N.current;e.selectionStart=e.value.length,e.selectionEnd=e.value.length,P({currentTarget:e})}},[o,p]);let P=e=>{let t=e.currentTarget;t.style.height="inherit",t.style.height="".concat(t.scrollHeight,"px")};async function Z(){let e=r;e.includes("> ")&&e.includes("assets.forefront.ai")&&(e=e.replace("> ","")),await navigator.clipboard.writeText(e),O(!0),setTimeout(()=>{O(!1)},1250)}async function A(){f(t),await j.mutateAsync({id:t,workspaceId:l}).then(()=>{C("Message deleted")}).catch(e=>{C("Something went wrong deleting this message.")}),1===i.length&&(await k.mutateAsync({id:t,workspaceId:l}),await _(),s(t),C("Chat deleted"),u())}let L=()=>{if(0===b.trim().length){C("Message cannot be empty",{duration:2e3});return}let e=i.findIndex(e=>e.id===t);c(i.slice(0,e)),y(b),v(!0),d(!1),x("")},I=(0,ex.useMemo)(()=>(null==r?void 0:r.includes("__ff_content__"))?(0,rM.Z)(r):null,[r]),{data:z}=eF.d.content.getContentInfo.useQuery({contentId:I},{enabled:!!I});return(0,ed.jsx)("div",{className:"w-full py-6 px-0 border-b border-th-border-primary mx-auto flex flex-col justfiy-center",children:(0,ed.jsxs)("div",{className:"flex align-start self-center flex-col md:flex-row justify-start md:justify-center w-full max-w-[616px] md:px-0 px-6",children:[(0,ed.jsxs)("div",{className:"w-full md:w-16 gap-3 md:gap-0 flex justify-start items-center md:items-start pb-4 md:pb-0 leading-[normal]",children:[(null==n?void 0:n.profileImageUrl)?(0,ed.jsx)(e_(),{src:null==n?void 0:n.profileImageUrl,alt:"avatar",width:"32",height:"32",className:"w-8 h-8 rounded bg-th-background-secondary md:w-10 md:h-10",unoptimized:!0}):(0,ed.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 bg-th-border-secondary text-th-primary-light rounded flex justify-center items-center",children:(0,ed.jsx)(rC,{className:"w-8 h-8 md:w-10 md:h-10"})}),(0,ed.jsx)("p",{className:"text-th-primary-dark p-0 m-0 text-sm md:hidden",children:(null==n?void 0:n.firstName)||(null==n?void 0:n.fullName)||(null==n?void 0:n.username)||"User"})]}),(0,ed.jsxs)("div",{className:"flex flex-col flex-1 gap-2 max-w-[555px]",children:[I?(0,ed.jsx)(rE.Z,{filename:null==z?void 0:z.content.originalFilename,contentType:null==z?void 0:z.content.contentType,onClickDownload:()=>{(0,rS.S)(null==z?void 0:z.content.fileUrl,null==z?void 0:z.content.originalFilename)},fileSize:(0,rO.s)(null==z?void 0:z.content.fileSize)}):o&&p===t?(0,ed.jsx)("textarea",{className:"bg-transparent border overflow-hidden border-th-border-secondary p-2 md:p-3 rounded outline-none resize-none text-th-primary-dark",value:b,onChange:e=>w(e.currentTarget.value),ref:N}):(0,ed.jsx)("p",{className:"text-base whitespace-pre-wrap break-words ".concat(h&&p===t?"text-th-primary-light":"text-th-primary-dark"),children:r}),(0,ed.jsx)("div",{className:"opacity-100 w-full flex md:group-hover:opacity-100 md:animate-opacity-appear ".concat((o||h)&&p===t?"md:opacity-100 justify-end":"md:opacity-0 justify-between"),children:o&&p===t?(0,ed.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,ed.jsx)("button",{className:"text-sm font-medium py-[6px] px-2 bg-transparent hover:bg-th-background-hover rounded",onClick:()=>{d(!1),x(""),w("")},children:"Cancel"}),(0,ed.jsx)("button",{className:"text-sm font-medium py-[6px] px-2 bg-th-background-secondary border border-th-border-secondary hover:bg-th-background-hover rounded",onClick:()=>{L()},children:"Send"})]}):h&&p===t?(0,ed.jsxs)("div",{className:"flex flex-col items-center md:flex-row gap-6",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark text-sm",children:"Are you sure you want to delete this message?"}),(0,ed.jsxs)("div",{className:"flex gap-3",children:[(0,ed.jsx)(ev.Z,{tooltip:"Confirm",display:"bottom",align:"right",children:(0,ed.jsx)(eQ.Z,{onClick:A,className:"text-th-primary-light hover:text-th-primary-dark cursor-pointer"})}),(0,ed.jsx)(ev.Z,{tooltip:"Cancel",display:"bottom",align:"right",children:(0,ed.jsx)(eW,{onClick:()=>{m(!1),x("")},className:"text-th-primary-light hover:text-th-primary-dark cursor-pointer"})})]})]}):h&&p===t?(0,ed.jsxs)("div",{className:"flex items-center gap-3 md:gap-6",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark text-sm font-medium",children:"Are you sure you want to delete this message?"}),(0,ed.jsxs)("div",{className:"flex gap-3",children:[(0,ed.jsx)(ev.Z,{tooltip:"Confirm",display:"bottom",align:"right",children:(0,ed.jsx)(eQ.Z,{onClick:A,className:"text-th-primary-light hover:text-th-primary-dark cursor-pointer"})}),(0,ed.jsx)(ev.Z,{tooltip:"Cancel",display:"bottom",align:"right",children:(0,ed.jsx)(eW,{onClick:()=>{m(!1),x("")},className:"text-th-primary-light hover:text-th-primary-dark cursor-pointer"})})]})]}):(0,ed.jsxs)("div",{className:"grid gap-6 w-full",children:[M.length>0&&(0,ed.jsxs)("div",{className:"flex flex-col gap-2 pt-0 mt-6 w-full",children:[(0,ed.jsx)("p",{className:"m-0 p-0 text-th-primary-dark",children:"References"}),M.map((e,t)=>(0,ed.jsxs)("a",{className:"flex gap-2 items-center bg-th-background text-th-primary-light border border-th-border-secondary w-full rounded-md py-[10px] px-3 hover:bg-th-background-secondary hover:text-th-primary-dark hover:border-th-primary-light",href:e,target:"_blank",rel:"noopener noreferrer",children:[(0,ed.jsx)("p",{className:"text-inherit text-sm w-fit truncate grow",children:e}),(0,ed.jsx)(rm.Z,{width:16,height:16,fill:"currentColor",className:"text-inherit"})]},"source-"+String(t)))]}),(0,ed.jsxs)("div",{className:"flex w-full z-0 relative",children:[(0,ed.jsx)("p",{className:"text-sm text-th-primary-light text-left grow",children:function(e){let t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.abs((t=r?rb()("".concat(e," UTC")):rb()(e)).diff(rb()(),"days"))>6?t.format("MM-DD-YYYY"):t.fromNow()}(a)}),(0,ed.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ed.jsx)(ev.Z,{tooltip:"Edit",align:"right",children:(0,ed.jsx)(rk,{onClick:()=>{w(r),x(t),d(!0)},className:"h-5 w-5 cursor-pointer text-th-primary-light hover:text-th-primary-dark"})}),!I&&(0,ed.jsx)(ev.Z,{tooltip:S?"Copied":"Copy",display:"bottom",align:"right",appearAfter:1250,children:S?(0,ed.jsx)(eQ.Z,{className:"text-th-primary-dark",height:"20px",width:"20px"}):(0,ed.jsx)(ri.Z,{className:"cursor-pointer text-th-primary-light hover:text-th-primary-dark",height:"20px",width:"20px",onClick:Z})}),(0,ed.jsx)(ev.Z,{tooltip:"Delete",align:"right",children:(0,ed.jsx)(e0,{className:"h-5 w-5 cursor-pointer text-th-primary-light hover:text-th-primary-dark",onClick:()=>{x(t),m(!0)}})})]})]})]})})]})]})})};var rP=(0,ex.memo)(r_),rZ=r(9879),rA=r(5211);function rL(){return(rL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var rI=function(e){return ex.createElement("svg",rL({xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none"},e),Y||(Y=ex.createElement("g",{clipPath:"url(#openai_svg__a)"},ex.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M7.385.007a4.156 4.156 0 0 0-2.978 1.568c-.24.304-.463.699-.594 1.055l-.058.156-.219.056A4.031 4.031 0 0 0 .72 5.452a3.94 3.94 0 0 0 .23 3.13c.14.271.315.535.483.729l.12.139-.039.131c-.115.392-.159.706-.159 1.133 0 .657.132 1.214.423 1.788a4.087 4.087 0 0 0 2.817 2.154c.49.1 1.106.116 1.516.039l.177-.033.214.201c.476.448.96.738 1.561.935.521.17.985.228 1.528.191 1.337-.092 2.469-.739 3.194-1.825.157-.236.244-.402.374-.718l.103-.249.111-.027a4.308 4.308 0 0 0 1.804-.94 4.082 4.082 0 0 0 1.24-2.16 3.994 3.994 0 0 0-.75-3.26c-.078-.1-.156-.2-.174-.225-.03-.042-.029-.06.03-.29.097-.378.128-.623.128-1.017 0-1.036-.386-1.985-1.132-2.78-.591-.63-1.53-1.096-2.445-1.214a5.048 5.048 0 0 0-1.183.022l-.179.034-.197-.19A4.116 4.116 0 0 0 8.645.125a4.586 4.586 0 0 0-1.26-.117Zm.872 1.098c.235.05.547.159.752.26.176.086.52.304.566.358.016.02-.373.25-1.648.975-.918.522-1.705.98-1.748 1.02a.593.593 0 0 0-.122.16c-.042.089-.043.109-.053 2.394l-.01 2.304-.64-.363c-.353-.2-.666-.379-.696-.398l-.055-.035V5.833c0-1.222.008-2.01.021-2.116.067-.536.26-1.017.588-1.466a3.82 3.82 0 0 1 .664-.642c.353-.247.856-.456 1.234-.513.09-.013.177-.027.193-.031.088-.021.815.01.954.04Zm3.819 1.232c1.554.275 2.64 1.657 2.514 3.198a2.432 2.432 0 0 1-.03.265c-.005.009-.615-.332-1.354-.756-2.133-1.222-2.065-1.185-2.171-1.2a.593.593 0 0 0-.185.01c-.051.013-.938.505-2.067 1.147a142.354 142.354 0 0 1-2.012 1.134c-.034.008-.036-.036-.036-.771 0-.718.003-.782.035-.81.068-.057 3.305-1.885 3.507-1.98.236-.11.552-.207.812-.246.285-.044.712-.04.986.01ZM3.63 7.971a.558.558 0 0 0 .133.16c.044.033.96.56 2.034 1.17 1.074.61 1.953 1.115 1.953 1.122 0 .027-1.333.77-1.38.77-.045 0-3.031-1.683-3.421-1.928a3.04 3.04 0 0 1-1.333-1.937 3.356 3.356 0 0 1 0-1.165c.095-.422.223-.728.439-1.045.36-.53.832-.905 1.452-1.154l.05-.02.011 1.963.01 1.965.052.099Zm8.7-2.226c1.896 1.08 1.735.985 1.947 1.146a2.955 2.955 0 0 1 1.169 2.35c0 .513-.097.927-.328 1.383a3.15 3.15 0 0 1-1.05 1.149c-.134.084-.54.29-.577.29-.008 0-.018-.875-.02-1.946l-.006-1.946-.047-.092a.654.654 0 0 0-.111-.153c-.036-.034-.952-.568-2.035-1.187-1.083-.62-1.98-1.137-1.995-1.15-.02-.018.123-.107.65-.406.371-.212.69-.384.708-.385.018 0 .781.426 1.695.947Zm-2.921.76.857.485V9.01l-.864.49c-.475.27-.871.494-.88.497-.009.003-.412-.219-.896-.494l-.881-.5V6.995l.873-.497c.496-.283.886-.493.903-.487.017.006.416.228.888.495Zm2.259 1.29c.318.181.613.351.655.378l.076.048v1.947c0 2.075-.003 2.143-.102 2.53-.475 1.861-2.613 2.811-4.34 1.928-.205-.105-.555-.34-.54-.362.004-.008.758-.44 1.676-.962 1.097-.623 1.698-.975 1.752-1.028.162-.157.153-.003.153-2.575v-2.28l.046.023.624.353Zm-1.4 2.845v.797l-1.66.942c-.913.518-1.733.978-1.822 1.022a3.405 3.405 0 0 1-.742.247c-.183.04-.267.047-.598.047-.29 0-.429-.01-.558-.036-.982-.202-1.779-.814-2.193-1.683a2.683 2.683 0 0 1-.278-1.163c-.01-.278.01-.574.041-.604.005-.005.748.412 1.65.925.904.514 1.674.95 1.713.97.104.052.231.067.341.04.062-.014.803-.425 2.095-1.16 1.1-.626 2.002-1.14 2.005-1.14.003-.001.005.357.005.796Z",clipRule:"evenodd"}))),W||(W=ex.createElement("defs",null,ex.createElement("clipPath",{id:"openai_svg__a"},ex.createElement("path",{fill:"#fff",d:"M.5 0h16v16H.5z"})))))};function rz(){return(rz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var rF=function(e){return ex.createElement("svg",rz({xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none"},e),q||(q=ex.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3.512 6.065c-.777 1.87-1.772 4.262-2.212 5.317l-.8 1.92 1.229.017c.676.01 1.24.006 1.255-.008.015-.014.221-.505.459-1.09l.431-1.066h4.718l.117.293.44 1.089.321.797h1.258c.98 0 1.25-.018 1.224-.082a3382.243 3382.243 0 0 1-3.78-9.073l-.625-1.512H4.924L3.512 6.065ZM9.68 2.788c.018.066 1.007 2.466 2.198 5.332l2.165 5.213h1.244c.684 0 1.23-.021 1.213-.048-.047-.074-4.3-10.303-4.354-10.472-.047-.144-.061-.146-1.274-.146-1.16 0-1.224.006-1.192.12ZM6.576 6.195c.178.439.515 1.265.75 1.838l.425 1.04-.739.019c-.406.01-1.089.01-1.517 0l-.78-.019.358-.878.748-1.837c.215-.528.4-.96.41-.96.012 0 .167.36.345.797Z",clipRule:"evenodd"})))};function rH(){return(rH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var rT=function(e){return ex.createElement("svg",rH({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),K||(K=ex.createElement("g",{clipPath:"url(#arrow_drop_down_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"m4.33 7.239 2.886 2.885a1.11 1.11 0 0 0 1.57 0l2.886-2.885c.702-.702.201-1.905-.79-1.905H5.11c-.991 0-1.482 1.203-.78 1.905Z"}))),X||(X=ex.createElement("defs",null,ex.createElement("clipPath",{id:"arrow_drop_down_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))};function rR(){return(rR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var rU=function(e){return ex.createElement("svg",rR({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"Search"},e),J||(J=ex.createElement("g",{clipPath:"url(#search_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"M10.333 9.333h-.526l-.187-.18a4.334 4.334 0 0 0 .987-3.56c-.314-1.853-1.86-3.333-3.727-3.56A4.337 4.337 0 0 0 2.033 6.88c.227 1.867 1.707 3.413 3.56 3.727a4.334 4.334 0 0 0 3.56-.987l.18.187v.526l2.834 2.834c.273.273.72.273.993 0a.704.704 0 0 0 0-.994l-2.827-2.84Zm-4 0c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3Z"}))),$||($=ex.createElement("defs",null,ex.createElement("clipPath",{id:"search_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))},rD=r(6635),rG={"gpt-3.5-turbo":{name:"GPT-3.5",description:"Very fast, great for most everyday tasks."},"gpt-4":{name:"GPT-4",description:"Most capable model, best for complex tasks requiring advanced reasoning.",limit:5},"claude-instant":{name:"Claude Instant",description:"Very fast, great for most everyday tasks."},claude:{name:"Claude+",description:"Balances fast responses with advanced reasoning. Best for creative and complex tasks.",limit:5}},rV=function(){let[e,t]=(0,ex.useState)(!1);return(0,ex.useEffect)(()=>{let e=()=>{t(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e},rB={"gpt-4":80,"gpt-3.5-turbo":0,"claude-instant":0,claude:50},rQ=(0,ex.memo)(function(){let{activeTabId:e}=(0,em.zR)(),{messages:t,setMessagePersona:r}=(0,em.GH)(),{personas:a,setAddedPersonas:n}=(0,em.Gm)(),{workspaceId:l}=(0,em.Oz)(),{data:s}=eF.d.personas.listAddedPersonas.useQuery({workspaceId:l},{enabled:!!l});(0,ex.useEffect)(()=>{s&&n(s)},[s]);let[i,o]=(0,ex.useState)(!1);(0,ex.useEffect)(()=>{if(t.length>1&&!i){let e=t[1].personaId;e&&a.find(t=>t.id===e)&&(r(e),o(!0))}},[t]);let d=(0,ex.useMemo)(()=>null==t?void 0:t.map((e,r)=>{let n=r===t.length-1,l=a.find(t=>t.id===e.personaId);return{...e,isLast:n,gifUrl:(null==l?void 0:l.gifUrl)||"",avatarUrl:null==l?void 0:l.avatarUrl,personaName:null==l?void 0:l.name,personaHandle:null==l?void 0:l.handle}}).sort((e,t)=>new Date(e.seq)-new Date(t.seq)),[t,a]);return(0,ed.jsx)(rY,{messages:d||[],activeTabId:e})});let rY=e=>{let{messages:t,activeTabId:r}=e,{showMenuBar:a,setShowMenuBar:n}=(0,em.Nf)();return(0,ed.jsx)("div",{className:"w-full flex flex-col relative grow",children:(0,ed.jsxs)("div",{children:[(0,ed.jsx)(rq,{}),(0,ed.jsx)("div",{children:(null==t?void 0:t.length)>0&&(null==t?void 0:t.map((e,t)=>(0,ed.jsx)(ed.Fragment,{children:(()=>{switch(e.role){case"user":return(0,ed.jsx)(rP,{id:(null==e?void 0:e.id)||"",content:(null==e?void 0:e.content)||"",createdAt:null==e?void 0:e.createdAt},t);case"assistant":return(0,ed.jsx)(rv,{message:e,id:null==e?void 0:e.id,tabId:r,seq:t+1,content:e.content,gifUrl:null==e?void 0:e.gifUrl,avatar:null==e?void 0:e.avatarUrl,isLast:null==e?void 0:e.isLast,model:null==e?void 0:e.model,personaName:null==e?void 0:e.personaName,personaHandle:null==e?void 0:e.personaHandle,personaId:null==e?void 0:e.personaId},"".concat(e.id,"-").concat(e.seq));case"upload":return(0,ed.jsx)(rA.Z,{content:e.content,onClickDownload:alert,message:e,id:null==e?void 0:e.id,tabId:r,seq:t+1,gifUrl:null==e?void 0:e.gifUrl,avatar:null==e?void 0:e.avatarUrl,isLast:null==e?void 0:e.isLast,model:null==e?void 0:e.model,personaName:null==e?void 0:e.personaName,personaHandle:null==e?void 0:e.personaHandle,personaId:null==e?void 0:e.personaId},"".concat(e.id,"-").concat(e.seq));case"content":return(0,ed.jsx)(rZ.Z,{content:e.content,message:e,id:null==e?void 0:e.id,tabId:r,seq:t+1,gifUrl:null==e?void 0:e.gifUrl,avatar:null==e?void 0:e.avatarUrl,isLast:null==e?void 0:e.isLast,model:null==e?void 0:e.model,personaName:null==e?void 0:e.personaName,personaHandle:null==e?void 0:e.personaHandle,personaId:null==e?void 0:e.personaId},"".concat(e.id,"-").concat(e.seq));default:return null}})()})))})]})})},rW=[{name:"GPT-3.5",key:"gpt-3.5-turbo",icon:(0,ed.jsx)(rI,{})},{name:"GPT-4",key:"gpt-4",icon:(0,ed.jsx)(rI,{})},{name:"Claude Instant",key:"claude-instant",icon:(0,ed.jsx)(rF,{})},{name:"Claude+",key:"claude",icon:(0,ed.jsx)(rF,{})}],rq=()=>{var e,t,r;let[a,n]=(0,ex.useState)(!1),{internetMode:l,setInternetMode:s}=(0,em.Oz)(),{model:i}=(0,em.Nf)(),[o,d]=(0,ex.useState)(i),[c,h]=(0,ex.useState)(0),u=rV(),{plan:m,allPlans:p}=ez(),x=(0,ex.useMemo)(()=>null==p?void 0:p.find(e=>e.name.toLowerCase()==m.plan.toLowerCase()),[p,m]),{workspaceId:f}=(0,em.Oz)(),{refetch:g}=eF.d.workspaces.listPlan.useQuery({workspaceId:f},{enabled:!!f}),{messages:v}=(0,em.GH)(),{setShowMenuBar:y,showMenuBar:b}=(0,em.Nf)(),w=(0,ex.useMemo)(()=>rW.findIndex(e=>e.key===i),[i]);return(0,ed.jsxs)("div",{className:"absolute md:sticky top-0 pt-4 w-full ".concat(b||(null==v?void 0:v.length)==0?"flex":"hidden"," md:flex justify-center rounded bg-transparent z-[10]"),children:[(0,ed.jsxs)("div",{onMouseEnter:()=>{u||(n(!0),g())},onMouseLeave:()=>!u&&n(!1),className:"relative shadow w-full p-1 mx-2 md:mx-0 bg-th-background-modal max-w-[616px] rounded flex flex-col md:flex-row gap-1 border border-th-border-primary",children:[(0,ed.jsx)(r3,{index:w,isMobile:u}),rW.map((e,t)=>(0,ed.jsx)("div",{className:"w-full flex-1",onMouseOver:()=>{d(e.key),h(t)},onMouseLeave:()=>{d(i),h(0)},children:(0,ed.jsx)(r$,{icon:e.icon,modelKey:e.key,name:e.name})})),(0,ed.jsx)(r6,{})]}),(0,ed.jsx)("div",{onMouseEnter:()=>!u&&n(!0),onMouseLeave:()=>!u&&n(!1),className:"".concat(a&&"h-[280px]"," h-[0px]\n         absolute top-14 w-full max-w-[616px] animate-opacity-appear ").concat(!a&&"overflow-hidden"," transition-all duration-200 ease-in-out"),children:(0,ed.jsx)("div",{className:"mt-2 bg-th-background-modal  grid rounded",children:(0,ed.jsxs)("div",{className:"border border-th-border-secondary shadow rounded",children:[(0,ed.jsxs)("div",{className:"px-4 py-2 border-b border-th-border-secondary w-full ",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark font-medium text-md",children:null==rG?void 0:null===(e=rG[o])||void 0===e?void 0:e.description}),(0,ed.jsxs)("p",{className:"text-th-primary-light font-normal text-sm",children:[rB[o]," credits |"," ",null==m?void 0:null===(t=m.credits)||void 0===t?void 0:t.toLocaleString()," remaining"]}),(0,ed.jsx)("p",{className:"text-th-primary-light font-normal text-sm",children:(null==rG?void 0:null===(r=rG[o])||void 0===r?void 0:r.limit)&&"".concat(null==x?void 0:x.rateLimit," messages every 3 hours")})]}),(0,ed.jsx)("div",{className:"px-4 py-2 border-b border-th-border-secondary w-full",children:(0,ed.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark font-medium text-md grow",children:"Active persona"}),(0,ed.jsx)(r1,{})]})}),(0,ed.jsx)("div",{className:"px-4 py-2 border-b border-th-border-secondary w-full",children:(0,ed.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark font-medium text-md grow",children:"Access internet"}),(0,ed.jsx)(rJ,{})]})}),(0,ed.jsx)("div",{className:"px-4 py-2 border-b border-th-border-secondary w-full",children:(0,ed.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark font-medium text-md grow",children:"Save chats"}),(0,ed.jsx)(rK,{})]})})]})})})]})},rK=()=>(0,ed.jsxs)("div",{className:"p-1 bg-th-background-secondary rounded flex gap-1 items-center border border-th-border-secondary h-9",children:[(0,ed.jsx)(ev.Z,{tooltip:"Only save chats when clicking 'Save chat' button",children:(0,ed.jsx)(rX,{name:"Manual",mode:"manual"})}),(0,ed.jsx)(ev.Z,{tooltip:"Automatically save chats",children:(0,ed.jsx)(rX,{name:"Auto",mode:"always"})})]}),rX=e=>{let{name:t,mode:r}=e,{autosave:a,setAutosave:n}=(0,em.Oz)();return eF.d.users.setAutoSavePreference.useMutation(),(0,ed.jsx)("div",{onClick:()=>{n(r)},className:"justify-center items-center text-sm flex px-2 py-1 ".concat(r===a?"bg-th-background ":"bg-transparent "," flex-1  rounded items-center hover:text-th-primary-dark hover:bg-th-background cursor-pointer"),children:t})},rJ=()=>(0,ed.jsxs)("div",{className:"p-1 bg-th-background-secondary rounded flex gap-1 items-center border border-th-border-secondary h-9",children:[(0,ed.jsx)(ev.Z,{tooltip:"Never use internet",shortcut:["⌘ + U"],children:(0,ed.jsx)(r0,{name:"Never",mode:"never"})}),(0,ed.jsx)(ev.Z,{tooltip:"Automatically use internet",shortcut:["⌘ + I"],children:(0,ed.jsx)(r0,{name:"Auto",mode:"auto"})}),(0,ed.jsx)(ev.Z,{tooltip:"Always use internet",shortcut:["⌘ + O"],children:(0,ed.jsx)(r0,{name:"Always",mode:"always"})})]}),r$=e=>{let{icon:t,name:r,modelKey:a}=e,{model:n,setModel:l}=(0,em.Nf)(),{internetMode:s,setInternetMode:i}=(0,em.Oz)(),{showToast:o}=(0,e4.pm)(),d=eF.d.chat.unhideChat.useMutation(),c=eF.d.users.setModelPreference.useMutation(),{workspaceId:h}=(0,em.Oz)(),{activeTabId:u}=(0,em.zR)(),{refetch:m}=eF.d.chat.loadTree.useQuery({workspaceId:h});return ey("i+Meta",()=>{i("auto"),o("Internet mode set to auto",{duration:1e3})}),ey("u+Meta",()=>{i("never"),o("Internet mode set to never",{duration:2e3})}),ey("o+Meta",()=>{i("always"),o("Internet mode set to always",{duration:2e3})}),ey("i+Control",()=>{i("auto"),o("Internet mode set to auto",{duration:2e3})}),ey("u+Control",()=>{i("never"),o("Internet mode set to never",{duration:2e3})}),ey("o+Control",()=>{i("always"),o("Internet mode set to always",{duration:2e3})}),ey("s+Meta",async()=>{await d.mutateAsync({chatId:u}),await m(),o("Saved chat",{duration:2e3})}),(0,ed.jsxs)("div",{onClick:()=>{l(a),c.mutate({preference:a})},className:"relative z-[10] flex gap-2 justify-start px-3 md:justify-center flex-1 ".concat(n==a?"text-th-primary-dark bg-transparent":"text-th-primary-light bg-transparent"," border border-transparent rounded items-center hover:text-th-primary-dark h-9 hover:bg-transparent cursor-pointer"),children:[t,(0,ed.jsx)("p",{className:"font-medium text-sm text-inherit",children:r})]})},r0=e=>{let{name:t,mode:r}=e,{internetMode:a,setInternetMode:n}=(0,em.Oz)(),l=eF.d.users.setInternetPreference.useMutation();return(0,ed.jsx)("div",{onClick:()=>{n(r),l.mutateAsync({preference:r})},className:"justify-center items-center text-sm flex px-2 py-1 ".concat(r==a?"bg-th-background ":"bg-transparent "," flex-1  rounded items-center hover:text-th-primary-dark hover:bg-th-background cursor-pointer"),children:t})},r1=()=>{var e,t;let{personas:r}=(0,em.Gm)(),{messages:a,messagePersona:n,setMessagePersona:l}=(0,em.GH)(),[s,i]=(0,ex.useState)(""),{setShowCreateModal:o}=(0,em.Yf)(),{user:d}=(0,eO.useUser)(),[c,h]=(0,ex.useState)(!1),u=(0,ex.useMemo)(()=>null==r?void 0:r.find(e=>e.id===n),[r,n]);return(0,ed.jsx)(ew.Z,{onClickAway:()=>h(!1),children:(0,ed.jsxs)("div",{className:"grid relative",children:[(0,ed.jsxs)("div",{className:"h-9 group flex justify-start gap-2 bg-th-background-secondary border border-th-border-secondary hover:border-th-primary-light px-3 py-1 rounded items-center w-48 cursor-pointer",onClick:()=>h(!c),children:[(0,ed.jsx)(e_(),{src:null==u?void 0:u.avatarUrl,className:"w-5 h-5 rounded",width:20,height:20,unoptimized:!0,alt:null==u?void 0:u.name,loading:"lazy"}),(0,ed.jsx)("p",{className:"grow text-th-primary-medium whitespace-nowrap font-medium text-sm group-hover:text-th-primary-dark",children:null==u?void 0:u.name}),c?(0,ed.jsx)(rT,{className:"text-th-primary-light group-hover:text-th-primary-dark transform rotate-180"}):(0,ed.jsx)(rT,{className:"text-th-primary-light group-hover:text-th-primary-dark"})]}),(0,ed.jsxs)("div",{className:"".concat(c?"block":"hidden"," shadow absolute max-h-64 bg-th-background-modal border border-th-border-secondary z-[100] top-10 w-[80vw] md:w-full right-0 overflow-y-scroll rounded"),children:[(0,ed.jsxs)("div",{className:"sticky top-0 bg-th-background-modal flex px-3 py-2 items-center gap-2 text-th-primary-light border-b border-th-border-secondary",children:[(0,ed.jsx)(rU,{}),(0,ed.jsx)("input",{type:"text",autoFocus:!0,placeholder:"Search",value:s,onChange:e=>i(e.target.value),className:"text-sm bg-th-background-modal w-full focus:outline-none"})]}),(0,ed.jsxs)("button",{onClick:()=>{o(!0),h(!1)},className:"h-9 px-3 py-2 text-sm flex gap-2 text-left items-center w-full border-b border-th-border-secondary text-th-primary-light hover:text-th-primary-dark",children:[(0,ed.jsx)(eg,{className:"h-[14px] w-[14px]"}),"Create persona"]}),null===(e=null===(t=null==r?void 0:r.filter(e=>{var t;return(null==e?void 0:e.name.toLowerCase().includes(s.toLowerCase()))||(null==e?void 0:null===(t=e.tags)||void 0===t?void 0:t.toLowerCase().includes(s.toLowerCase()))}))||void 0===t?void 0:t.filter(e=>!!e.avatarUrl))||void 0===e?void 0:e.map(e=>(0,ed.jsxs)("div",{className:"group flex justify-start gap-2 bg-th-background-modal border-b last:border-none border-th-border-secondary hover:bg-th-background-hover px-3 py-1 rounded items-center w-full cursor-pointer",onClick:()=>{l(e.id),d&&localStorage.setItem("".concat(null==d?void 0:d.id,":defaultPersonaId"),e.id)},children:[(0,ed.jsx)(e_(),{src:null==e?void 0:e.avatarUrl,className:"w-6 h-6 rounded",width:24,height:24,unoptimized:!0,alt:null==e?void 0:e.name,loading:"lazy"}),(0,ed.jsxs)("div",{className:"grid gap-0",children:[(0,ed.jsx)("p",{className:"grow text-th-primary-medium font-medium text-sm group-hover:text-th-primary-dark",children:null==e?void 0:e.name}),(0,ed.jsx)("p",{className:"grow text-th-primary-light text-[9px]",children:(0,rD.capitalize)(null==e?void 0:e.tags)})]})]}))]})]})})},r6=()=>{var e,t,r;let{model:a,setModel:n}=(0,em.Nf)(),[l,s]=(0,ex.useState)(!1);return(0,ed.jsxs)("div",{className:"grid gap-1",children:[(0,ed.jsxs)("div",{onClick:()=>s(!l),className:"relative h-9 flex md:hidden gap-2 justify-start px-3 items-center  ".concat(l?"text-th-primary-dark bg-th-background border-th-border-secondary":"bg-transparent border-transparent"," border rounded items-center hover:text-th-primary-dark hover:bg-th-background cursor-pointer"),children:[l?(0,ed.jsx)(rT,{}):(0,ed.jsx)(rT,{className:"transform rotate-[270deg]"}),(0,ed.jsx)("p",{className:"font-medium text-sm text-inherit",children:"Model and chat settings"})]}),l&&(0,ed.jsxs)("div",{className:"mt-2 bg-th-background-modal border border-th-border-secondary grid rounded",children:[(0,ed.jsxs)("div",{className:"px-4 py-2 border-b border-th-border-secondary w-full",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark font-medium text-md",children:null==rG?void 0:null===(e=rG[a])||void 0===e?void 0:e.description}),(0,ed.jsx)("p",{className:"text-th-primary-light font-normal text-sm",children:(null==rG?void 0:null===(t=rG[a])||void 0===t?void 0:t.limit)&&"".concat(null==rG?void 0:null===(r=rG[a])||void 0===r?void 0:r.limit," messages every 3 hours")})]}),(0,ed.jsx)("div",{className:"px-4 py-2 border-b border-th-border-secondary w-full",children:(0,ed.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark font-medium text-md grow",children:"Active persona"}),(0,ed.jsx)(r1,{})]})}),(0,ed.jsx)("div",{className:"px-4 py-2 border-b border-th-border-secondary w-full",children:(0,ed.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark font-medium text-md grow",children:"Access internet"}),(0,ed.jsx)(rJ,{})]})})]})]})},r3=e=>{let{index:t,isMobile:r}=e;return(0,ed.jsx)("div",{className:"pointer-events-none absolute m-1 top-0 left-0 flex-1 w-full md:w-[148px] h-9 rounded bg-th-background border border-th-border-secondary",style:{left:r?"":"".concat(148*t+4*t,"px"),top:r?"".concat(40*t,"px"):"",transition:"".concat(r?"top":"left"," 0.3s ease"),maxWidth:"calc(100% - 8px)"}})},r2=()=>{let{add:e}=(0,tx.useRouter)().query,[t,r]=(0,ex.useState)(!1),[a,n]=(0,ex.useState)(!1),{addTab:l,tabs:s,activeTabId:i,setActiveTabId:o,closeTab:d}=(0,em.zR)(),{setMessages:c,clearMessages:h,messages:u,isEditingMessage:m}=(0,em.GH)(),{user:p}=(0,eO.useUser)(),{workspaceId:x}=(0,em.Oz)(),{pathname:f}=(0,tx.useRouter)(),{refetch:g}=eF.d.chat.loadTree.useQuery({workspaceId:x},{enabled:!!x&&!f.includes("share")}),{showToast:v}=(0,e4.pm)(),{isExploring:y,isExploringClicked:b,setIsExploringClicked:w}=(0,em.El)(),{isSidebarOpen:j,setIsSidebarOpen:k}=(0,em.Nh)(),N=(0,ex.useRef)(null),{scroll:C,setScroll:E}=(0,em.CR)(),{personas:S}=(0,em.Gm)(),{setMessagePersona:O}=(0,em.GH)();function M(){N.current&&N.current.scrollTo({top:N.current.scrollHeight,behavior:"smooth"})}function _(){N.current&&N.current.scrollTo({top:0})}let P=(0,ex.useMemo)(()=>null==u?void 0:u.map((e,t)=>{let r=t===u.length-1,a=S.find(t=>t.id===e.personaId);return{...e,isLast:r,gifUrl:(null==a?void 0:a.gifUrl)||"",avatarUrl:null==a?void 0:a.avatarUrl,personaName:null==a?void 0:a.name}}).sort((e,t)=>new Date(e.createdAt)-new Date(t.createdAt)),[u,S]),Z=eF.d.chat.saveSharedChat.useMutation({}),A=(0,ex.useMemo)(()=>{if(!p)return;let e=s.find(e=>e.id===i);return e},[i,s]);async function L(e){await Z.mutateAsync({shareId:e,workspaceId:x}).then(e=>{e.chat||v("Unable to find chat");let t={name:e.chat.title,id:e.chat.id,icon:"",parentId:x};l(t),o(t.id),c(e.chat.messages),g()}).catch(e=>v("Chat not found"))}(0,ex.useEffect)(()=>{E(!0)},[i]),(0,ex.useEffect)(()=>{e&&!t&&a&&x&&(r(!0),L(e).then(()=>{})),n(!0),E(!0)},[e,a,x]),(0,ex.useEffect)(()=>{C&&(null==P?void 0:P.length)>0&&!m?(N.current&&N.current.scrollTo({top:N.current.scrollHeight}),E(!1)):!C||(null==P?void 0:P.length)!==0||y||m?C&&(null==P?void 0:P.length)===0&&y&&b&&!m?(M(),E(!1),w(!1)):C&&(null==P?void 0:P.length)===0&&y&&!b&&!m&&(_(),E(!1)):(_(),E(!1))},[C]);let[I,z]=(0,ex.useState)(""),F=(0,tx.useRouter)(),{showMenuBar:H,setShowMenuBar:T}=(0,em.Nf)();return(0,ed.jsxs)(ed.Fragment,{children:["signin"==I&&(0,ed.jsx)(eO.RedirectToSignIn,{}),"signup"==I&&(0,ed.jsx)(eO.RedirectToSignUp,{}),(0,ed.jsxs)("div",{className:"relative h-full bg-th-background flex-1 flex flex-col overflow-x-hidden",children:[p?(0,ed.jsx)(ed.Fragment,{children:(0,ed.jsxs)("div",{className:"lg:hidden sticky top-0 items-center gap-2 flex justify-between w-full bg-th-background z-[1] px-4 py-3 border-b border-th-border-primary",children:[(0,ed.jsx)(tg,{className:"cursor-pointer text-th-primary-light hover:text-th-primary-dark lg:hidden flex-shrink-0",height:"20px",width:"20px",onClick:()=>k(!j)}),(0,ed.jsxs)("p",{className:"text-center text-sm font-medium overflow-hidden whitespace-nowrap text-th-primary-dark text-ellipsis lg:hidden grow",children:[(0,ed.jsx)("span",{className:"pr-2",children:e5((null==A?void 0:A.icon)||"")}),null==A?void 0:A.name]}),(0,ed.jsx)(eg,{height:"20px",width:"20px",className:"cursor-pointer text-th-primary-light hover:text-th-primary-dark lg:hidden flex-shrink-0",onClick:function(){let e=ep(x);h(),O(""),l(e)}}),(0,ed.jsx)(eK,{className:"cursor-pointer h-4 w-4 ".concat(0==u.length&&"hidden"," text-th-primary-light hover:text-th-primary-dark lg:hidden flex-shrink-0"),onClick:()=>T(!H)})]})}):(0,ed.jsxs)("div",{className:"sticky top-0 items-center gap-4 flex justify-between w-full bg-th-background z-[1] px-4 md:px-10 py-3 border-b border-th-border-primary",children:[u.length?(0,ed.jsxs)("div",{className:"flex items-center gap-1 cursor-pointer text-th-primary-light hover:text-th-primary-dark hover:bg-th-background-hover px-1 py-1 md:px-3 md:py-[6px] rounded",onClick:()=>{h()},children:[(0,ed.jsx)(t3.Z,{}),(0,ed.jsx)("p",{className:"text-sm font-medium",children:"Back"})]}):(0,ed.jsx)(t4,{height:"32px",width:"32px",className:"text-th-primary-medium hover:text-th-primary-dark cursor-pointer",onClick:()=>F.push("/")}),(0,ed.jsxs)("div",{className:"flex gap-2 ",children:[(0,ed.jsx)("button",{className:"px-3 py-[6px] text-th-primary-medium text-sm font-medium hover:text-th-primary-dark",onClick:()=>z("signin"),children:"Login"}),(0,ed.jsx)("button",{className:"border border-th-border-primary font-medium rounded py-[6px] text-sm px-3 bg-transparent hover:bg-th-background-hover hover:border-th-primary-light text-th-primary-medium hover:text-th-primary-dark",onClick:()=>z("signup"),children:"Sign up"})]})]}),(0,ed.jsxs)("div",{className:"relative w-full h-full flex flex-col overflow-y-scroll overflow-x-hidden",ref:N,children:[(0,ed.jsx)(rQ,{}),(0,ed.jsx)(t6,{scrollFunction:M})]})]})]})};function r4(){let{isSidebarOpen:e,setIsSidebarOpen:t}=(0,em.Nh)(),{theme:r}=(0,rp.F)();return(0,ed.jsx)("div",{className:"fixed top-0 left-0 z-10 w-full h-full ".concat("dark"==r?"bg-white":"bg-black"," bg-opacity-50 duration-100 ").concat(e?"opacity-100":"opacity-0 pointer-events-none"),onClick:()=>t(!1),children:(0,ed.jsx)("div",{className:"absolute top-3 left-[292px] h-8 w-8 flex cursor-pointer justify-center items-center p-0 z-[100] bg-th-background border border-th-background-secondary rounded shadow",children:(0,ed.jsx)(ty.Z,{className:"text-th-primary-dark",height:"16",width:"16"})})})}var r5=r(6748);let r7=e=>{let{value:t,onChange:r,placeholder:a}=e,[n,l]=(0,ex.useState)(!1);return(0,ed.jsxs)("div",{className:"w-full border border-th-border-secondary border rounded p-0 flex bg-th-background items-center hw-full overflow-hidden",children:[(0,ed.jsx)("div",{className:"h-8 w-8 border-r border-th-border-secondary flex justify-center items-center ",children:(0,ed.jsx)(rU,{className:"my-auto text-th-primary-light"})}),(0,ed.jsx)("input",{type:"text",className:"input input-xs text-sm font-normal text-th-primary-dark bg-inherit px-2 py-1 m-0 focus:outline-none h-full w-full",placeholder:a,value:t,onChange:e=>r(e.target.value),onFocus:()=>l(!0),onBlur:()=>l(!1)})]})};function r8(){var e,t,r;let{workspaceId:a}=(0,em.Oz)(),{setSettingsTitle:n,setSettingsDescription:l}=(0,em.F2)(),[s,i]=(0,ex.useState)(""),{showToast:o}=(0,e4.pm)(),{refetch:d}=eF.d.personas.listCategoryPersonas.useQuery({workspaceId:a}),c=eF.d.personas.deletePersona.useMutation();async function h(e){await c.mutateAsync({personaId:e,workspaceId:a}),await d(),o("Persona deleted",{duration:2e3})}let{personas:u,setPersonas:m}=(0,em.Gm)();return(0,ex.useEffect)(()=>{n("Personas"),l("Manage personas that you have created")},[]),(0,ed.jsxs)("div",{className:"h-full w-full",children:[(0,ed.jsx)("div",{className:"sticky w-full top-0 bg-th-background-modal",children:(0,ed.jsx)(r7,{value:s,onChange:i,placeholder:"Search personas"})}),(0,ed.jsx)("div",{className:"flex flex-col w-full overflow-auto h-full",children:null===(e=null===(t=null===(r=null==u?void 0:u.filter(e=>e.name.toLowerCase().includes(s.toLowerCase())))||void 0===r?void 0:r.sort((e,t)=>e.name.localeCompare(t.name)))||void 0===t?void 0:t.filter(e=>e.canEdit))||void 0===e?void 0:e.map(e=>(0,ed.jsx)(r9,{id:e.id,avatarUrl:(null==e?void 0:e.avatarUrl)||"",name:e.name,handle:e.handle,isEnabled:e.isEnabled,canEdit:null==e?void 0:e.canEdit,handleDeletePersona:h},e.id))})]})}let r9=e=>{let{avatarUrl:t,name:r,handle:a,id:n,isEnabled:l,canEdit:s,handleDeletePersona:i}=e,{setShowEditModal:o,setEditPersonaId:d}=(0,em.Yf)(),[c,h]=(0,ex.useState)("view");return(0,ed.jsx)("div",{className:"flex py-2 gap-2 w-full justify-between items-center border-b border-th-background-secondary",children:"view"==c?(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsxs)("div",{className:"grow flex gap-2 items-center w-full",children:[t&&(0,ed.jsx)(e_(),{src:t,height:20,width:20,className:"object-cover h-8 w-8 rounded",alt:"Persona avatar"}),(0,ed.jsxs)("div",{className:"grid md:flex item0-center",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark text-sm font-medium whitespace-nowrap",children:"".concat(r," ").concat(t?"":"(Pending)")}),(0,ed.jsxs)("p",{className:"block md:hidden text-xs text-th-primary-dark text-left",children:["@",a]})]})]}),(0,ed.jsxs)("div",{className:"grow flex gap-2 justify-start items-center",children:[(0,ed.jsxs)("p",{className:"hidden md:inline text-xs text-th-primary-dark text-left",children:["@",a]}),s&&(0,ed.jsx)(eJ,{onClick:()=>{o(!0),d(n)},className:"h-4 w-4 cursor-pointer text-th-primary-light hover:text-th-primary-dark"}),(0,ed.jsx)(e0,{onClick:()=>h("delete"),className:"h-4 w-4 cursor-pointer text-th-primary-light hover:text-th-primary-dark"})]})]}):(0,ed.jsxs)("div",{className:"flex gap-2 w-full h-9 items-center",children:[(0,ed.jsx)("p",{className:"text-sm text-th-primary-light grow",children:"Are you sure you want to do this?"}),(0,ed.jsxs)("div",{className:"flex gap-2",children:[(0,ed.jsx)(eu.Z,{tooltip:"Approve",display:"bottom",align:"right",children:(0,ed.jsx)(eQ.Z,{onClick:()=>i(n),className:"text-th-primary-medium hover:text-th-primary-dark cursor-pointer"})}),(0,ed.jsx)(eu.Z,{tooltip:"Cancel",display:"bottom",align:"right",children:(0,ed.jsx)(eW,{onClick:()=>h("view"),className:"text-th-primary-medium hover:text-th-primary-dark cursor-pointer"})})]})]})})};function ae(){return(ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var at=function(e){return ex.createElement("svg",ae({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"Dark"},e),ee||(ee=ex.createElement("g",{fill:"currentColor",clipPath:"url(#dark_svg__a)"},ex.createElement("path",{d:"M7.4 8.053c-1.333-2.586-.613-4.906.047-6.18.126-.24-.08-.513-.354-.48a6.67 6.67 0 0 0-5.766 6.88c.006 0 .006 0 .006.007A3.317 3.317 0 0 1 5.4 9.433 2.674 2.674 0 0 1 7.333 12c0 1.013-.58 1.887-1.413 2.34a6.667 6.667 0 0 0 7.247-2.127c.173-.213.026-.526-.247-.546-1.66-.087-4.187-1.02-5.52-3.614Z"}),ex.createElement("path",{d:"M4.667 10.666h-.12a2.007 2.007 0 0 0-1.88-1.333c-1.107 0-2 .893-2 2s.893 2 2 2h2C5.4 13.333 6 12.733 6 12c0-.734-.6-1.334-1.333-1.334Z"}))),et||(et=ex.createElement("defs",null,ex.createElement("clipPath",{id:"dark_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))};function ar(){return(ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var aa=function(e){return ex.createElement("svg",ar({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"Light"},e),er||(er=ex.createElement("g",{clipPath:"url(#light_svg__a)"},ex.createElement("path",{fill:"currentColor",d:"m4.034 2.76-.26-.26a.662.662 0 0 0-.934 0l-.006.006c-.26.26-.26.68 0 .934l.26.26c.26.26.673.26.933 0l.007-.007a.656.656 0 0 0 0-.933ZM2.007 7h-.68a.657.657 0 0 0-.66.66v.006c0 .367.293.66.66.66H2a.65.65 0 0 0 .667-.653v-.007A.659.659 0 0 0 2.007 7Zm6-6.634H8a.659.659 0 0 0-.666.66v.64c0 .367.293.66.66.66H8a.65.65 0 0 0 .667-.653v-.647a.657.657 0 0 0-.66-.66Zm5.16 2.14a.67.67 0 0 0-.94-.006l-.26.26c-.26.26-.26.68 0 .933l.007.007c.26.26.68.26.933 0l.26-.26a.656.656 0 0 0 0-.934ZM11.96 12.573l.26.26a.664.664 0 1 0 .94-.94l-.26-.26a.662.662 0 0 0-.933 0 .658.658 0 0 0-.007.94Zm1.374-4.913v.006c0 .367.293.66.66.66h.673c.367 0 .66-.293.66-.66V7.66a.657.657 0 0 0-.66-.66h-.673a.657.657 0 0 0-.66.66ZM8 3.666c-2.206 0-4 1.794-4 4 0 2.207 1.794 4 4 4 2.207 0 4-1.793 4-4 0-2.206-1.793-4-4-4Zm-.006 11.3H8c.367 0 .66-.293.66-.66v-.64a.657.657 0 0 0-.66-.66h-.006a.657.657 0 0 0-.66.66v.64c0 .367.293.66.66.66Zm-5.16-2.14c.26.26.68.26.94 0l.26-.26a.662.662 0 0 0 0-.933l-.007-.007a.664.664 0 0 0-.94 0l-.26.26a.67.67 0 0 0 .007.94Z"}))),ea||(ea=ex.createElement("defs",null,ex.createElement("clipPath",{id:"light_svg__a"},ex.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))};let an={2:4,3:3,4:2},al=e=>{let{options:t}=e,r=(0,ex.useRef)(null),[a,n]=(0,ex.useState)(0),[l,s]=(0,ex.useState)(0);return(0,ex.useEffect)(()=>{let e=t.findIndex(e=>e.isSelected);n(e)},[t]),(0,ex.useEffect)(()=>{r.current&&s((r.current.clientWidth-an[t.length]*t.length)/t.length)},[r.current,t.length]),(0,ed.jsxs)("div",{ref:r,className:"relative flex items-center border border-th-border-secondary rounded w-full rounded overflow-hidden p-1 gap-0",children:[(0,ed.jsx)(as,{index:a,width:l}),t.map((e,t)=>(0,ed.jsxs)("button",{onClick:()=>{(null==e?void 0:e.onClick)&&e.onClick(),n(t)},className:"".concat(e.isSelected?"text-th-primary-dark":"text-th-primary-light"," z-[10] relative  bg-transparent hover:text-th-primary-dark grow items-center flex justify-center gap-3 py-[6px]"),children:[e.icon&&e.icon,e.name]},e.name))]})},as=e=>{let{index:t,width:r}=e;return rV(),(0,ed.jsx)("div",{className:"pointer-events-none bg-th-background-secondary absolute m-1 top-0 left-0 flex-1 w-[".concat(r,"] h-9 rounded border border-th-border-secondary"),style:{left:"".concat(t*r,"px"),transition:"all 0.3s ease",maxWidth:"calc(100% - 8px)",width:"".concat(r,"px")}})},ai=()=>{let[e,t]=(0,ex.useState)(!1),{theme:r,setTheme:a}=(0,rp.F)();return((0,ex.useEffect)(()=>t(!0),[]),e)?(0,ed.jsxs)("div",{className:"flex gap-3 w-full items-center",children:[(0,ed.jsx)("div",{className:"flex gap-3 items-center h-10",children:(0,ed.jsx)("p",{className:"whitespace-nowrap font-medium flex-1 text-sm text-th-primary-dark",children:"Change theme"})}),(0,ed.jsx)(al,{options:[{name:"Light",value:"light",icon:(0,ed.jsx)(aa,{}),onClick:()=>a("light"),isSelected:"dark"!==r},{name:"Dark",value:"dark",icon:(0,ed.jsx)(at,{}),onClick:()=>a("dark"),isSelected:"dark"===r}]})]}):null};function ao(){let{setSettingsTitle:e,setSettingsDescription:t}=(0,em.F2)(),{viewMode:r,setViewMode:a}=(0,em.Vh)(),{user:n}=(0,eO.useUser)();return(0,ex.useEffect)(()=>{e("Display preferences"),t("Manage your display preferences.")},[]),(0,ed.jsx)(ed.Fragment,{children:(0,ed.jsx)("div",{className:"w-full ",children:(0,ed.jsx)(ai,{})})})}function ad(){return(ad=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ac=function(e){return ex.createElement("svg",ad({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none","aria-label":"People"},e),en||(en=ex.createElement("path",{fill:"currentColor",d:"M10.667 7.333a1.992 1.992 0 0 0 1.993-2 1.997 1.997 0 1 0-3.993 0c0 1.107.893 2 2 2Zm-5.333 0a1.992 1.992 0 0 0 1.993-2 1.997 1.997 0 1 0-3.993 0c0 1.107.893 2 2 2Zm0 1.334C3.78 8.667.667 9.447.667 11v1c0 .367.3.667.667.667h8c.366 0 .666-.3.666-.667v-1c0-1.553-3.113-2.333-4.666-2.333Zm5.333 0a7.79 7.79 0 0 0-.647.033c.014.007.02.02.027.027.76.553 1.287 1.293 1.287 2.273v1c0 .233-.047.46-.12.667h3.453c.367 0 .667-.3.667-.667v-1c0-1.553-3.114-2.333-4.667-2.333Z"})))},ah=r(8222);function au(){return(au=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var am=function(e){return ex.createElement("svg",au({xmlns:"http://www.w3.org/2000/svg",width:"width",height:"height",fill:"none","aria-label":"Mode",viewBox:"0 0 20 20"},e),el||(el=ex.createElement("path",{fill:"currentColor",d:"M10 0C4.48 0 0 4.48 0 10s4.48 10 10 10 10-4.48 10-10S15.52 0 10 0ZM9 17.93c-3.94-.49-7-3.85-7-7.93s3.05-7.44 7-7.93v15.86Zm2-15.86c1.03.13 2 .45 2.87.93H11v-.93ZM11 5h5.24c.25.31.48.65.68 1H11V5Zm0 3h6.74c.08.33.15.66.19 1H11V8Zm0 9.93V17h2.87c-.87.48-1.84.8-2.87.93ZM16.24 15H11v-1h5.92c-.2.35-.43.69-.68 1Zm1.5-3H11v-1h6.93c-.04.34-.11.67-.19 1Z"})))};function ap(){return(ap=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ax=function(e){return ex.createElement("svg",ap({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),es||(es=ex.createElement("path",{fill:"currentColor",d:"M13.333 4H11.88c.073-.207.12-.433.12-.667a1.997 1.997 0 0 0-3.667-1.1L8 2.68l-.334-.453A2.008 2.008 0 0 0 6 1.334c-1.107 0-2 .893-2 2 0 .233.046.46.12.666H2.666c-.74 0-1.326.593-1.326 1.333l-.007 7.334c0 .74.593 1.333 1.333 1.333h10.667c.74 0 1.333-.593 1.333-1.333V5.334c0-.74-.593-1.334-1.333-1.334ZM10 2.667c.366 0 .666.3.666.667 0 .366-.3.666-.666.666a.669.669 0 0 1-.667-.667c0-.366.3-.666.667-.666Zm-4 0c.366 0 .666.3.666.667C6.666 3.7 6.366 4 6 4a.669.669 0 0 1-.667-.667c0-.366.3-.666.667-.666Zm7.333 10H2.666v-1.333h10.667v1.333Zm0-3.333H2.666V6c0-.367.3-.667.667-.667h2.72L5.066 6.68c-.22.3-.153.72.147.934a.668.668 0 0 0 .927-.147L8 4.934l1.86 2.533c.213.293.633.36.926.147a.663.663 0 0 0 .147-.934l-.987-1.346h2.72c.367 0 .667.3.667.666v3.334Z"})))};let af=e=>{let{icon:t,label:r,onClick:a,isSelected:n}=e;return(0,ed.jsxs)("div",{onClick:a,className:"md:w-full p-2 h-9 flex items-center gap-2 rounded hover:bg-th-background-hover cursor-pointer hover:text-th-primary-dark ".concat(n?"text-th-primary-dark bg-th-background-hover":"text-th-primary-light bg-th-background-modal"),children:[(0,ed.jsx)("div",{className:"flex justify-center items-center",children:t}),(0,ed.jsx)("p",{className:"text-sm whitespace-nowrap",children:r})]})};var ag=function(e){let{currentPage:t,setCurrentPage:r}=e,{workspaces:a,workspaceId:n}=(0,em.Oz)(),{showSubscription:l,setShowSubscription:s}=(0,em.F2)(),{user:i}=(0,eO.useUser)(),[o]=(0,ex.useState)(null==i?void 0:i.firstName),[d]=(0,ex.useState)(null==i?void 0:i.lastName),c=(0,ex.useMemo)(()=>a.find(e=>e.id===n),[a,n]);return(0,ex.useEffect)(()=>{l&&r(ei.Subscription),s(!1)},[l]),(0,ed.jsxs)("div",{className:"flex flex-col w-full md:w-[200px] gap-3 align-center md:border-r border-th-border-secondary py-3 px-3",children:[(0,ed.jsxs)("div",{className:"flex gap-2 items-center w-full",children:[(0,ed.jsx)(e_(),{src:(null==c?void 0:c.avatarUrl)||"",height:28,width:28,alt:"Team logo",unoptimized:!0,className:"rounded"}),(0,ed.jsxs)("p",{className:"text-th-primary-dark grow text-sm font-medium",children:[o," ",d]})]}),(0,ed.jsxs)("div",{className:"flex md:flex-col flex-row gap-1 flex-wrap",children:[(0,ed.jsx)(af,{icon:(0,ed.jsx)(ek,{height:"16",width:"16"}),label:"General",isSelected:t===ei.General,onClick:()=>r(ei.General)}),(0,ed.jsx)(af,{icon:(0,ed.jsx)(am,{height:"16",width:"16"}),label:"Preferences",isSelected:t===ei.Display,onClick:()=>r(ei.Display)}),(null==c?void 0:c.type)==="team"&&(0,ed.jsx)(af,{icon:(0,ed.jsx)(ac,{height:"16",width:"16"}),label:"Team members",onClick:()=>r(ei.TeamMembers),isSelected:t===ei.TeamMembers}),(0,ed.jsx)(af,{icon:(0,ed.jsx)(ah.Z,{className:"w-4"}),label:"Personas",isSelected:t===ei.Personas,onClick:()=>r(ei.Personas)}),(0,ed.jsx)(af,{icon:(0,ed.jsx)(eS,{className:"w-4"}),label:"Subscription",isSelected:t===ei.Subscription,onClick:()=>r(ei.Subscription)}),(0,ed.jsx)(af,{icon:(0,ed.jsx)(ax,{className:"w-4"}),label:"Credits",isSelected:t===ei.Credits,onClick:()=>r(ei.Credits)})]})]})};function av(){let{user:e}=(0,eO.useUser)(),{signOut:t}=(0,eO.useClerk)(),{showToast:r}=(0,e4.pm)(),a=eF.d.users.updateName.useMutation(),n=eF.d.users.deleteUserAccount.useMutation(),[l,s]=(0,ex.useState)(null==e?void 0:e.firstName),[i,o]=(0,ex.useState)(null==e?void 0:e.lastName),[d,c]=(0,ex.useState)(!1),{setSettingsTitle:h,setSettingsDescription:u}=(0,em.F2)(),m=async()=>{r("Updating name",{duration:1e3}),await a.mutateAsync({firstName:l,lastName:i}),await (null==e?void 0:e.reload())};(0,ex.useEffect)(()=>{h("Profile"),u("Manage your Forefront profile.")},[]);let p=async()=>{r("Your account data has been marked for deletion",{duration:3e3}),await n.mutateAsync(),setTimeout(()=>{t()},3e3)};return(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-3 w-full",children:[(0,ed.jsx)("p",{className:"font-medium text-sm text-th-primary-dark",children:"Email"}),(0,ed.jsx)("input",{className:"px-3 py-2 text-sm cursor-not-allowed bg-th-background-secondary text-th-primary-light rounded w-full",value:null==e?void 0:e.primaryEmailAddress,disabled:!0})]}),(0,ed.jsxs)("div",{className:"flex flex-col md:flex-row gap-3 w-full",children:[(0,ed.jsxs)("div",{className:"flex flex-col flex-1 gap-3",children:[(0,ed.jsx)("p",{className:"font-medium text-sm text-th-primary-dark",children:"First name"}),(0,ed.jsx)("input",{className:"outline-none bg-th-background focus:border-th-primary-light px-3 py-2 text-sm border border-th-border-secondary text-th-primary-light focus:text-th-primary-dark rounded",value:l||"",onChange:e=>s(e.target.value)})]}),(0,ed.jsxs)("div",{className:"flex flex-col flex-1 gap-3",children:[(0,ed.jsx)("p",{className:"font-medium text-sm text-th-primary-dark",children:"Last name"}),(0,ed.jsx)("input",{className:"outline-none bg-th-background px-3 py-2 focus:border-th-primary-light text-sm border border-th-border-primary text-th-primary-light focus:text-th-primary-dark rounded",value:i||"",onChange:e=>o(e.target.value)})]})]}),(0,ed.jsx)("button",{onClick:m,disabled:l==(null==e?void 0:e.firstName)&&i==(null==e?void 0:e.lastName),className:"outline-none justify-self-start px-3 py-[6px] flex items-center text-sm cursor-pointer font-medium normal-case rounded bg-th-background-secondary hover:bg-th-background-hover border border-th-border-secondary hover:text-th-primary-dark text-th-primary-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Update"}),(0,ed.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ed.jsx)("p",{className:"text-lg text-th-primary-dark font-semibold leading-7",children:"Delete your account"}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-light leading-5",children:"WARNING: If you want to permanently delete this account and all of its data, including but not limited to chats, personas, and messages, you can do so below."})]}),d?(0,ed.jsxs)("div",{className:"flex flex-col w-full gap-3 mb-8",children:[(0,ed.jsx)("button",{onClick:()=>c(!1),className:"px-3 py-2 text-sm font-medium cursor-pointer rounded hover:bg-th-background-hover normal-case text-th-primary-light hover:text-th-primary-dark",children:"Cancel"}),(0,ed.jsx)("button",{onClick:p,className:"px-3 py-[6px] flex items-center justify-center text-sm cursor-pointer font-medium normal-case rounded bg-th-error-primary hover:bg-th-error-primary border border-th-error-secondary text-th-error-secondary disabled:opacity-50 disabled:cursor-not-allowed outline-none",children:"I want to permanently delete my account and all of its data"})]}):(0,ed.jsx)("button",{onClick:()=>c(!0),className:"justify-self-start px-3 py-[6px] flex items-center text-sm cursor-pointer font-medium normal-case rounded bg-th-error-primary hover:bg-th-error-primary border border-th-error-secondary text-th-error-secondary disabled:opacity-50 disabled:cursor-not-allowed outline-none mb-8",children:"Delete account"})]})}var ay=r(3767);function ab(e){let{onClick:t,onDiscard:r}=e,[a,n]=(0,ex.useState)(!1);async function l(){n(!0),await t(),n(!1)}return(0,ed.jsx)("div",{className:"modal modal-open",children:(0,ed.jsxs)("div",{className:"modal-box bg-th-background-modal rounded-md w-full max-w-[560px] px-6 py-4 md:px-10 md:py-6 grid flex flex-col gap-6",children:[(0,ed.jsxs)("div",{className:"grid gap-3",children:[(0,ed.jsxs)("div",{className:"flex ",children:[(0,ed.jsxs)("div",{className:"flex-1 flex gap-3 items-center",children:[(0,ed.jsx)("div",{className:"flex justify-center items-center h-7 w-7 bg-th-primary-dark text-th-background rounded",children:(0,ed.jsx)(eS,{className:"h-4 w-4"})}),(0,ed.jsx)("p",{className:"font-semibold text-lg text-th-primary-dark",children:"Downgrade subscription"})]}),(0,ed.jsx)("div",{className:"flex justify-center items-center h-6 w-6 cursor-pointer",children:(0,ed.jsx)(ty.Z,{onClick:r,className:"h-5 w-5 text-th-primary-light hover:text-th-primary-dark"})})]}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-medium",children:"Are you sure you want to downgrade your subscription? Your current credits will remain, and your next billing cycle will be billed according to the downgraded subscription."})]}),(0,ed.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,ed.jsx)("button",{onClick:r,className:"py-[6px] px-3 text-sm text-th-primary-light hover:bg-th-background-secondary rounded",children:"Cancel"}),(0,ed.jsx)("button",{onClick:l,className:"btn ".concat(a&&"loading"," p-0 py-[6px] normal-case text-sm px-3 text-sm text-th-primary-medium hover:text-th-primary-dark text-th-primary-dark bg-th-background-secondary rounded min-h-1"),children:a?"":"Downgrade"})]})]})})}function aw(e){let{onClick:t,onDiscard:r}=e,[a,n]=(0,ex.useState)(!1);async function l(){n(!0),await t(),n(!1)}return(0,ed.jsx)("div",{className:"modal modal-open",children:(0,ed.jsxs)("div",{className:"modal-box bg-th-background-modal rounded-md w-full max-w-[560px] px-6 py-4 md:px-10 md:py-6 grid flex flex-col gap-6",children:[(0,ed.jsxs)("div",{className:"grid gap-3",children:[(0,ed.jsxs)("div",{className:"flex ",children:[(0,ed.jsxs)("div",{className:"flex-1 flex gap-3 items-center",children:[(0,ed.jsx)("div",{className:"flex justify-center items-center h-7 w-7 bg-th-primary-dark text-th-background rounded",children:(0,ed.jsx)(eS,{className:"h-4 w-4"})}),(0,ed.jsx)("p",{className:"font-semibold text-lg text-th-primary-dark",children:"Upgrade subscription"})]}),(0,ed.jsx)("div",{className:"flex justify-center items-center h-6 w-6 cursor-pointer",children:(0,ed.jsx)(ty.Z,{onClick:r,className:"h-5 w-5 text-th-primary-light hover:text-th-primary-dark"})})]}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-medium",children:"Please confirm your subscription upgrade. You'll be charged the price difference immediately, receive credits, and your next billing cycle will reflect the upgraded plan."})]}),(0,ed.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,ed.jsx)("button",{onClick:r,className:"py-[6px] px-3 text-sm text-th-primary-light hover:bg-th-background-secondary rounded",children:"Cancel"}),(0,ed.jsx)("button",{onClick:l,className:"btn ".concat(a&&"loading"," p-0 py-[6px] normal-case text-sm px-3 text-sm text-th-primary-medium hover:text-th-primary-dark text-th-primary-dark bg-th-background-secondary rounded min-h-1"),children:a?"":"Upgrade"})]})]})})}function aj(){let{setSettingsTitle:e,setSettingsDescription:t}=(0,em.F2)(),{workspaceId:r,workspaces:a}=(0,em.Oz)(),[n,l]=(0,ex.useState)(void 0),[s,i]=(0,ex.useState)(void 0),[o,d]=(0,ex.useState)(!1),{plan:c,allPlans:h}=ez(),{refetch:u}=eF.d.workspaces.listPlan.useQuery({workspaceId:r},{enabled:!!r}),m=(0,ex.useMemo)(()=>a.find(e=>e.id===r),[r,a]),p=eF.d.workspaces.createBillingPortalUrl.useMutation(),x=eF.d.workspaces.createCheckoutSession.useMutation(),f=eF.d.workspaces.downgrade.useMutation(),g=eF.d.workspaces.upgradeSubscription.useMutation();(0,ex.useEffect)(()=>{e("Subscription"),t("Choose and manage your subscription")},[]);let v=(0,ex.useMemo)(()=>null==h?void 0:h.find(e=>e.name.toLowerCase()==c.plan.toLowerCase()),[h,c]),[y,b]=(0,ex.useState)("");async function w(){if(!r)return;let e=await p.mutateAsync({workspaceId:r});b((null==e?void 0:e.url)||"")}async function j(e){d(!0);let t=null==h?void 0:h.find(t=>t.name.toLowerCase()==e);if(t&&v){if(console.log(t,v),null==m?void 0:m.subscriptionId)(null==v?void 0:v.cost)>(null==t?void 0:t.cost)?l(e):(null==v?void 0:v.cost)<(null==t?void 0:t.cost)?i(e):alert("same plan");else{let t=await x.mutateAsync({workspaceId:r,plan:e});(null==t?void 0:t.url)&&(window.location.href=t.url)}d(!1)}}async function k(){await f.mutateAsync({workspaceId:r,plan:n}).then(async()=>{await u(),l(void 0)}).catch(e=>{d(!1)})}async function N(){await g.mutateAsync({workspaceId:r,plan:s}).then(async()=>{await u(),i(void 0)}).catch(e=>{d(!1)})}(0,ex.useEffect)(()=>{(null==c?void 0:c.status)!="active"||(null==c?void 0:c.plan)==="free"||y||w()},[r,c,y]);let{showToast:C}=(0,e4.pm)();return(0,ed.jsxs)(ed.Fragment,{children:[n&&(0,ed.jsx)(ab,{onClick:k}),s&&(0,ed.jsx)(aw,{onClick:N}),(0,ed.jsxs)("div",{className:"flex flex-col w-full gap-4 items-start",children:[(0,ed.jsx)("div",{className:"flex flex-col md:flex-row gap-2 w-full",children:null==h?void 0:h.map(e=>{var t;return(0,ed.jsx)(aN,{name:e.name,price:(e.cost/100).toFixed(0),credits:e.credits,description:"Free"!==e.name?"Increased rate limit":"",isCurrentPlan:(null==c?void 0:null===(t=c.name)||void 0===t?void 0:t.toLowerCase())==e.name.toLowerCase(),handleClick:j,currentPlanCredits:null==v?void 0:v.credits,rateLimit:e.rateLimit})})}),(null==c?void 0:c.status)=="active"&&(null==c?void 0:c.plan)!=="Free"&&(0,ed.jsx)("button",{onClick:()=>{""!==y?window.open(y,"_blank"):C("Error opening billing portal.")},className:"w-full text-center text-th-primary-light hover:text-th-primary-dark text-sm hover:bg-th-background-secondary rounded py-2  w-full",children:"Manage my subscription"}),(0,ed.jsx)("div",{className:"divider m-0 p-0"}),(0,ed.jsxs)("div",{className:"grid gap-0",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark text-[20px] font-semibold",children:"Credits breakdown"}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-medium",children:"See how credits are charged."})]}),(0,ed.jsxs)("div",{className:"grid gap-6 w-full pb-4",children:[(0,ed.jsxs)("div",{className:"grid gap-0",children:[(0,ed.jsx)("p",{className:"text-th-primary-light text-sm font-medium text-left",children:"Models"}),(0,ed.jsx)(ak,{name:"GPT-3.5 response",credits:"0"}),(0,ed.jsx)(ak,{name:"Claude Instant response",credits:"0"}),(0,ed.jsx)(ak,{name:"Claude+ response",credits:"50"}),(0,ed.jsx)(ak,{name:"GPT-4 response",credits:"80"})]}),(0,ed.jsxs)("div",{className:"grid gap-0",children:[(0,ed.jsx)("p",{className:"text-th-primary-light text-sm font-medium text-left",children:"Extensions"}),(0,ed.jsx)(ak,{name:"Search internet",credits:"20"}),(0,ed.jsx)(ak,{name:"Upload PDF",credits:"40"}),(0,ed.jsx)(ak,{name:"Image generation",credits:"50"}),(0,ed.jsx)(ak,{name:"Transcription",credits:"80"})]})]})]})]})}let ak=e=>{let{name:t,credits:r}=e;return(0,ed.jsxs)("div",{className:"flex h-9 items-center border-b border-th-border-secondary",children:[(0,ed.jsx)("p",{className:"text-sm font-medium text-th-primary-dark grow",children:t}),(0,ed.jsxs)("p",{className:"text-sm text-th-primary-medium font-normal",children:[r," credits"]})]})},aN=e=>{let{name:t,price:r,credits:a,description:n,currentPlanCredits:l,handleClick:s,rateLimit:i,currentPlanLabel:o="Current plan"}=e,[d,c]=(0,ex.useState)(!1);async function h(){c(!0),await s(t.toLowerCase()),c(!1)}return(0,ed.jsxs)("div",{className:"w-full flex flex-col gap-0 border border-th-border-secondary rounded grow overflow-hidden",children:[(0,ed.jsx)("p",{className:"h-11 flex items-center justify-center w-full text-center border-b border-th-border-secondary text-th-primary-dark font-semibold text-md",children:t}),(0,ed.jsxs)("div",{className:"grid h-full  items-center bg-th-background gap-2 w-full px-3 py-3 ",children:[(0,ed.jsxs)("div",{className:"flex gap-1 w-full justify-center",children:[(0,ed.jsxs)("div",{className:"flex",children:[(0,ed.jsx)("span",{className:"italic align-top text-[12px]",children:"$"}),(0,ed.jsx)("p",{className:"text-th-primary-dark text-[20px]",children:r})]}),(0,ed.jsx)("p",{className:"text-[12px] self-end",children:"/ month"})]}),(0,ed.jsxs)("p",{className:"w-full text-center text-th-primary-dark text-sm font-normal flex items-center gap-1 justify-center",children:[(0,ed.jsx)(ax,{}),a.toLocaleString()," credits"]}),(0,ed.jsxs)("p",{className:"text-th-primary-medium text-xs font-normal flex justify-center items-center  text-center px-1",children:[i," messages per 3 hours for premium models"]}),(0,ed.jsxs)("div",{className:"flex items-center h-11 ",children:[l>a&&(0,ed.jsx)(ed.Fragment,{children:d?(0,ed.jsx)("div",{className:"w-full flex justify-center",children:(0,ed.jsx)("span",{className:"loading loading-spinner loading-xs"})}):(0,ed.jsx)("button",{onClick:h,className:" text-sm white font-normal bg-transparent py-[6px] text-sm text-th-primary-light hover:text-th-primary-dark w-full bg-th-background-secondary rounded  hover:text-th-primary-dark",children:"Downgrade"})}),l==a&&(0,ed.jsx)("p",{className:" text-th-primary-medium w-full text-center font-medium text-sm",children:o}),l<a&&(0,ed.jsx)(ed.Fragment,{children:d?(0,ed.jsx)("div",{className:"w-full flex justify-center",children:(0,ed.jsx)("span",{className:"loading loading-spinner loading-xs"})}):(0,ed.jsx)("button",{onClick:h,className:" text-sm white border border-th-border-secondary py-[6px] text-sm text-th-primary-light hover:text-th-primary-dark w-full bg-th-background-secondary rounded font-semibold hover:text-th-primary-dark",children:"Upgrade"})})]})]})]})};function aC(){var e;let{setShowSettings:t,setSettingsTitle:r,setSettingsDescription:a,setShowAddCredits:n}=(0,em.F2)(),{plan:l,allPlans:s}=ez(),{workspaceId:i}=(0,em.Oz)(),o=(0,ex.useMemo)(()=>null==s?void 0:s.find(e=>e.name.toLowerCase()==l.plan.toLowerCase()),[s]),{data:d}=eF.d.workspaces.listSubscriptionOptions.useQuery({workspaceId:i},{enabled:!!i}),{refetch:c}=eF.d.workspaces.listPlan.useQuery({workspaceId:i},{enabled:!!i});(0,ex.useEffect)(()=>{i&&c()},[]),(0,ex.useEffect)(()=>{console.log(l)},[l]);let h=(0,ex.useMemo)(()=>{if(l)return null==d?void 0:d.find(e=>e.name.toLowerCase()==(null==l?void 0:l.plan.toLowerCase()))},[d]);return(0,ex.useEffect)(()=>{r("Credits"),a("View and manage your credit balance.")},[]),(0,ed.jsxs)("div",{className:"flex flex-col w-full gap-5",children:[(0,ed.jsxs)("div",{className:"flex items-end gap-1",children:[(0,ed.jsx)("span",{className:"font-semibold text-[20px] text-th-primary-dark self-start",children:null==l?void 0:l.base.toLocaleString()}),(0,ed.jsx)("p",{className:"text-xs text-th-primary-light flex gap-1 items-end",children:"/ ".concat(null==h?void 0:null===(e=h.credits)||void 0===e?void 0:e.toLocaleString()," ").concat(o.name," plan credits. Next reset on ").concat(function(e){let t=new Date(e),r=t.toLocaleString("default",{month:"long"}),a=t.getDate();return"".concat(r," ").concat(a)}(null==l?void 0:l.reset),".")})]}),(0,ed.jsxs)("div",{className:"flex items-end gap-1",children:[(0,ed.jsx)("span",{className:"font-semibold text-[20px] text-th-primary-dark self-start",children:null==l?void 0:l.added.toLocaleString()}),(0,ed.jsx)("p",{className:"text-xs text-th-primary-light flex gap-1 items-end",children:"additional credits"})]}),(0,ed.jsx)("button",{onClick:()=>{t(!1),n(!0)},className:"w-full text-th-primary-light text-sm hover:text-th-primary-dark hover:bg-th-background-secondary py-2 rounded",children:"Add credits"})]})}function aE(e){let{onDiscard:t}=e,[r,a]=(0,ex.useState)(ei.General),{settingsTitle:n,settingsDescription:l}=(0,ay.F)();return(0,ex.useEffect)(()=>(document.body.classList.add("overflow-hidden"),()=>{document.body.classList.remove("overflow-hidden")}),[]),(0,ed.jsx)("div",{className:"modal modal-open",style:{maxWidth:"100vw"},children:(0,ed.jsx)(ew.Z,{onClickAway:t,children:(0,ed.jsx)("div",{className:"px-4 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:(0,ed.jsxs)("div",{className:"flex flex-col w-full h-[640px] md:flex-row rounded-md border border-th-border-primary bg-th-background-modal overflow-hidden",children:[(0,ed.jsx)(ag,{currentPage:r,setCurrentPage:a}),(0,ed.jsxs)("div",{className:"flex flex-col items-start w-screen max-w-[640px] min-h-[400px]",children:[(0,ed.jsxs)("div",{className:"flex justify-between items-start w-full px-4 md:px-10 pt-6 pb-3 mb-3",children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ed.jsx)("p",{className:"text-xl font-semibold text-th-primary-dark",children:n}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-medium",children:l})]}),(0,ed.jsx)("div",{onClick:t,className:"hidden md:block p-1 cursor-pointer text-th-primary-light hover:text-th-primary-dark hover:bg-th-background-secondary rounded",children:(0,ed.jsx)(ty.Z,{height:"20",width:"20"})})]}),(0,ed.jsx)("div",{className:"relative px-4 md:px-10 h-full overflow-y-scroll w-full",children:(0,ed.jsxs)("div",{className:"flex flex-col gap-6 w-full items-start justify-start h-full",children:[r===ei.General&&(0,ed.jsx)(av,{}),r===ei.Personas&&(0,ed.jsx)(r8,{}),r===ei.Display&&(0,ed.jsx)(ao,{}),r===ei.Subscription&&(0,ed.jsx)(aj,{}),r===ei.Credits&&(0,ed.jsx)(aC,{})]})})]})]})})})})}(a=ei||(ei={})).General="General",a.Display="Display preferences",a.TeamMembers="Team members",a.Extensions="Extensions",a.Workflows="Workflows",a.Personas="Personas",a.Security="Security",a.Subscription="Subscription",a.Billing="Billing",a.Credits="Credits";var aS=r(5847),aO=r.n(aS),aM=(function(){return(e=>{var t,r;for(t=16;t%4==0;t++){var a=0;e=e.concat(function(){var t;if(1==++a)return[];for(t=52;t;t--)e.unshift(e.pop());return[]}())}for(r=53;r;r--)e.unshift(e.pop());return e})([155,2,20,1,113,202,8,9,82,19,142,143,16,83,14,7,184,11,4,10,3,185,66,128,194,5,85,44,126,244,18,262,13,15,17,137,168,165,198,33,0,95,89,6,250])}).call(void 0),a_=e=>aM[e+191],aP=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=e=>aM[e+66];if(t.length=a_(-182),t[a(-66)]=-a(-64),t[t[a(-66)]-(t[a(-66)]-(t[a(-66)]+a(-65)))]>30)return t[t[a(-66)]-(t[aM[0]]-53)];var n=e=>aM[e-96];return t[t[t[n(96)]+n(97)]-(t[t[n(96)]-(t[n(96)]-a(-66))]-(t[a(-66)]+34))](t[t[t[n(96)]+n(97)]+(t[t[a(-66)]-(t[a(-66)]-n(96))]-(t[t[t[a(-66)]+n(97)]-(t[n(96)]-n(96))]-n(98)))]())}(function(){return"(\"$'#;,\"*:(%;6,:1<~8SLRoD*n~>1'2,%-<;2*>%5;<4(*-;'?6461/-=(ķ4#&>!4?2\"))=Đ~/PBPLAQ*8=9mKSěĶ69')9,5-5ňA8,[fF*%ŘđEa`irDf%gdFCfLŘ{0x7E757Ĵčž60A,žƀ382DƋx88}ňFDk*\"EbPŘcharCodeAt1fromCƢƤƦe1apply1length1slicƴreƸaǆ1!ǎǎ1uǒǒ"},function(e){var t,r,a,n={},l=e.split(""),s=r=l[a_(-188)],i=[s],o=t=256;for(e=a_(-180);e<l.length;e++)i.push(a=o>(a=l[e].charCodeAt(a_(-188)))?l[e]:n[a]?n[a]:r+s),s=a.charAt(a_(-188)),n[t]=r+s,t++,r=a;return i.join("").split("1")}),aZ=[],aA=a_(-188),aL=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=e=>aM[e-179];return t.length=a(182),t[a_(-187)]=a(184),t[t[a(183)]-a(184)]=[aq(t[t[t[t[a_(-187)]-(t[a_(-187)]-a_(-187))]+a_(-185)]-(t[a(183)]-a(183))]-(t[t[a_(-187)]-(t[a_(-187)]-a(183))]-a_(-188))),"{0x7E66584B,0x611,0x7E4B3937,0x60A,0x7E705648,0x688,0x7E79734E,0x650,0x7E63594C,0x681,0x7E73,0x8}","'2=('/\"1)*=(/","{0x7E634F4A,0x688,0x7E7A6C57,0x611,0x7E6F5047,0x642,0x7E724A48,0x60A}","{0x7E574E42,0x611,0x7E796430,0x650,0x7E724C43,0x60A,0x7E5044,0x401,0x7E793731,0x60A,0x7E33,0x8}",aq(a_(-180)),aq(t[a_(-187)]-87),"{0x7E644E49,0x688,0x7E70554D,0x60A,0x7E6E6563,0x681,0x7E7A5643,0x681,0x7E724941,0x642,0x7E54,0x8}","{0x7E736561,0x688,0x7E35322D,0x688,0x7E63362D,0x681,0x7E6362,0x88}",aq(t[a(183)]-86),aq(t[a(183)]-a_(-157)),"{0x7E743633,0x650,0x7E797639,0x681,0x7E422624,0x650,0x7E45,0x8}","{0x7E726563,0x650,0x7E746561,0x650,0x7E736148,0x688,0x7E68,0x8}","{0x7E736861,0x60A,0x7E363532,0x688}",aq(t[t[a_(-187)]-(t[a_(-187)]-a(183))]-(t[t[a_(-187)]+(t[a_(-187)]-a(200))]-(t[a(183)]-84))),aq(a(185)),aq(t[t[a(183)]+(t[a(183)]-(t[a_(-187)]-a(185)))]-a_(-175)),"{0x7E726563,0x650,0x7E746561,0x650,0x7E706943,0x688,0x7E726865,0x681,0x7E7669,0x88}",aq(a(193)),'."381',"{0x7E6E6966,0x688,0x7E6C61,0x88}",aq(t[t[a_(-187)]+a(185)]-(t[t[t[t[t[t[a_(-187)]+a(185)]-(t[a(183)]-a_(-187))]+a_(-185)]+a(185)]+a(185)]-a_(-176)))],t[t[a_(-187)]-(t[a_(-187)]-a(183))]=t[t[a_(-187)]+a(185)]-a_(-154),t[t[a(183)]+a_(-184)]>t[t[a(183)]+a_(-184)]+50?t[t[a_(-187)]-(t[a_(-187)]+96)]:(aA?t[t[t[a_(-187)]+a(186)]+a_(-183)].pop():aA++,t[t[a_(-187)]+a_(-183)])}(),aI=aW.apply(void 0,[21]),az=aV(a_(-169)),aF=aQ.apply(void 0,[a_(-149)]),aH=aQ(a_(-151));let aT=r(1941),aR=aQ.apply(void 0,[a_(-177)]),aU=aV.apply(void 0,[a_(-176)])+aW(a_(-164))+aQ.apply(void 0,[a_(-166)]);var aD=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=e=>aM[e+129];t.length=a_(-180),t[a_(-175)]=t[a_(-177)],t[a_(-180)]=aV.apply(this,[a_(-174)]),t[a_(-167)]=t[a_(-176)],t[a_(-182)]=aV(a_(-174)),t[a(-101)]=aQ.apply(this,[a_(-181)]),t[a(-103)]=aV.apply(this,[a_(-174)]),t[a(-111)]=-a_(-180),t[t[t[a(-111)]+a_(-172)]-(t[t[a_(-173)]+a(-110)]-a_(-158))]=aQ(t[t[a_(-173)]+a_(-172)]-(t[a(-111)]-a(-91))),t[t[t[t[a(-111)]+a(-110)]-(t[a_(-173)]-a(-111))]+a_(-168)]=aW(a(-109)),t[t[a(-111)]+a_(-177)]=aW(t[a_(-173)]+a_(-171)),t[t[t[t[a_(-173)]+a(-110)]+a_(-172)]+a(-108)]=aT[aQ.apply(this,[t[a_(-173)]+(t[t[a(-111)]+a(-110)]+a(-107))])](aH)[aV(t[a_(-173)]+a_(-150))](aU)[t[t[a(-111)]-(t[a(-111)]-a_(-168))]](),t[t[a_(-173)]-(t[a(-111)]-a(-105))]=aT[t[t[a(-111)]-(t[t[a_(-173)]-(t[a(-111)]-a(-111))]-(t[t[a_(-173)]+(t[a_(-173)]-(t[a(-111)]-a_(-172)))]+a(-106)))]](a_(-171)),t[t[t[t[a(-111)]+a_(-172)]+a(-110)]+a_(-166)]=aT[aF](aR,t[t[t[a(-111)]+a_(-172)]+a_(-170)],t[t[a_(-173)]-(t[a(-111)]-(t[a(-111)]+a(-100)))]);let n=t[t[a_(-173)]+a(-104)][az](t[t[a(-111)]+a_(-180)],t[t[t[a(-111)]-(t[a(-111)]-a_(-173))]+(t[t[t[a_(-173)]+a(-110)]+a(-110)]+a(-106))],t[a_(-165)]);if(t[a(-111)]>t[t[a(-111)]+a_(-172)]+108){var l=e=>a_(e+48);return t[t[t[a(-111)]+a_(-172)]-(t[l(-221)]+l(-221))]}return n+=t[a(-102)][t[t[a_(-173)]+a(-103)]](t[t[t[a_(-173)]+(t[a_(-173)]+144)]+a(-101)]),function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=e=>aM[e+140];if(t.length=a_(-182),t[a_(-183)]=t[a(-131)],t[a_(-183)]=-135*eo-207,t[a_(-181)]=t[a(-137)],-83772===t[a(-132)])return t[a(-130)]+t[a(-129)]}(t[t[t[a_(-173)]+a(-110)]+a_(-162)][aI+"ng"](t[t[a_(-173)]-(t[a(-111)]-a_(-180))]),n,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=e=>aM[e+180];if(t.length=a_(-180),t[a(-168)]=a_(-178),t[t[a_(-179)]-(t[a(-168)]-a_(-179))]>t[t[a(-168)]-a_(-186)]-(t[a_(-179)]-283))return t[t[a(-168)]+43];var n=e=>a_(e+58);return t[t[a_(-179)]-(t[t[t[a_(-179)]-(t[a_(-179)]-a(-168))]-(t[a_(-179)]-a_(-179))]-(t[a(-168)]-n(-236)))]=eo+(eo=t[t[t[a(-168)]-(t[t[a_(-179)]-n(-244)]-(t[a(-168)]-n(-244)))]-(t[n(-237)]-(t[a_(-179)]-n(-236)))],t[a_(-179)]-(t[a_(-179)]-n(-246))),t[t[t[t[t[t[a_(-179)]-a_(-186)]-a(-175)]-(t[t[a(-168)]-a_(-186)]-a_(-179))]-a_(-186)]-(t[t[t[n(-237)]-n(-244)]-n(-244)]-n(-246))]}(t[t[t[t[a_(-173)]+a_(-172)]+a_(-172)]+a_(-172)]+620))};function aG(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=e=>aM[e-182];t.length=a_(-180),t[a_(-161)]=-a_(-160);var n,l,s,i=t[a_(-161)]+a_(-160),o="",d=t[t[t[t[a(212)]+a_(-159)]+a(214)]-(t[a_(-161)]-(t[t[a_(-161)]+a(214)]+a_(-160)))].length,c=String,h=aq(t[a_(-161)]+138),u=aq(t[a_(-161)]+139);for(t[t[a(212)]-(t[t[a(212)]+a_(-159)]-(t[a(212)]-(t[a_(-161)]-218)))]=t[t[t[a(212)]-(t[t[a(212)]+a(214)]-a_(-161))]-(t[a(212)]-a(185))],s=a(185);s<d;s+=a_(-180)){var m=e=>a_(e-16);(n=t[t[a_(-161)]+346][h](s)-a(184))>=a(185)&&n<32?(i+=(l=l<<t[a_(-161)]+133|n,a(215)))>=t[t[t[a_(-161)]+a(214)]+m(-143)]-(t[a_(-161)]-m(-161))?i-=(o+=c[u](l>>i-a(196)&t[t[m(-145)]+a(214)]-(t[a(212)]-(t[a_(-161)]+383))),m(-161)):m(-172):(t[a(212)],a_(-160))}return t[t[a(212)]-(t[t[a(212)]+a_(-159)]-(t[a(212)]+a(214)))]>-a(216)?t[t[a_(-161)]-(t[a_(-161)]+a(206))]:o}function aV(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:aG,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:aZ;return r?t[aZ[r]]=aV(e,t):(t&&([n,t]=[a(n),e||r]),t?e[n[t]]:aZ[e]||(n[e],r=a,aZ[e]=r(aL[e])))}function aB(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=e=>aM[e-56];t.length=a_(-180),t[a_(-156)]=t[a(67)],t[a_(-156)]="",t[a_(-155)]=t[a(59)],t[a(92)]=t[a_(-155)].substring(a_(-180),t[a(92)].length-a_(-180)),t[a(65)]=t[a_(-155)].split(","),t[a(93)]=-a_(-153);for(var n=t[a_(-154)]-(t[a(93)]-a(59));n<t[t[t[t[t[a_(-154)]-(t[a_(-154)]-a(93))]+a(95)]-(t[a_(-154)]-a(93))]+a(66)].length;n+=t[a_(-154)]+a_(-181)){var l=e=>a_(e-207);t[a(82)]=[t[t[a_(-154)]-(t[t[a_(-154)]-(t[a(93)]-(t[a(93)]+l(55)))]-l(25))][n],t[t[a(93)]+(t[a_(-154)]+38)][n+(t[a(93)]+l(33))]];for(var[s,i]=t[t[t[a_(-154)]+a(95)]+(t[t[t[a(93)]+a_(-152)]-(t[l(53)]-(t[l(53)]+l(55)))]-(t[a(93)]-(t[a_(-154)]+40)))].map(Number);i;)t[l(51)]+=String.fromCharCode(s>>a(70)*(i&a(79))&t[l(53)]+273),i>>=l(44)}return t[t[t[a_(-154)]+a(95)]+a(95)]>t[t[a_(-154)]-(t[a(93)]-a(93))]-(t[t[a_(-154)]+a(95)]-39)?t[-28]:t[t[a_(-154)]+(t[a(93)]-(t[a_(-154)]-62))].replace(/~/g,"")}function aQ(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:aB,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:aZ;return r?t[aZ[r]]=aQ(e,t):(t&&([n,t]=[a(n),e||r]),t?e[n[t]]:aZ[e]||(n[e],r=a,aZ[e]=r(aL[e])))}function aY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[aq(a_(-166)),aq(12)];var r,a,n,l,s,i=e=>aM[e+39],o=String,d=aq(a_(-151)),c=aq(a_(-164)),h=aq(i(-17)),u=aq(a_(-150));for("<~"===e[h](a_(-188),i(-30))&&e[h](-a_(-182)),e=e[h](i(-30),-a_(-182))[u](/s/g,"")[u]("z",aq(i(-19))),r=aq(a_(-149))[h](e[d]%i(-6)||a_(-158)),e+=r,n=[],l=a_(-188),s=e[d];s>l;l+=a_(-158))a=52200625*(e[c](l)-i(-37))+614125*(e[c](l+i(-28))-i(-37))+7225*(e[c](l+a_(-182))-a_(-189))+a_(-157)*(e[c](l+a_(-163))-a_(-189))+(e[c](l+i(-13))-i(-37)),n.push(255&a>>24,255&a>>a_(-171),255&a>>i(-25),255&a);return function(e,t){var r;for(r=t;r>i(-36);r--)e.pop()}(n,r[d]),o[t[a_(-188)]][t[i(-28)]](o,n)}function aW(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:aY,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:aZ;return r?t[aZ[r]]=aW(e,t):(t&&([n,t]=[a(n),e||r]),t?e[n[t]]:aZ[e]||(n[e],r=a,aZ[e]=r(aL[e])))}function aq(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length=a_(-180),t[a_(-148)]=-a_(-147),t[t[a_(-148)]-(t[a_(-148)]-a_(-148))]>t[a_(-148)]+65?t[-173]:aP[t[t[t[a_(-148)]+305]+a_(-147)]]}var aK=r(8834).Buffer;function aX(){let{workspaceId:e}=(0,em.Oz)(),{generatingPersonas:t,addGeneratingPersona:r,removeGeneratingPersona:a,personas:n}=(0,em.Gm)(),{user:l}=(0,eO.useUser)(),{sessionId:s}=(0,eO.useAuth)(),{showToast:i}=(0,e4.pm)(),{messagePersona:o,setSignature:d}=(0,em.GH)(),c=eF.d.personas.isPersonaReady.useMutation(),{refetch:h}=eF.d.personas.listCategoryPersonas.useQuery({workspaceId:e}),{refetch:u}=eF.d.personas.listAddedPersonas.useQuery({workspaceId:e});(0,ex.useEffect)(()=>{if(e&&(null==n?void 0:n.length)){let e=n.filter(e=>!1==e.isReady||""==e.systemMessage);e.forEach(e=>{r(e.id,e.name)})}},[n]),(0,ex.useEffect)(()=>{let e=aD(aK.from(s).toString("base64"));d(e)},[o,null==l?void 0:l.id,e]),(0,ex.useEffect)(()=>{if(Object.keys(t).length){let r=setInterval(async()=>{Object.keys(t).map(async t=>{var r;let n=await c.mutateAsync({workspaceId:e,id:t});(null==n?void 0:null===(r=n.persona)||void 0===r?void 0:r.isReady)&&(i("One of your personas is ready!"),a(t),await h(),await u())})},1e4);return()=>clearInterval(r)}},[t]);let[m,p]=(0,ex.useState)(!1);async function x(){let e=await fetch("/api/version"),t=await e.json();return t.sha}async function f(){let e=await x(),t=localStorage.getItem("commit");t&&e!==t&&(localStorage.setItem("commit",e),p(!0))}return(0,ex.useEffect)(()=>{f(),setTimeout(()=>{f()},15e3)},[]),(0,ed.jsx)(ed.Fragment,{children:m&&(0,ed.jsx)("div",{onClick:()=>{window.location.reload()},className:" fixed z-[1000000] w-full top-[48px] flex justify-center items-center gap-2 p-3",children:(0,ed.jsx)("div",{className:"cursor-pointer bg-th-background border-th-brand-primary flex items-center px-4 gap-2 py-3 rounded border drop-shadow-xl animate-grow-fade-in",children:(0,ed.jsx)("p",{className:"cursor-pointer text-th-brand-primary text-sm font-medium",children:"New version available! Click here to update"})})})})}let aJ=()=>{let{showCreateModal:e,setShowCreateModal:t,name:r,description:a,avatar:n,setName:l,setDescription:s,setAvatar:i,reset:o}=(0,em.Yf)(),{addGeneratingPersona:d}=(0,em.Gm)(),{workspaceId:c}=(0,em.Oz)(),{refetch:h}=eF.d.personas.listCategoryPersonas.useQuery({workspaceId:c}),{showToast:u}=(0,e4.pm)(),m=eF.d.personas.createPersona.useMutation();async function p(){u("Creating persona (<60 seconds)"),t(!1),await m.mutateAsync({name:r,workspaceId:c}).then(e=>{u("Creating persona! Your persona will be available shortly."),h(),d(e.id,""),l(""),s("")}).catch(e=>{var t,r,a;(null==e?void 0:null===(t=e.shape)||void 0===t?void 0:t.message)?u("Please use a more descriptive name for your persona"):(null===(r=e.data)||void 0===r?void 0:null===(a=r.error)||void 0===a?void 0:a.message)?u(e.data.error.message):u("Error creating persona. Please wait a few minutes and try again.")})}return(0,ex.useEffect)(()=>{o()},[e]),(0,ed.jsx)("div",{className:"modal ".concat(e&&"modal-open"),children:(0,ed.jsx)(ew.Z,{onClickAway:()=>t(!1),children:(0,ed.jsxs)("div",{className:"modal-box bg-th-background-modal rounded-md w-full max-w-[560px] px-6 py-4 md:px-10 md:py-6 grid flex flex-col gap-6",children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ed.jsx)("p",{className:"text-lg font-semibold text-th-primary-dark",children:"Create persona"}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-medium",children:"Give your persona a name. You can edit your persona after it is created."})]}),(0,ed.jsxs)("div",{children:[(0,ed.jsx)("div",{className:"flex gap-2",children:(0,ed.jsx)("input",{className:"px-3 py-3 placeholder:text-th-primary-light border bg-th-background border-th-border-secondary focus:border-th-primary-light focus:text-th-primary-dark rounded w-full outline-none resize-none text-sm",placeholder:"Enter name",value:r,onChange:e=>l(e.target.value)})}),(0,ed.jsxs)("div",{className:"modal-action",children:[(0,ed.jsx)("label",{className:"px-3 py-2 text-sm font-medium cursor-pointer rounded bg-transparent hover:bg-th-background-hover normal-case text-th-primary-medium hover:text-th-primary-dark",onClick:()=>t(!1),children:"Cancel"}),(0,ed.jsx)("button",{className:"px-3 py-[6px] flex items-center text-sm cursor-pointer font-medium normal-case rounded bg-th-background-secondary hover:bg-th-background-hover border border-th-border-secondary hover:text-th-primary-dark text-th-primary-medium",onClick:p,children:"Create"})]})]})]})})})},a$=()=>(0,ed.jsxs)("div",{className:"h-32 w-32 rounded-lg px-2 py-2 relative rounded bg-th-background border border-th-border-primary overflow-hidden min-w-[120px] max-w-[120px] flex flex-col gap-2 items-center justify-center",children:[(0,ed.jsx)("div",{className:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-th-primary-medium border-solid border-current border-r-transparent border-t-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"}),(0,ed.jsx)("p",{className:"text-th-primary-medium text-center text-xs font-medium",children:"Loading"})]}),a0=()=>{let{showEditModal:e,setShowEditModal:t,name:r,description:a,avatar:n,gif:l,setGif:s,setName:i,setDescription:o,setAvatar:d,editPersonaId:c,hasCustomDescription:h,setHasCustomDescription:u,customDescription:m,setCustomDescription:p}=(0,em.Yf)(),{showToast:x}=(0,e4.pm)(),[f,g]=(0,ex.useState)(!1),[v,y]=(0,ex.useState)(!1),[b,w]=(0,ex.useState)(0),[j,k]=(0,ex.useState)(!1),{workspaceId:N}=(0,em.Oz)(),C=eF.d.personas.editPersona.useMutation(),{personas:E}=(0,em.Gm)(),S=eF.d.personas.regenPersonaAvatar.useMutation(),O=eF.d.personas.animateAvatar.useMutation(),{refetch:M}=eF.d.personas.listCategoryPersonas.useQuery({workspaceId:N},{enabled:!!N}),{refetch:_}=eF.d.personas.listAddedPersonas.useQuery({workspaceId:N},{enabled:!!N});async function P(){try{if(c){let e=E.find(e=>e.id===c);x("Regenerating avatar"),g(!0);let t=await S.mutateAsync({personaId:e.id,workspaceId:N,name:r});d(t.avatarUrl),s(""),g(!1),x("Avatar regenerated")}}catch(e){console.log(e),g(!1),x("Error regenerating avatar. Make sure your name is valid and meets community guidelines.")}}let[Z,A]=(0,ex.useState)(!1);(0,ex.useEffect)(()=>{if(c&&(null==E?void 0:E.length)&&!Z){let t=E.find(e=>e.id===c);if(t){var e;i(t.name),o(t.systemMessage),d(t.avatarUrl),A(!0),u(t.hasCustomDescription),p(t.customDescription||""),s(t.gifUrl),w(null===(e=t.customDescription)||void 0===e?void 0:e.length)}}},[E,c]);let L=(0,ex.useMemo)(()=>{if(c&&(null==E?void 0:E.length)){let e=E.find(e=>e.id===c);if(console.log(e),e.name!==r||e.systemMessage!==a||e.avatarUrl!==n||e.gifUrl!==l||e.hasCustomDescription!==h||e.customDescription!==m)return!0}return!1},[r,a,n,c,E,l,h,m]);async function I(){x("Persona updated"),y(!0);let e=E.find(e=>e.id===c);await C.mutateAsync({name:r,personaId:e.id,description:""!==a?a:void 0,avatarUrl:n!==e.avatarUrl?n:void 0,gifUrl:l!==e.gifUrl?l:void 0,workspaceId:N,hasCustomDescription:h,customDescription:m||void 0}),await M(),await _(),t(!1)}async function z(){let e=E.find(e=>e.id===c);x("Animating avatar"),g(!0),await O.mutateAsync({personaId:e.id,workspaceId:N,name:r,url:n}).then(e=>{console.log(e);let t=e.gifUrl;s(t),g(!1)}).catch(e=>{console.log(e),g(!1),x("Error regenerating avatar. Make sure your name is valid and meets community guidelines")})}return(0,ex.useEffect)(()=>{b>2e3&&!j?k(!0):b<=2e3&&j&&k(!1)},[b]),(0,ed.jsx)("div",{className:"modal ".concat(e&&"modal-open"),children:(0,ed.jsxs)("div",{className:"relative flex flex-col bg-th-background-modal border overflow-hidden border-th-border-primary rounded-md w-full max-h-[640px] max-w-[560px]",children:[(0,ed.jsx)("div",{className:"sticky top-0 bg-th-background-modal border-b border-th-border-primary px-6 md:px-10 py-4",children:(0,ed.jsx)("h1",{className:"text-lg font-bold text-th-primary-dark",children:"Edit persona"})}),(0,ed.jsxs)("div",{className:"relative h-full flex flex-col pt-6 overflow-y-scroll",children:[(0,ed.jsxs)("div",{className:"flex-1 flex flex-col px-6 md:px-10 gap-6",children:[(0,ed.jsx)("div",{className:"flex justify-between gap-6",children:(0,ed.jsx)("div",{className:"group overflow-hidden rounded relative",children:f?(0,ed.jsx)(a$,{}):(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsx)("img",{src:l||n,alt:r,className:" h-32 w-32 object-cover rounded-lg "}),(0,ed.jsx)("div",{className:"absolute bottom-8 w-full ",children:(0,ed.jsxs)("div",{className:"flex flex-col md:justify-center gap-1 px-2",children:[(0,ed.jsx)("button",{onClick:P,className:"md:hidden group-hover:block bottom-4 text-xs bg-black/[0.8] hover:bg-black text-white/[0.8] hover:text-white border border-th-border-secondary px-2 py-1 rounded",children:"New avatar"}),(0,ed.jsx)("button",{onClick:z,className:"md:hidden group-hover:block bottom-4 text-xs bg-black/[0.9] hover:bg-black text-white/[0.8] hover:text-white border border-th-border-secondary px-2 py-1 rounded",children:"Animate avatar"})]})})]})})}),(0,ed.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark text-base font-medium",children:"Name"}),(0,ed.jsx)("input",{className:"px-3 py-3 placeholder:text-th-primary-light border bg-th-background border-th-border-secondary focus:border-th-primary-light focus:text-th-primary-dark rounded w-full outline-none resize-none text-sm",placeholder:"Name",value:r,onChange:e=>i(e.target.value)})]}),(0,ed.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,ed.jsxs)("div",{className:"flex gap-6",children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ed.jsx)("p",{className:"text-th-primary-dark text-base font-medium",children:"Customize persona instructions"}),(0,ed.jsx)("p",{className:"text-th-primary-medium text-sm",children:"Optionally override how this persona will behave. Setting this will replace the default instructions. You can go back to the default instructions by turning this setting off."})]}),(0,ed.jsx)("input",{type:"checkbox",className:"toggle",checked:h,onChange:()=>u(!h)})]}),h&&(0,ed.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,ed.jsx)("textarea",{className:"px-3 py-3 h-[40vh] max-h-[40vh] placeholder:text-th-primary-light border bg-th-background border-th-border-secondary focus:border-th-primary-light focus:text-th-primary-dark rounded w-full outline-none resize-none text-sm",placeholder:"Enter description",value:m,onChange:e=>{var t;p(e.target.value),w(null===(t=e.target.value)||void 0===t?void 0:t.length)}}),(0,ed.jsx)("div",{className:"text-xs flex justify-end gap-2",children:(0,ed.jsxs)("span",{className:j?"text-red-500":"",children:[b," / 2000 characters"]})})]})]})]}),(0,ed.jsxs)("div",{className:"py-4 px-4 bg-th-background-modal px-6 md:px-10 border-t border-th-border-primary modal-action w-full bottom-0 sticky",children:[(0,ed.jsx)("label",{className:"px-3 py-2 text-sm font-medium cursor-pointer rounded hover:bg-th-background-hover normal-case text-th-primary-light hover:text-th-primary-dark",onClick:()=>t(!1),children:"Cancel"}),(0,ed.jsx)("button",{disabled:!L||j,className:"px-3 py-[6px] flex items-center text-sm cursor-pointer font-medium normal-case rounded bg-th-background-secondary hover:bg-th-background-hover border border-th-border-secondary hover:text-th-primary-dark text-th-primary-medium disabled:opacity-50 disabled:cursor-not-allowed",onClick:L?I:()=>{},children:"Update"})]})]})]})})};function a1(e){let{slowLoad:t=!1}=e;return(0,ed.jsx)("div",{className:"h-full w-full flex content-center justify-center p-4",children:(0,ed.jsxs)("div",{className:"flex flex-col items-center justify-center gap-6 max-w-[400px]",children:[(0,ed.jsx)(t4,{height:"40px",width:"40px",className:"text-th-primary-dark animate-pulse"}),t?(0,ed.jsx)("p",{className:"".concat(t?"opacity-100 animate-pulse":"opacity-0"," animate-opacity-appear text-center text-sm font-medium text-th-primary-dark"),children:"We're experiencing high demand. Please be patient as the\n          page loads. Our team is working hard to improve stability."}):(0,ed.jsx)("p",{className:"".concat(t?"opacity-0":"opacity-100 animate-pulse"," text-th-primary-dark text-sm animate-opacity-appear font-medium text center whitespace-pre-wrap"),children:"Loading account"})]})})}function a6(){let{signupModal:e,setSignupModal:t}=t0(),[r,a]=(0,ex.useState)(!1),[n,l]=(0,ex.useState)(!1),s=(0,ex.useRef)(null);return(0,ex.useEffect)(()=>{let e=e=>{s.current&&!s.current.contains(e.target)&&(a(!1),l(!1),t(!1,""))};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]),(0,ed.jsxs)(ed.Fragment,{children:[r&&(0,ed.jsx)(eO.RedirectToSignUp,{}),n&&(0,ed.jsx)(eO.RedirectToSignIn,{}),(0,ed.jsx)("div",{className:"modal modal-open",children:(0,ed.jsxs)("div",{ref:s,className:"grid gap-4 md:gap-6 max-w-[440px] min-w-[288px] modal-box rounded px-6 py-4 md:py-6 md:px-10 bg-th-background-modal border border-th-border-primary animate-grow-fade-in",children:[(0,ed.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,ed.jsx)("div",{className:"flex w-full items-center gap-3",children:(0,ed.jsx)("p",{className:"font-semibold text-lg flex-1 text-th-primary-dark",children:"Sign up for free"})}),(0,ed.jsx)("div",{className:"flex w-full items-center gap-3",children:(0,ed.jsx)("p",{className:"text-sm flex-1 text-th-primary-medium",children:(null==e?void 0:e.message)||"Please sign up to continue."})})]}),(0,ed.jsxs)("div",{className:"modal-action  m-0 p-0",children:[(0,ed.jsx)("button",{className:"px-3 py-2 text-sm font-medium cursor-pointer rounded bg-transparent hover:bg-th-background-hover normal-case text-th-primary-light hover:text-th-primary-dark",onClick:()=>l(!0),children:"Log in"}),(0,ed.jsx)("button",{className:"px-3 py-[6px] flex items-center text-sm cursor-pointer font-medium normal-case rounded bg-th-background-secondary hover:bg-th-background-hover border border-th-border-secondary hover:text-th-primary-dark text-th-primary-medium",onClick:()=>a(!0),children:"Sign up"})]})]})})]})}var a3=function(e){let t=(e/100).toFixed(2);return"$"+t.replace(/\.?0+$/,"")};let a2=()=>{let[e,t]=(0,ex.useState)(1e4),{workspaceId:r}=(0,em.Oz)(),[a,n]=(0,ex.useState)(!1),{showToast:l}=(0,e4.pm)(),{plan:s}=ez(),i=eF.d.workspaces.createCreditsCheckoutSession.useMutation(),{data:o}=eF.d.workspaces.listCreditOptions.useQuery({workspaceId:r},{enabled:!!r}),{showAddCredits:d,setShowAddCredits:c,setShowSettings:h}=(0,em.F2)(),u=(0,ex.useMemo)(()=>{var t;return null===(t=null==o?void 0:o.find(t=>t.credits==e))||void 0===t?void 0:t.cost},[o,e]);async function m(){n(!0),await i.mutateAsync({workspaceId:r,credits:e}).then(e=>{e.url&&(window.location.href=e.url)}).catch(e=>{l("Error getting checkout link. Please try again"),n(!1)})}async function p(){h(!0),c(!1)}return(0,ed.jsx)("div",{className:"modal ".concat(d&&"modal-open"),children:(0,ed.jsxs)("div",{className:"modal-box bg-th-background-modal rounded-md w-full max-w-[560px] px-6 py-4 md:px-10 md:py-6 grid flex flex-col gap-6",children:[(0,ed.jsxs)("div",{className:"grid gap-3",children:[(0,ed.jsxs)("div",{className:"flex ",children:[(0,ed.jsxs)("div",{className:"flex-1 flex gap-3 items-center",children:[(0,ed.jsx)("div",{className:"flex justify-center items-center h-7 w-7 bg-th-primary-dark text-th-background rounded",children:(0,ed.jsx)(ax,{className:"h-4 w-4"})}),(0,ed.jsx)("p",{className:"font-semibold text-lg text-th-primary-dark",children:"Add credits"})]}),(0,ed.jsx)("div",{className:"flex justify-center items-center h-6 w-6 cursor-pointer",children:(0,ed.jsx)(ty.Z,{onClick:()=>c(!1),className:"h-5 w-5 text-th-primary-light hover:text-th-primary-dark"})})]}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-medium",children:(null==s?void 0:s.credits)==0?"You ran out of credits. To continue using premium models and\n            features, you’ll need to add more credits.":"Choose the amount of credits you want to add to your account."})]}),(0,ed.jsxs)("div",{className:"grid gap-3",children:[(0,ed.jsxs)("div",{className:"flex",children:[(0,ed.jsx)("p",{className:"grow text-th-primary-medium font-medium",children:"Choose credit amount"}),(0,ed.jsxs)("p",{className:"text-th-primary-medium font-medium",children:[u&&a3(u)," purchase"]})]}),(0,ed.jsx)("div",{className:"flex justify-start gap-2",children:null==o?void 0:o.map(r=>(0,ed.jsx)(a4,{credits:r.credits,selected:e,onClick:t}))})]}),(0,ed.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,ed.jsx)("button",{onClick:p,className:"py-[6px] px-3 text-sm text-th-primary-light hover:bg-th-background-secondary rounded",children:"Cancel"}),(0,ed.jsx)("button",{onClick:m,className:"btn ".concat(a&&"loading"," p-0 py-[6px] normal-case text-sm px-3 text-sm text-th-primary-medium hover:text-th-primary-dark text-th-primary-dark bg-th-background-secondary rounded min-h-1"),children:a?"":"Continue to checkout"})]})]})})},a4=e=>{let{credits:t,selected:r,onClick:a}=e;return(0,ed.jsx)("button",{className:"px-4 py-3 rounded grow border hover:text-th-primary-dark  hover:border-th-primary-light ".concat(r==t?"text-th-primary-dark border-th-primary-light":"text-th-primary-light border-th-border-secondary"),onClick:()=>a(t),children:t.toLocaleString()})},a5=()=>{let[e,t]=(0,ex.useState)(1e4),{workspaceId:r}=(0,em.Oz)(),[a,n]=(0,ex.useState)(!1),{showToast:l}=(0,e4.pm)(),{plan:s}=ez();eF.d.workspaces.createCreditsCheckoutSession.useMutation();let{data:i}=eF.d.workspaces.listCreditOptions.useQuery({workspaceId:r},{enabled:!!r}),{setShowAddCredits:o,setShowSettings:d}=(0,em.F2)();(0,ex.useMemo)(()=>{var t;return null===(t=null==i?void 0:i.find(t=>t.credits==e))||void 0===t?void 0:t.cost},[i,e]);let{allPlans:c}=ez();return(0,ed.jsx)("div",{className:"modal modal-open",children:(0,ed.jsxs)("div",{className:"modal-box bg-th-background-modal rounded-md w-full max-w-[560px] px-6 py-4 md:px-10 md:py-6 grid flex flex-col gap-6",children:[(0,ed.jsxs)("div",{className:"grid gap-3",children:[(0,ed.jsxs)("div",{className:"flex ",children:[(0,ed.jsxs)("div",{className:"flex-1 flex gap-3 items-center",children:[(0,ed.jsx)("div",{className:"flex justify-center items-center h-7 w-7 bg-th-primary-dark text-th-background rounded",children:(0,ed.jsx)(eS,{className:"h-4 w-4"})}),(0,ed.jsx)("p",{className:"font-semibold text-lg text-th-primary-dark",children:"Choose your subscription"})]}),(0,ed.jsx)("div",{className:"flex justify-center items-center h-6 w-6 cursor-pointer",children:(0,ed.jsx)(ty.Z,{onClick:()=>o(!1),className:"h-5 w-5 text-th-primary-light hover:text-th-primary-dark"})})]}),(0,ed.jsx)("p",{className:"text-sm text-th-primary-medium",children:"Choose a premium plan for increased limits to premium models and features."})]}),(0,ed.jsx)("div",{className:"grid gap-3",children:(0,ed.jsx)("div",{className:"flex flex-col md:flex-row gap-2 w-full",children:null==c?void 0:c.map(e=>(0,ed.jsx)(a7,{name:e.name,price:(e.cost/100).toFixed(0),credits:e.credits,currentPlanCredits:2500,rateLimit:e.rateLimit,currentPlanLabel:"Continue on Free"}))})})]})})},a7=e=>{let{name:t,price:r,credits:a,currentPlanCredits:n,rateLimit:l,currentPlanLabel:s="Current plan"}=e,[i,o]=(0,ex.useState)(!1),{workspaceId:d,setShowChooseSubscription:c}=(0,em.Oz)(),h=eF.d.workspaces.createCheckoutSession.useMutation();async function u(){o(!0);let e=await h.mutateAsync({workspaceId:d,plan:t.toLowerCase()});(null==e?void 0:e.url)&&(window.location.href=e.url),o(!1)}async function m(){c(!1)}return(0,ed.jsxs)("div",{className:"w-full flex flex-col gap-0 border border-th-border-secondary rounded grow overflow-hidden",children:[(0,ed.jsx)("p",{className:"h-11 flex items-center justify-center w-full text-center border-b border-th-border-secondary text-th-primary-dark font-semibold text-md",children:t}),(0,ed.jsxs)("div",{className:"grid h-full  items-center bg-th-background gap-2 w-full px-2 py-3 ",children:[(0,ed.jsxs)("div",{className:"flex gap-1 w-full justify-center",children:[(0,ed.jsxs)("div",{className:"flex",children:[(0,ed.jsx)("span",{className:"italic align-top text-[12px]",children:"$"}),(0,ed.jsx)("p",{className:"text-th-primary-dark text-[20px]",children:r})]}),(0,ed.jsx)("p",{className:"text-[12px] self-end",children:"/ month"})]}),(0,ed.jsxs)("p",{className:"w-full text-center text-th-primary-dark text-sm font-normal flex items-center gap-1 justify-center",children:[(0,ed.jsx)(ax,{}),a.toLocaleString()," credits"]}),(0,ed.jsxs)("p",{className:"text-th-primary-medium text-[12px] font-normal flex justify-center items-center  text-center px-1",children:[l," messages per 3 hours for premium models"]}),(0,ed.jsxs)("div",{className:"flex items-center h-11 ",children:[n==a&&(0,ed.jsx)("button",{onClick:m,className:" text-sm white font-normal bg-transparent py-[6px] text-sm text-th-primary-light hover:text-th-primary-dark w-full bg-th-background-secondary rounded  hover:text-th-primary-dark",children:s}),n<a&&(0,ed.jsx)(ed.Fragment,{children:i?(0,ed.jsx)("div",{className:"w-full flex justify-center",children:(0,ed.jsx)("span",{className:"loading loading-spinner loading-xs"})}):(0,ed.jsx)("button",{onClick:u,className:" text-sm white border border-th-border-secondary py-[6px] text-sm text-th-primary-light hover:text-th-primary-dark w-full bg-th-background-secondary rounded font-semibold hover:text-th-primary-dark",children:"Upgrade"})})]})]})]})};function a8(e){let{preloadedPersona:t}=e,{user:r,isLoaded:a}=(0,eO.useUser)(),{workspaces:n,workspaceId:l,setWorkspaces:s,setWorkspaceId:i,showChooseSubscription:o,setShowChooseSubscription:d}=(0,em.Oz)(),{setPrompt:c,setAutoSend:h}=(0,em.Nf)(),{showSettings:u,setShowSettings:m,showAddCredits:p}=(0,em.F2)(),{signupModal:x}=t0(),[f,g]=(0,ex.useState)(!1),[v,y]=(0,ex.useState)(!1),{data:b}=eF.d.workspaces.listWorkspaces.useQuery(void 0,{enabled:!!(null==r?void 0:r.id)}),{refetch:w}=eF.d.chat.loadTree.useQuery({workspaceId:l}),{internetMode:j,setInternetMode:k,autosave:N,setAutosave:C}=(0,em.Oz)(),E=async()=>{if(b&&!n.length){var e;s(b),i(null==b?void 0:null===(e=b[0])||void 0===e?void 0:e.id)}},{setPersonas:S,setDefaultPersonaId:O}=(0,em.Gm)(),{showCreateModal:M,showEditModal:_}=(0,em.Yf)();eF.d.users.setInternetPreference.useMutation(),eF.d.users.setAutoSavePreference.useMutation(),eF.d.users.setModelPreference.useMutation();let{data:P}=eF.d.personas.listCategoryPersonas.useQuery({workspaceId:l}),{personas:Z}=(0,em.Gm)(),{setMessagePersona:A}=(0,em.GH)(),{setPlan:L,setCredits:I,setAllPlans:z}=ez(),{setModel:F}=(0,em.Nf)(),{data:H,error:T}=eF.d.workspaces.listPlan.useQuery({workspaceId:l},{enabled:!!l}),{data:R}=eF.d.workspaces.listSubscriptionOptions.useQuery({workspaceId:l},{enabled:!!l});return(0,ex.useEffect)(()=>{R&&z(R)},[R]),(0,ex.useEffect)(()=>{(null==H?void 0:H.status)&&(L(H),I(null==H?void 0:H.credits))},[H]),(0,ex.useEffect)(()=>{if(H&&"Free"==H.plan){let e=localStorage.getItem("showChooseSubscription");e||(d(!0),localStorage.setItem("showChooseSubscription","true"))}},[H,r]),(0,ex.useEffect)(()=>{P&&S(Object.values(P).flat())},[P]),(0,ex.useEffect)(()=>{v&&b&&Z&&y(!1)},[b,Z]),setTimeout(function(){b||Z||y(!0)},1600),(0,ex.useEffect)(()=>{if(l&&(null==Z?void 0:Z.length)){if(console.log("apple"),S(Z),l&&r){console.log("choco");let t=localStorage.getItem("".concat(null==r?void 0:r.id,":defaultPersonaId"));if(t)console.log("dairy"),O(t),A(t);else{var e;console.log("elmo");let t=Z.find(e=>"HelpfulAssistant"===e.handle);O(null==t?void 0:t.id),localStorage.setItem("".concat(null==r?void 0:r.id,":defaultPersonaId"),null===(e=Z[0])||void 0===e?void 0:e.id)}}}else if(console.log("banana"),Z){let e=null==Z?void 0:Z.find(e=>"HelpfulAssistant"===e.handle);O(null==e?void 0:e.id)}},[l,Z]),(0,ex.useEffect)(()=>{console.log("listWorkspacesResult",b),E()},[b]),(0,ex.useEffect)(()=>{if(r){var e,t,a,n,l,s,i;(null==r?void 0:null===(e=r.publicMetadata)||void 0===e?void 0:e.onboardingCompleted)||g(!0),(null==r?void 0:null===(t=r.publicMetadata)||void 0===t?void 0:t.model)?F(null==r?void 0:null===(l=r.publicMetadata)||void 0===l?void 0:l.model):F("gpt-3.5-turbo"),(null==r?void 0:null===(a=r.publicMetadata)||void 0===a?void 0:a.internetMode)?k(null==r?void 0:null===(s=r.publicMetadata)||void 0===s?void 0:s.internetMode):k("auto"),(null==r?void 0:null===(n=r.publicMetadata)||void 0===n?void 0:n.autoSave)?C(null==r?void 0:null===(i=r.publicMetadata)||void 0===i?void 0:i.autoSave):C("always")}},[r]),(0,ex.useEffect)(()=>{r&&w()},[r,f]),(0,ex.useEffect)(()=>{if(!t)return;O(t.id);let e=t.greeting||"Hey ".concat(t.name);e&&(c(e),setTimeout(()=>{h(!0)},50))},[t]),(0,ed.jsxs)(ed.Fragment,{children:[(0,ed.jsxs)(eh(),{children:[(0,ed.jsx)("title",{children:"Forefront Chat"}),(0,ed.jsx)("meta",{name:"description",content:"A better ChatGPT experience. Sign up to get free access to GPT-4, image generation, custom personas, shareable chats, and more."}),(0,ed.jsx)("meta",{property:"og:url",content:"https://chat.forefront.ai/"}),(0,ed.jsx)("meta",{property:"og:type",content:"website"}),(0,ed.jsx)("meta",{property:"og:title",content:"Forefront Chat: A better ChatGPT experience"}),(0,ed.jsx)("meta",{property:"og:description",content:"A better ChatGPT experience. Sign up to get free access to GPT-4, image generation, custom personas, shareable chats, and more."}),(0,ed.jsx)("meta",{property:"og:image",content:"https://assets.forefront.ai/chat_grid.png"}),(0,ed.jsx)("link",{rel:"icon",href:"https://uploads-ssl.webflow.com/628193922a4d18e69ba81f14/628193922a4d180bf1a81f46_Favicon.png"}),(0,ed.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,ed.jsx)("meta",{property:"twitter:domain",content:"chat.forefront.ai"}),(0,ed.jsx)("meta",{property:"twitter:url",content:"https://chat.forefront.ai/"}),(0,ed.jsx)("meta",{name:"twitter:title",content:"Forefront Chat"}),(0,ed.jsx)("meta",{name:"twitter:description",content:"A better ChatGPT experience. Sign up to get free access to GPT-4, image generation, custom personas, shareable chats, and more."}),(0,ed.jsx)("meta",{name:"twitter:image",content:"https://assets.forefront.ai/chat_grid.png"})]}),(0,ed.jsx)(e4.VW,{children:(0,ed.jsxs)("main",{className:"flex ".concat(window.innerHeight==screen.height?"h-[100vh]":"h-[100svh]"," bg-th-background overflow-x-hidden overflow-y-hidden items-stretch justify-items-stretch"),children:[(0,ed.jsx)(aO(),{src:"https://www.googletagmanager.com/gtag/js?id=G-TKH74H682N",strategy:"afterInteractive"}),(0,ed.jsx)(aO(),{id:"google-analytics",strategy:"afterInteractive",children:"\n          window.dataLayer = window.dataLayer || [];\n          function gtag(){window.dataLayer.push(arguments);}\n          gtag('js', new Date());\n\n          gtag('config', 'G-TKH74H682N');\n        "}),a?(0,ed.jsx)(ed.Fragment,{children:!r||b&&Z?(0,ed.jsxs)(ed.Fragment,{children:[(null==x?void 0:x.show)==!0&&(0,ed.jsx)(a6,{}),f&&(0,ed.jsx)(r5.Z,{onDiscard:()=>g(!1)}),o&&(0,ed.jsx)(a5,{}),p&&(0,ed.jsx)(a2,{}),u&&(0,ed.jsx)(aE,{onDiscard:()=>m(!1)}),M&&(0,ed.jsx)(aJ,{}),_&&(0,ed.jsx)(a0,{}),r&&(0,ed.jsx)(tp,{}),(0,ed.jsx)(r2,{}),(0,ed.jsx)(r4,{}),r&&(0,ed.jsx)(aX,{})]}):(0,ed.jsx)(a1,{slowLoad:v})}):(0,ed.jsx)(a1,{slowLoad:v})]})})]})}function a9(){return(0,ed.jsx)(a8,{})}},5515:function(e){e.exports={root:"CustomNode_root__N81BX",arrow:"CustomNode_arrow__d5Sc3",filetype:"CustomNode_filetype__MMs4B",label:"CustomNode_label__jkra0",selected:"CustomNode_selected__fyquO",dragging:"CustomNode_dragging__Fpmvb"}}},function(e){e.O(0,[182,65,480,253,934,536,134,613,682,748,774,888,179],function(){return e(e.s=7314)}),_N_E=e.O()}]);
